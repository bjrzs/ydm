/*! For license information please see main.js.LICENSE.txt */
(()=>{var e={9713:e=>{e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},4222:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getElectronBinding=void 0,t.getElectronBinding=e=>process._linkedBinding?process._linkedBinding("electron_common_"+e):process.electronBinding?process.electronBinding(e):null},897:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deserialize=t.serialize=t.isSerializableObject=t.isPromise=void 0;const r=n(2298);t.isPromise=function(e){return e&&e.then&&e.then instanceof Function&&e.constructor&&e.constructor.reject&&e.constructor.reject instanceof Function&&e.constructor.resolve&&e.constructor.resolve instanceof Function};const i=[Boolean,Number,String,Date,Error,RegExp,ArrayBuffer];function o(e){return null===e||ArrayBuffer.isView(e)||i.some((t=>e instanceof t))}t.isSerializableObject=o;const a=function(e,t){const n=Object.entries(e).map((([e,n])=>[e,t(n)]));return Object.fromEntries(n)};t.serialize=function e(t){return t&&t.constructor&&"NativeImage"===t.constructor.name?function(e){const t=[],n=e.getScaleFactors();if(1===n.length){const r=n[0],i=e.getSize(r),o=e.toBitmap({scaleFactor:r});t.push({scaleFactor:r,size:i,buffer:o})}else for(const r of n){const n=e.getSize(r),i=e.toDataURL({scaleFactor:r});t.push({scaleFactor:r,size:n,dataURL:i})}return{__ELECTRON_SERIALIZED_NativeImage__:!0,representations:t}}(t):Array.isArray(t)?t.map(e):o(t)?t:t instanceof Object?a(t,e):t},t.deserialize=function e(t){return t&&t.__ELECTRON_SERIALIZED_NativeImage__?function(e){const t=r.nativeImage.createEmpty();if(1===e.representations.length){const{buffer:n,size:r,scaleFactor:i}=e.representations[0],{width:o,height:a}=r;t.addRepresentation({buffer:n,scaleFactor:i,width:o,height:a})}else for(const n of e.representations){const{dataURL:e,size:r,scaleFactor:i}=n,{width:o,height:a}=r;t.addRepresentation({dataURL:e,scaleFactor:i,width:o,height:a})}return t}(t):Array.isArray(t)?t.map(e):o(t)?t:t instanceof Object?a(t,e):t}},4879:(e,t,n)=>{"use strict";t.enable=t.initialize=void 0;var r=n(2186);Object.defineProperty(t,"initialize",{enumerable:!0,get:function(){return r.initialize}}),Object.defineProperty(t,"enable",{enumerable:!0,get:function(){return r.enable}})},869:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=(e,t)=>`${e.id}-${t}`;t.default=new class{constructor(){this.nextId=0,this.storage={},this.owners={},this.electronIds=new WeakMap}add(e,t,r){const i=this.saveToStorage(r),o=n(e,t);let a=this.owners[o];return a||(a=this.owners[o]=new Map,this.registerDeleteListener(e,t)),a.has(i)||(a.set(i,0),this.storage[i].count++),a.set(i,a.get(i)+1),i}get(e){const t=this.storage[e];if(null!=t)return t.object}remove(e,t,r){const i=n(e,t),o=this.owners[i];if(o&&o.has(r)){const e=o.get(r)-1;e<=0?(o.delete(r),this.dereference(r)):o.set(r,e)}}clear(e,t){const r=n(e,t),i=this.owners[r];if(i){for(const e of i.keys())this.dereference(e);delete this.owners[r]}}saveToStorage(e){let t=this.electronIds.get(e);return t||(t=++this.nextId,this.storage[t]={count:0,object:e},this.electronIds.set(e,t)),t}dereference(e){const t=this.storage[e];null!=t&&(t.count-=1,0===t.count&&(this.electronIds.delete(t.object),delete this.storage[e]))}registerDeleteListener(e,t){const n=t.split("-")[0],r=(i,o)=>{o&&o.toString()===n&&(e.removeListener("render-view-deleted",r),this.clear(e,t))};e.on("render-view-deleted",r)}}},2186:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=t.enable=t.isRemoteModuleEnabled=void 0;const i=n(2361),o=r(n(869)),a=n(897),s=n(2298),l=n(4222).getElectronBinding("v8_util"),c=(()=>{var e,t;const n=Number(null===(t=null===(e=process.versions.electron)||void 0===e?void 0:e.split("."))||void 0===t?void 0:t[0]);return Number.isNaN(n)||n<14})(),d=["length","name","arguments","caller","prototype"],u=new Map,h=new FinalizationRegistry((e=>{const t=e.id[0]+"~"+e.id[1],n=u.get(t);if(void 0!==n&&void 0===n.deref()&&(u.delete(t),!e.webContents.isDestroyed()))try{e.webContents.sendToFrame(e.frameId,"REMOTE_RENDERER_RELEASE_CALLBACK",e.id[0],e.id[1])}catch(e){console.warn(`sendToFrame() failed: ${e}`)}}));function p(e){const t=e[0]+"~"+e[1],n=u.get(t);if(void 0!==n){const e=n.deref();if(void 0!==e)return e}}const f=new WeakMap,m=function(e){let t=Object.getOwnPropertyNames(e);return"function"==typeof e&&(t=t.filter((e=>!d.includes(e)))),t.map((t=>{const n=Object.getOwnPropertyDescriptor(e,t);let r,i=!1;return void 0===n.get&&"function"==typeof e[t]?r="method":((n.set||n.writable)&&(i=!0),r="get"),{name:t,enumerable:n.enumerable,writable:i,type:r}}))},g=function(e){const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype?null:{members:m(t),proto:g(t)}},w=function(e,t,n,r=!1){let i;switch(typeof n){case"object":i=n instanceof Buffer?"buffer":n&&n.constructor&&"NativeImage"===n.constructor.name?"nativeimage":Array.isArray(n)?"array":n instanceof Error?"error":a.isSerializableObject(n)?"value":a.isPromise(n)?"promise":Object.prototype.hasOwnProperty.call(n,"callee")&&null!=n.length?"array":r&&l.getHiddenValue(n,"simple")?"value":"object";break;case"function":i="function";break;default:i="value"}return"array"===i?{type:i,members:n.map((n=>w(e,t,n,r)))}:"nativeimage"===i?{type:i,value:a.serialize(n)}:"object"===i||"function"===i?{type:i,name:n.constructor?n.constructor.name:"",id:o.default.add(e,t,n),members:m(n),proto:g(n)}:"buffer"===i?{type:i,value:n}:"promise"===i?(n.then((function(){}),(function(){})),{type:i,then:w(e,t,(function(e,t){n.then(e,t)}))}):"error"===i?{type:i,value:n,members:Object.keys(n).map((r=>({name:r,value:w(e,t,n[r])})))}:{type:"value",value:n}},b=function(e){const t=new Error(e);throw t.code="EBADRPC",t.errno=-72,t},E=(e,t)=>{let n=`Attempting to call a function in a renderer window that has been closed or released.\nFunction provided here: ${f.get(t)}`;if(e instanceof i.EventEmitter){const r=e.eventNames().filter((n=>e.listeners(n).includes(t)));r.length>0&&(n+=`\nRemote event names: ${r.join(", ")}`,r.forEach((n=>{e.removeListener(n,t)})))}console.warn(n)},y=function(e,t,n,r){const i=function(r){switch(r.type){case"nativeimage":return a.deserialize(r.value);case"value":return r.value;case"remote-object":return o.default.get(r.id);case"array":return y(e,t,n,r.value);case"buffer":return Buffer.from(r.value.buffer,r.value.byteOffset,r.value.byteLength);case"promise":return Promise.resolve({then:i(r.then)});case"object":{const e="Object"!==r.name?Object.create({constructor:(s=r.name,new Proxy(Object,{get:(e,t,n)=>"name"===t?s:Reflect.get(e,t,n)}))}):{};for(const{name:t,value:n}of r.members)e[t]=i(n);return e}case"function-with-return-value":{const e=i(r.value);return function(){return e}}case"function":{const i=[n,r.id],o=p(i);if(void 0!==o)return o;const a=function(...i){let o=!1;if(!e.isDestroyed())try{o=!1!==e.sendToFrame(t,"REMOTE_RENDERER_CALLBACK",n,r.id,w(e,n,i))}catch(e){console.warn(`sendToFrame() failed: ${e}`)}o||E(this,a)};return f.set(a,r.location),Object.defineProperty(a,"length",{value:r.length}),function(e,t,n,r){const i=new WeakRef(r),o=e[0]+"~"+e[1];u.set(o,i),h.register(r,{id:e,webContents:t,frameId:n})}(i,e,t,a),a}default:throw new TypeError(`Unknown type: ${r.type}`)}var s};return r.map(i)},_=new WeakMap;t.isRemoteModuleEnabled=function(e){return c&&!_.has(e)&&_.set(e,function(e){const t=e.getLastWebPreferences()||{};return null!=t.enableRemoteModule&&!!t.enableRemoteModule}(e)),_.get(e)},t.enable=function(e){_.set(e,!0)};const v=function(e,n){s.ipcMain.on(e,((e,r,...i)=>{let o;if(t.isRemoteModuleEnabled(e.sender)){try{o=n(e,r,...i)}catch(t){o={type:"exception",value:w(e.sender,r,t)}}void 0!==o&&(e.returnValue=o)}else e.returnValue={type:"exception",value:w(e.sender,r,new Error('@electron/remote is disabled for this WebContents. Call require("@electron/remote/main").enable(webContents) to enable it.'))}}))},C=function(e,t,...n){const r={sender:e,returnValue:void 0,defaultPrevented:!1};return s.app.emit(t,r,e,...n),e.emit(t,r,...n),r},A=function(e,t,n){n&&console.warn(`WebContents (${e.id}): ${t}`,n)};let T=!1;t.initialize=function(){if(T)throw new Error("@electron/remote has already been initialized");T=!0,v("REMOTE_BROWSER_WRONG_CONTEXT_ERROR",(function(e,t,n,r){const i=p([n,r]);void 0!==i&&E(e.sender,i)})),v("REMOTE_BROWSER_REQUIRE",(function(e,t,n,r){A(e.sender,`remote.require('${n}')`,r);const i=C(e.sender,"remote-require",n);if(void 0===i.returnValue){if(i.defaultPrevented)throw new Error(`Blocked remote.require('${n}')`);i.returnValue=process.mainModule.require(n)}return w(e.sender,t,i.returnValue)})),v("REMOTE_BROWSER_GET_BUILTIN",(function(e,t,r,i){A(e.sender,`remote.getBuiltin('${r}')`,i);const o=C(e.sender,"remote-get-builtin",r);if(void 0===o.returnValue){if(o.defaultPrevented)throw new Error(`Blocked remote.getBuiltin('${r}')`);o.returnValue=n(2298)[r]}return w(e.sender,t,o.returnValue)})),v("REMOTE_BROWSER_GET_GLOBAL",(function(e,t,n,r){A(e.sender,`remote.getGlobal('${n}')`,r);const i=C(e.sender,"remote-get-global",n);if(void 0===i.returnValue){if(i.defaultPrevented)throw new Error(`Blocked remote.getGlobal('${n}')`);i.returnValue=global[n]}return w(e.sender,t,i.returnValue)})),v("REMOTE_BROWSER_GET_CURRENT_WINDOW",(function(e,t,n){A(e.sender,"remote.getCurrentWindow()",n);const r=C(e.sender,"remote-get-current-window");if(void 0===r.returnValue){if(r.defaultPrevented)throw new Error("Blocked remote.getCurrentWindow()");r.returnValue=e.sender.getOwnerBrowserWindow()}return w(e.sender,t,r.returnValue)})),v("REMOTE_BROWSER_GET_CURRENT_WEB_CONTENTS",(function(e,t,n){A(e.sender,"remote.getCurrentWebContents()",n);const r=C(e.sender,"remote-get-current-web-contents");if(void 0===r.returnValue){if(r.defaultPrevented)throw new Error("Blocked remote.getCurrentWebContents()");r.returnValue=e.sender}return w(e.sender,t,r.returnValue)})),v("REMOTE_BROWSER_CONSTRUCTOR",(function(e,t,n,r){r=y(e.sender,e.frameId,t,r);const i=o.default.get(n);return null==i&&b(`Cannot call constructor on missing remote object ${n}`),w(e.sender,t,new i(...r))})),v("REMOTE_BROWSER_FUNCTION_CALL",(function(e,t,n,r){r=y(e.sender,e.frameId,t,r);const i=o.default.get(n);null==i&&b(`Cannot call function on missing remote object ${n}`);try{return w(e.sender,t,i(...r),!0)}catch(e){const t=new Error(`Could not call remote function '${i.name||"anonymous"}'. Check that the function signature is correct. Underlying error: ${e}\n`+(e instanceof Error?`Underlying stack: ${e.stack}\n`:""));throw t.cause=e,t}})),v("REMOTE_BROWSER_MEMBER_CONSTRUCTOR",(function(e,t,n,r,i){i=y(e.sender,e.frameId,t,i);const a=o.default.get(n);return null==a&&b(`Cannot call constructor '${r}' on missing remote object ${n}`),w(e.sender,t,new a[r](...i))})),v("REMOTE_BROWSER_MEMBER_CALL",(function(e,t,n,r,i){i=y(e.sender,e.frameId,t,i);const a=o.default.get(n);null==a&&b(`Cannot call method '${r}' on missing remote object ${n}`);try{return w(e.sender,t,a[r](...i),!0)}catch(e){const t=new Error(`Could not call remote method '${r}'. Check that the method signature is correct. Underlying error: ${e}`+(e instanceof Error?`Underlying stack: ${e.stack}\n`:""));throw t.cause=e,t}})),v("REMOTE_BROWSER_MEMBER_SET",(function(e,t,n,r,i){i=y(e.sender,e.frameId,t,i);const a=o.default.get(n);return null==a&&b(`Cannot set property '${r}' on missing remote object ${n}`),a[r]=i[0],null})),v("REMOTE_BROWSER_MEMBER_GET",(function(e,t,n,r){const i=o.default.get(n);return null==i&&b(`Cannot get property '${r}' on missing remote object ${n}`),w(e.sender,t,i[r])})),v("REMOTE_BROWSER_DEREFERENCE",(function(e,t,n){o.default.remove(e.sender,t,n)})),v("REMOTE_BROWSER_CONTEXT_RELEASE",((e,t)=>(o.default.clear(e.sender,t),null)))}},8539:(e,t,n)=>{e.exports=n(4879)},9463:(e,t,n)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(8251)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},8251:(e,t,n)=>{e.exports=function(e){function t(e){let n,i,o,a=null;function s(...e){if(!s.enabled)return;const r=s,i=Number(new Date),o=i-(n||i);r.diff=o,r.prev=n,r.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,i)=>{if("%%"===n)return"%";a++;const o=t.formatters[i];if("function"==typeof o){const t=e[a];n=o.call(r,t),e.splice(a,1),a--}return n})),t.formatArgs.call(r,e),(r.log||t.log).apply(r,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(1783),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},3538:(e,t,n)=>{"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=n(9463):e.exports=n(6101)},6101:(e,t,n)=>{const r=n(6224),i=n(3837);t.init=function(e){e.inspectOpts={};const n=Object.keys(t.inspectOpts);for(let r=0;r<n.length;r++)e.inspectOpts[n[r]]=t.inspectOpts[n[r]]},t.log=function(...e){return process.stderr.write(i.format(...e)+"\n")},t.formatArgs=function(n){const{namespace:r,useColors:i}=this;if(i){const t=this.color,i="[3"+(t<8?t:"8;5;"+t),o=`  ${i};1m${r} [0m`;n[0]=o+n[0].split("\n").join("\n"+o),n.push(i+"m+"+e.exports.humanize(this.diff)+"[0m")}else n[0]=(t.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+r+" "+n[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):r.isatty(process.stderr.fd)},t.destroy=i.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=n(2130);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const n=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let r=process.env[t];return r=!!/^(yes|on|true|enabled)$/i.test(r)||!/^(no|off|false|disabled)$/i.test(r)&&("null"===r?null:Number(r)),e[n]=r,e}),{}),e.exports=n(8251)(t);const{formatters:o}=e.exports;o.o=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},o.O=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts)}},1783:e=>{var t=1e3,n=60*t,r=60*n,i=24*r;function o(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,a){a=a||{};var s,l,c=typeof e;if("string"===c&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(o){var a=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return 6048e5*a;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*r;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===c&&isFinite(e))return a.long?(s=e,(l=Math.abs(s))>=i?o(s,l,i,"day"):l>=r?o(s,l,r,"hour"):l>=n?o(s,l,n,"minute"):l>=t?o(s,l,t,"second"):s+" ms"):function(e){var o=Math.abs(e);return o>=i?Math.round(e/i)+"d":o>=r?Math.round(e/r)+"h":o>=n?Math.round(e/n)+"m":o>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},7482:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationError=t.CancellationToken=void 0;const r=n(2361);class i extends r.EventEmitter{constructor(e){super(),this.parentCancelHandler=null,this._parent=null,this._cancelled=!1,null!=e&&(this.parent=e)}get cancelled(){return this._cancelled||null!=this._parent&&this._parent.cancelled}set parent(e){this.removeParentCancelHandler(),this._parent=e,this.parentCancelHandler=()=>this.cancel(),this._parent.onCancel(this.parentCancelHandler)}cancel(){this._cancelled=!0,this.emit("cancel")}onCancel(e){this.cancelled?e():this.once("cancel",e)}createPromise(e){if(this.cancelled)return Promise.reject(new o);const t=()=>{if(null!=n)try{this.removeListener("cancel",n),n=null}catch(e){}};let n=null;return new Promise(((t,r)=>{let i=null;n=()=>{try{null!=i&&(i(),i=null)}finally{r(new o)}},this.cancelled?n():(this.onCancel(n),e(t,r,(e=>{i=e})))})).then((e=>(t(),e))).catch((e=>{throw t(),e}))}removeParentCancelHandler(){const e=this._parent;null!=e&&null!=this.parentCancelHandler&&(e.removeListener("cancel",this.parentCancelHandler),this.parentCancelHandler=null)}dispose(){try{this.removeParentCancelHandler()}finally{this.removeAllListeners(),this._parent=null}}}t.CancellationToken=i;class o extends Error{constructor(){super("cancelled")}}t.CancellationError=o},432:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressCallbackTransform=void 0;const r=n(2781);class i extends r.Transform{constructor(e,t,n){super(),this.total=e,this.cancellationToken=t,this.onProgress=n,this.start=Date.now(),this.transferred=0,this.delta=0,this.nextUpdate=this.start+1e3}_transform(e,t,n){if(this.cancellationToken.cancelled)return void n(new Error("cancelled"),null);this.transferred+=e.length,this.delta+=e.length;const r=Date.now();r>=this.nextUpdate&&this.transferred!==this.total&&(this.nextUpdate=r+1e3,this.onProgress({total:this.total,delta:this.delta,transferred:this.transferred,percent:this.transferred/this.total*100,bytesPerSecond:Math.round(this.transferred/((r-this.start)/1e3))}),this.delta=0),n(null,e)}_flush(e){this.cancellationToken.cancelled?e(new Error("cancelled")):(this.onProgress({total:this.total,delta:this.delta,transferred:this.total,percent:100,bytesPerSecond:Math.round(this.transferred/((Date.now()-this.start)/1e3))}),this.delta=0,e(null))}}t.ProgressCallbackTransform=i},4048:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BintrayClient=void 0;const r=n(9252);t.BintrayClient=class{constructor(e,t,n,r){if(this.httpExecutor=t,this.cancellationToken=n,this.requestHeaders=null,null==e.owner)throw new Error("owner is not specified");if(null==e.package)throw new Error("package is not specified");this.repo=e.repo||"generic",this.packageName=e.package,this.owner=e.owner,this.user=e.user||e.owner,this.component=e.component||null,this.distribution=e.distribution||"stable",this.auth=null==r?null:`Basic ${Buffer.from(`${this.user}:${r}`).toString("base64")}`,this.basePath=`/packages/${this.owner}/${this.repo}/${this.packageName}`}setRequestHeaders(e){this.requestHeaders=e}bintrayRequest(e,t,n=null,i,o){return r.parseJson(this.httpExecutor.request(r.configureRequestOptions({hostname:"api.bintray.com",path:e,headers:this.requestHeaders||void 0},t,o),i,n))}getVersion(e){return this.bintrayRequest(`${this.basePath}/versions/${e}`,this.auth,null,this.cancellationToken)}getVersionFiles(e){return this.bintrayRequest(`${this.basePath}/versions/${e}/files`,this.auth,null,this.cancellationToken)}createVersion(e){return this.bintrayRequest(`${this.basePath}/versions`,this.auth,{name:e},this.cancellationToken)}deleteVersion(e){return this.bintrayRequest(`${this.basePath}/versions/${e}`,this.auth,null,this.cancellationToken,"DELETE")}}},9252:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.safeStringifyJson=t.configureRequestOptions=t.safeGetHeader=t.DigestTransform=t.configureRequestUrl=t.configureRequestOptionsFromUrl=t.HttpExecutor=t.parseJson=t.HttpError=t.createHttpError=void 0;const r=n(6113),i=n(3538),o=n(7147),a=n(2781),s=n(7310),l=n(7482),c=n(9152),d=n(432),u=i.default("electron-builder");function h(e,t=null){return new f(e.statusCode||-1,`${e.statusCode} ${e.statusMessage}`+(null==t?"":"\n"+JSON.stringify(t,null,"  "))+"\nHeaders: "+_(e.headers),t)}t.createHttpError=h;const p=new Map([[429,"Too many requests"],[400,"Bad request"],[403,"Forbidden"],[404,"Not found"],[405,"Method not allowed"],[406,"Not acceptable"],[408,"Request timeout"],[413,"Request entity too large"],[500,"Internal server error"],[502,"Bad gateway"],[503,"Service unavailable"],[504,"Gateway timeout"],[505,"HTTP version not supported"]]);class f extends Error{constructor(e,t=`HTTP error: ${p.get(e)||e}`,n=null){super(t),this.statusCode=e,this.description=n,this.name="HttpError",this.code=`HTTP_ERROR_${e}`}isServerError(){return this.statusCode>=500&&this.statusCode<=599}}t.HttpError=f,t.parseJson=function(e){return e.then((e=>null==e||0===e.length?null:JSON.parse(e)))};class m{constructor(){this.maxRedirects=10}request(e,t=new l.CancellationToken,n){y(e);const r=null==n?void 0:JSON.stringify(n),i=r?Buffer.from(r):void 0;if(null!=i){u(r);const{headers:t,...n}=e;e={method:"post",headers:{"Content-Type":"application/json","Content-Length":i.length,...t},...n}}return this.doApiRequest(e,t,(e=>e.end(i)))}doApiRequest(e,t,n,r=0){return u.enabled&&u(`Request: ${_(e)}`),t.createPromise(((i,o,a)=>{const s=this.createRequest(e,(a=>{try{this.handleResponse(a,e,t,i,o,r,n)}catch(e){o(e)}}));this.addErrorAndTimeoutHandlers(s,o),this.addRedirectHandlers(s,e,o,r,(e=>{this.doApiRequest(e,t,n,r).then(i).catch(o)})),n(s,o),a((()=>s.abort()))}))}addRedirectHandlers(e,t,n,r,i){}addErrorAndTimeoutHandlers(e,t){this.addTimeOutHandler(e,t),e.on("error",t),e.on("aborted",(()=>{t(new Error("Request has been aborted by the server"))}))}handleResponse(e,t,n,r,i,o,a){var s;if(u.enabled&&u(`Response: ${e.statusCode} ${e.statusMessage}, request options: ${_(t)}`),404===e.statusCode)return void i(h(e,`method: ${t.method||"GET"} url: ${t.protocol||"https:"}//${t.hostname}${t.port?`:${t.port}`:""}${t.path}\n\nPlease double check that your authentication token is correct. Due to security reasons, actual status maybe not reported, but 404.\n`));if(204===e.statusCode)return void r();const l=null!==(s=e.statusCode)&&void 0!==s?s:0,c=l>=300&&l<400,d=E(e,"location");if(c&&null!=d)return o>this.maxRedirects?void i(this.createMaxRedirectError()):void this.doApiRequest(m.prepareRedirectUrlOptions(d,t),n,a,o).then(r).catch(i);e.setEncoding("utf8");let p="";e.on("error",i),e.on("data",(e=>p+=e)),e.on("end",(()=>{try{if(null!=e.statusCode&&e.statusCode>=400){const n=E(e,"content-type"),r=null!=n&&(Array.isArray(n)?null!=n.find((e=>e.includes("json"))):n.includes("json"));i(h(e,`method: ${t.method||"GET"} url: ${t.protocol||"https:"}//${t.hostname}${t.port?`:${t.port}`:""}${t.path}\n\n          Data:\n          ${r?JSON.stringify(JSON.parse(p)):p}\n          `))}else r(0===p.length?null:p)}catch(e){i(e)}}))}async downloadToBuffer(e,t){return await t.cancellationToken.createPromise(((n,r,i)=>{let o=null;const a={headers:t.headers||void 0,redirect:"manual"};w(e,a),y(a),this.doDownload(a,{destination:null,options:t,onCancel:i,callback:e=>{null==e?n(o):r(e)},responseHandler:(e,t)=>{const n=E(e,"content-length");let r=-1;if(null!=n){const e=parseInt(n,10);if(e>0){if(e>524288e3)return void t(new Error("Maximum allowed size is 500 MB"));o=Buffer.alloc(e),r=0}}e.on("data",(e=>{if(-1!==r)e.copy(o,r),r+=e.length;else if(null==o)o=e;else{if(o.length>524288e3)return void t(new Error("Maximum allowed size is 500 MB"));o=Buffer.concat([o,e])}})),e.on("end",(()=>{null!=o&&-1!==r&&r!==o.length?t(new Error(`Received data length ${r} is not equal to expected ${o.length}`)):t(null)}))}},0)}))}doDownload(e,t,n){const r=this.createRequest(e,(r=>{if(r.statusCode>=400)return void t.callback(new Error(`Cannot download "${e.protocol||"https:"}//${e.hostname}${e.path}", status ${r.statusCode}: ${r.statusMessage}`));r.on("error",t.callback);const i=E(r,"location");null==i?null==t.responseHandler?function(e,t){if(n=E(t,"X-Checksum-Sha2"),r=e.options.sha2,i=e.callback,null!=n&&null!=r&&n!==r&&(i(new Error(`checksum mismatch: expected ${r} but got ${n} (X-Checksum-Sha2 header)`)),1))return;var n,r,i;const a=[];if(null!=e.options.onProgress){const n=E(t,"content-length");null!=n&&a.push(new d.ProgressCallbackTransform(parseInt(n,10),e.options.cancellationToken,e.options.onProgress))}const s=e.options.sha512;null!=s?a.push(new b(s,"sha512",128!==s.length||s.includes("+")||s.includes("Z")||s.includes("=")?"base64":"hex")):null!=e.options.sha2&&a.push(new b(e.options.sha2,"sha256","hex"));const l=o.createWriteStream(e.destination);a.push(l);let c=t;for(const t of a)t.on("error",(t=>{e.options.cancellationToken.cancelled||e.callback(t)})),c=c.pipe(t);l.on("finish",(()=>{l.close(e.callback)}))}(t,r):t.responseHandler(r,t.callback):n<this.maxRedirects?this.doDownload(m.prepareRedirectUrlOptions(i,e),t,n++):t.callback(this.createMaxRedirectError())}));this.addErrorAndTimeoutHandlers(r,t.callback),this.addRedirectHandlers(r,e,t.callback,n,(e=>{this.doDownload(e,t,n++)})),r.end()}createMaxRedirectError(){return new Error(`Too many redirects (> ${this.maxRedirects})`)}addTimeOutHandler(e,t){e.on("socket",(n=>{n.setTimeout(6e4,(()=>{e.abort(),t(new Error("Request timed out"))}))}))}static prepareRedirectUrlOptions(e,t){const n=g(e,{...t}),r=n.headers;if(null==r?void 0:r.authorization){const t=new s.URL(e);(t.hostname.endsWith(".amazonaws.com")||t.searchParams.has("X-Amz-Credential"))&&delete r.authorization}return n}static retryOnServerError(e,t=3){for(let n=0;;n++)try{return e()}catch(e){if(n<t&&(e instanceof f&&e.isServerError()||"EPIPE"===e.code))continue;throw e}}}function g(e,t){const n=y(t);return w(new s.URL(e),n),n}function w(e,t){t.protocol=e.protocol,t.hostname=e.hostname,e.port?t.port=e.port:t.port&&delete t.port,t.path=e.pathname+e.search}t.HttpExecutor=m,t.configureRequestOptionsFromUrl=g,t.configureRequestUrl=w;class b extends a.Transform{constructor(e,t="sha512",n="base64"){super(),this.expected=e,this.algorithm=t,this.encoding=n,this._actual=null,this.isValidateOnEnd=!0,this.digester=r.createHash(t)}get actual(){return this._actual}_transform(e,t,n){this.digester.update(e),n(null,e)}_flush(e){if(this._actual=this.digester.digest(this.encoding),this.isValidateOnEnd)try{this.validate()}catch(t){return void e(t)}e(null)}validate(){if(null==this._actual)throw c.newError("Not finished yet","ERR_STREAM_NOT_FINISHED");if(this._actual!==this.expected)throw c.newError(`${this.algorithm} checksum mismatch, expected ${this.expected}, got ${this._actual}`,"ERR_CHECKSUM_MISMATCH");return null}}function E(e,t){const n=e.headers[t];return null==n?null:Array.isArray(n)?0===n.length?null:n[n.length-1]:n}function y(e,t,n){null!=n&&(e.method=n),e.headers={...e.headers};const r=e.headers;return null!=t&&(r.authorization=t.startsWith("Basic")||t.startsWith("Bearer")?t:`token ${t}`),null==r["User-Agent"]&&(r["User-Agent"]="electron-builder"),null!=n&&"GET"!==n&&null!=r["Cache-Control"]||(r["Cache-Control"]="no-cache"),null==e.protocol&&null!=process.versions.electron&&(e.protocol="https:"),e}function _(e,t){return JSON.stringify(e,((e,n)=>e.endsWith("Authorization")||e.endsWith("authorization")||e.endsWith("Password")||e.endsWith("PASSWORD")||e.endsWith("Token")||e.includes("password")||e.includes("token")||null!=t&&t.has(e)?"<stripped sensitive data>":n),2)}t.DigestTransform=b,t.safeGetHeader=E,t.configureRequestOptions=y,t.safeStringifyJson=_},9152:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.newError=t.asArray=t.CURRENT_APP_PACKAGE_FILE_NAME=t.CURRENT_APP_INSTALLER_FILE_NAME=t.XElement=t.parseXml=t.ProgressCallbackTransform=t.UUID=t.parseDn=t.githubUrl=t.getS3LikeProviderBaseUrl=t.configureRequestUrl=t.parseJson=t.safeStringifyJson=t.configureRequestOptionsFromUrl=t.configureRequestOptions=t.safeGetHeader=t.DigestTransform=t.HttpExecutor=t.createHttpError=t.HttpError=t.CancellationError=t.CancellationToken=void 0;var r=n(7482);Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return r.CancellationToken}}),Object.defineProperty(t,"CancellationError",{enumerable:!0,get:function(){return r.CancellationError}});var i=n(9252);Object.defineProperty(t,"HttpError",{enumerable:!0,get:function(){return i.HttpError}}),Object.defineProperty(t,"createHttpError",{enumerable:!0,get:function(){return i.createHttpError}}),Object.defineProperty(t,"HttpExecutor",{enumerable:!0,get:function(){return i.HttpExecutor}}),Object.defineProperty(t,"DigestTransform",{enumerable:!0,get:function(){return i.DigestTransform}}),Object.defineProperty(t,"safeGetHeader",{enumerable:!0,get:function(){return i.safeGetHeader}}),Object.defineProperty(t,"configureRequestOptions",{enumerable:!0,get:function(){return i.configureRequestOptions}}),Object.defineProperty(t,"configureRequestOptionsFromUrl",{enumerable:!0,get:function(){return i.configureRequestOptionsFromUrl}}),Object.defineProperty(t,"safeStringifyJson",{enumerable:!0,get:function(){return i.safeStringifyJson}}),Object.defineProperty(t,"parseJson",{enumerable:!0,get:function(){return i.parseJson}}),Object.defineProperty(t,"configureRequestUrl",{enumerable:!0,get:function(){return i.configureRequestUrl}});var o=n(2487);Object.defineProperty(t,"getS3LikeProviderBaseUrl",{enumerable:!0,get:function(){return o.getS3LikeProviderBaseUrl}}),Object.defineProperty(t,"githubUrl",{enumerable:!0,get:function(){return o.githubUrl}});var a=n(5524);Object.defineProperty(t,"parseDn",{enumerable:!0,get:function(){return a.parseDn}});var s=n(391);Object.defineProperty(t,"UUID",{enumerable:!0,get:function(){return s.UUID}});var l=n(432);Object.defineProperty(t,"ProgressCallbackTransform",{enumerable:!0,get:function(){return l.ProgressCallbackTransform}});var c=n(1089);Object.defineProperty(t,"parseXml",{enumerable:!0,get:function(){return c.parseXml}}),Object.defineProperty(t,"XElement",{enumerable:!0,get:function(){return c.XElement}}),t.CURRENT_APP_INSTALLER_FILE_NAME="installer.exe",t.CURRENT_APP_PACKAGE_FILE_NAME="package.7z",t.asArray=function(e){return null==e?[]:Array.isArray(e)?e:[e]},t.newError=function(e,t){const n=new Error(e);return n.code=t,n}},2487:(e,t)=>{"use strict";function n(e,t){return null!=t&&t.length>0&&(t.startsWith("/")||(e+="/"),e+=t),e}Object.defineProperty(t,"__esModule",{value:!0}),t.getS3LikeProviderBaseUrl=t.githubUrl=void 0,t.githubUrl=function(e,t="github.com"){return`${e.protocol||"https"}://${e.host||t}`},t.getS3LikeProviderBaseUrl=function(e){const t=e.provider;if("s3"===t)return function(e){let t;if(null!=e.endpoint)t=`${e.endpoint}/${e.bucket}`;else if(e.bucket.includes(".")){if(null==e.region)throw new Error(`Bucket name "${e.bucket}" includes a dot, but S3 region is missing`);t="us-east-1"===e.region?`https://s3.amazonaws.com/${e.bucket}`:`https://s3-${e.region}.amazonaws.com/${e.bucket}`}else t="cn-north-1"===e.region?`https://${e.bucket}.s3.${e.region}.amazonaws.com.cn`:`https://${e.bucket}.s3.amazonaws.com`;return n(t,e.path)}(e);if("spaces"===t)return function(e){if(null==e.name)throw new Error("name is missing");if(null==e.region)throw new Error("region is missing");return n(`https://${e.name}.${e.region}.digitaloceanspaces.com`,e.path)}(e);throw new Error(`Not supported provider: ${t}`)}},5524:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDn=void 0,t.parseDn=function(e){let t=!1,n=null,r="",i=0;e=e.trim();const o=new Map;for(let a=0;a<=e.length;a++){if(a===e.length){null!==n&&o.set(n,r);break}const s=e[a];if(t){if('"'===s){t=!1;continue}}else{if('"'===s){t=!0;continue}if("\\"===s){a++;const t=parseInt(e.slice(a,a+2),16);Number.isNaN(t)?r+=e[a]:(a++,r+=String.fromCharCode(t));continue}if(null===n&&"="===s){n=r,r="";continue}if(","===s||";"===s||"+"===s){null!==n&&o.set(n,r),n=null,r="";continue}}if(" "===s&&!t){if(0===r.length)continue;if(a>i){let t=a;for(;" "===e[t];)t++;i=t}if(i>=e.length||","===e[i]||";"===e[i]||null===n&&"="===e[i]||null!==n&&"+"===e[i]){a=i-1;continue}}r+=s}return o}},391:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nil=t.UUID=void 0;const r=n(6113),i=n(9152),o=r.randomBytes(16);o[0]=1|o[0];const a={},s=[];for(let e=0;e<256;e++){const t=(e+256).toString(16).substr(1);a[t]=e,s[e]=t}class l{constructor(e){this.ascii=null,this.binary=null;const t=l.check(e);if(!t)throw new Error("not a UUID");this.version=t.version,"ascii"===t.format?this.ascii=e:this.binary=e}static v5(e,t){return function(e,t,n,o,a=d.ASCII){const c=r.createHash(t);if("string"!=typeof e&&!Buffer.isBuffer(e))throw i.newError("options.name must be either a string or a Buffer","ERR_INVALID_UUID_NAME");c.update(o),c.update(e);const u=c.digest();let h;switch(a){case d.BINARY:u[6]=15&u[6]|n,u[8]=63&u[8]|128,h=u;break;case d.OBJECT:u[6]=15&u[6]|n,u[8]=63&u[8]|128,h=new l(u);break;default:h=s[u[0]]+s[u[1]]+s[u[2]]+s[u[3]]+"-"+s[u[4]]+s[u[5]]+"-"+s[15&u[6]|n]+s[u[7]]+"-"+s[63&u[8]|128]+s[u[9]]+"-"+s[u[10]]+s[u[11]]+s[u[12]]+s[u[13]]+s[u[14]]+s[u[15]]}return h}(e,"sha1",80,t)}toString(){var e;return null==this.ascii&&(this.ascii=(e=this.binary,s[e[0]]+s[e[1]]+s[e[2]]+s[e[3]]+"-"+s[e[4]]+s[e[5]]+"-"+s[e[6]]+s[e[7]]+"-"+s[e[8]]+s[e[9]]+"-"+s[e[10]]+s[e[11]]+s[e[12]]+s[e[13]]+s[e[14]]+s[e[15]])),this.ascii}inspect(){return`UUID v${this.version} ${this.toString()}`}static check(e,t=0){if("string"==typeof e)return e=e.toLowerCase(),!!/^[a-f0-9]{8}(-[a-f0-9]{4}){3}-([a-f0-9]{12})$/.test(e)&&("00000000-0000-0000-0000-000000000000"===e?{version:void 0,variant:"nil",format:"ascii"}:{version:(240&a[e[14]+e[15]])>>4,variant:c((224&a[e[19]+e[20]])>>5),format:"ascii"});if(Buffer.isBuffer(e)){if(e.length<t+16)return!1;let n=0;for(;n<16&&0===e[t+n];n++);return 16===n?{version:void 0,variant:"nil",format:"binary"}:{version:(240&e[t+6])>>4,variant:c((224&e[t+8])>>5),format:"binary"}}throw i.newError("Unknown type of uuid","ERR_UNKNOWN_UUID_TYPE")}static parse(e){const t=Buffer.allocUnsafe(16);let n=0;for(let r=0;r<16;r++)t[r]=a[e[n++]+e[n++]],3!==r&&5!==r&&7!==r&&9!==r||(n+=1);return t}}function c(e){switch(e){case 0:case 1:case 3:return"ncs";case 4:case 5:return"rfc4122";case 6:return"microsoft";default:return"future"}}var d;t.UUID=l,l.OID=l.parse("6ba7b812-9dad-11d1-80b4-00c04fd430c8"),function(e){e[e.ASCII=0]="ASCII",e[e.BINARY=1]="BINARY",e[e.OBJECT=2]="OBJECT"}(d||(d={})),t.nil=new l("00000000-0000-0000-0000-000000000000")},1089:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseXml=t.XElement=void 0;const r=n(6099),i=n(9152);class o{constructor(e){if(this.name=e,this.value="",this.attributes=null,this.isCData=!1,this.elements=null,!e)throw i.newError("Element name cannot be empty","ERR_XML_ELEMENT_NAME_EMPTY");if(!function(e){return a.test(e)}(e))throw i.newError(`Invalid element name: ${e}`,"ERR_XML_ELEMENT_INVALID_NAME")}attribute(e){const t=null===this.attributes?null:this.attributes[e];if(null==t)throw i.newError(`No attribute "${e}"`,"ERR_XML_MISSED_ATTRIBUTE");return t}removeAttribute(e){null!==this.attributes&&delete this.attributes[e]}element(e,t=!1,n=null){const r=this.elementOrNull(e,t);if(null===r)throw i.newError(n||`No element "${e}"`,"ERR_XML_MISSED_ELEMENT");return r}elementOrNull(e,t=!1){if(null===this.elements)return null;for(const n of this.elements)if(s(n,e,t))return n;return null}getElements(e,t=!1){return null===this.elements?[]:this.elements.filter((n=>s(n,e,t)))}elementValueOrEmpty(e,t=!1){const n=this.elementOrNull(e,t);return null===n?"":n.value}}t.XElement=o;const a=new RegExp(/^[A-Za-z_][:A-Za-z0-9_-]*$/i);function s(e,t,n){const r=e.name;return r===t||!0===n&&r.length===t.length&&r.toLowerCase()===t.toLowerCase()}t.parseXml=function(e){let t=null;const n=r.parser(!0,{}),i=[];return n.onopentag=e=>{const n=new o(e.name);if(n.attributes=e.attributes,null===t)t=n;else{const e=i[i.length-1];null==e.elements&&(e.elements=[]),e.elements.push(n)}i.push(n)},n.onclosetag=()=>{i.pop()},n.ontext=e=>{i.length>0&&(i[i.length-1].value=e)},n.oncdata=e=>{const t=i[i.length-1];t.value=e,t.isCData=!0},n.onerror=e=>{throw e},n.write(e),t}},1639:(e,t,n)=>{const r=Symbol("SemVer ANY");class i{static get ANY(){return r}constructor(e,t){if(t=o(t),e instanceof i){if(e.loose===!!t.loose)return e;e=e.value}c("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===r?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(e){const t=this.options.loose?a[s.COMPARATORLOOSE]:a[s.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new d(n[2],this.options.loose):this.semver=r}toString(){return this.value}test(e){if(c("Comparator.test",e,this.options.loose),this.semver===r||e===r)return!0;if("string"==typeof e)try{e=new d(e,this.options)}catch(e){return!1}return l(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof i))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new u(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new u(this.value,t).test(e.semver);const n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),r=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),o=this.semver.version===e.semver.version,a=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),s=l(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=l(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||r||o&&a||s||c}}e.exports=i;const o=n(8276),{re:a,t:s}=n(8591),l=n(2157),c=n(503),d=n(9753),u=n(7163)},7163:(e,t,n)=>{class r{constructor(e,t){if(t=o(t),e instanceof r)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new r(e.raw,t);if(e instanceof a)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!f(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&m(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();const t=`parseRange:${Object.keys(this.options).join(",")}:${e}`,n=i.get(t);if(n)return n;const r=this.options.loose,o=r?c[d.HYPHENRANGELOOSE]:c[d.HYPHENRANGE];e=e.replace(o,O(this.options.includePrerelease)),s("hyphen replace",e),e=e.replace(c[d.COMPARATORTRIM],u),s("comparator trim",e,c[d.COMPARATORTRIM]),e=(e=(e=e.replace(c[d.TILDETRIM],h)).replace(c[d.CARETTRIM],p)).split(/\s+/).join(" ");const l=r?c[d.COMPARATORLOOSE]:c[d.COMPARATOR],m=e.split(" ").map((e=>w(e,this.options))).join(" ").split(/\s+/).map((e=>I(e,this.options))).filter(this.options.loose?e=>!!e.match(l):()=>!0).map((e=>new a(e,this.options))),g=(m.length,new Map);for(const e of m){if(f(e))return[e];g.set(e.value,e)}g.size>1&&g.has("")&&g.delete("");const b=[...g.values()];return i.set(t,b),b}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Range is required");return this.set.some((n=>g(n,t)&&e.set.some((e=>g(e,t)&&n.every((n=>e.every((e=>n.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new l(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(R(this.set[t],e,this.options))return!0;return!1}}e.exports=r;const i=new(n(9593))({max:1e3}),o=n(8276),a=n(1639),s=n(503),l=n(9753),{re:c,t:d,comparatorTrimReplace:u,tildeTrimReplace:h,caretTrimReplace:p}=n(8591),f=e=>"<0.0.0-0"===e.value,m=e=>""===e.value,g=(e,t)=>{let n=!0;const r=e.slice();let i=r.pop();for(;n&&r.length;)n=r.every((e=>i.intersects(e,t))),i=r.pop();return n},w=(e,t)=>(s("comp",e,t),e=_(e,t),s("caret",e),e=E(e,t),s("tildes",e),e=C(e,t),s("xrange",e),e=T(e,t),s("stars",e),e),b=e=>!e||"x"===e.toLowerCase()||"*"===e,E=(e,t)=>e.trim().split(/\s+/).map((e=>y(e,t))).join(" "),y=(e,t)=>{const n=t.loose?c[d.TILDELOOSE]:c[d.TILDE];return e.replace(n,((t,n,r,i,o)=>{let a;return s("tilde",e,t,n,r,i,o),b(n)?a="":b(r)?a=`>=${n}.0.0 <${+n+1}.0.0-0`:b(i)?a=`>=${n}.${r}.0 <${n}.${+r+1}.0-0`:o?(s("replaceTilde pr",o),a=`>=${n}.${r}.${i}-${o} <${n}.${+r+1}.0-0`):a=`>=${n}.${r}.${i} <${n}.${+r+1}.0-0`,s("tilde return",a),a}))},_=(e,t)=>e.trim().split(/\s+/).map((e=>v(e,t))).join(" "),v=(e,t)=>{s("caret",e,t);const n=t.loose?c[d.CARETLOOSE]:c[d.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,((t,n,i,o,a)=>{let l;return s("caret",e,t,n,i,o,a),b(n)?l="":b(i)?l=`>=${n}.0.0${r} <${+n+1}.0.0-0`:b(o)?l="0"===n?`>=${n}.${i}.0${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.0${r} <${+n+1}.0.0-0`:a?(s("replaceCaret pr",a),l="0"===n?"0"===i?`>=${n}.${i}.${o}-${a} <${n}.${i}.${+o+1}-0`:`>=${n}.${i}.${o}-${a} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${o}-${a} <${+n+1}.0.0-0`):(s("no pr"),l="0"===n?"0"===i?`>=${n}.${i}.${o}${r} <${n}.${i}.${+o+1}-0`:`>=${n}.${i}.${o}${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${o} <${+n+1}.0.0-0`),s("caret return",l),l}))},C=(e,t)=>(s("replaceXRanges",e,t),e.split(/\s+/).map((e=>A(e,t))).join(" ")),A=(e,t)=>{e=e.trim();const n=t.loose?c[d.XRANGELOOSE]:c[d.XRANGE];return e.replace(n,((n,r,i,o,a,l)=>{s("xRange",e,n,r,i,o,a,l);const c=b(i),d=c||b(o),u=d||b(a),h=u;return"="===r&&h&&(r=""),l=t.includePrerelease?"-0":"",c?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&h?(d&&(o=0),a=0,">"===r?(r=">=",d?(i=+i+1,o=0,a=0):(o=+o+1,a=0)):"<="===r&&(r="<",d?i=+i+1:o=+o+1),"<"===r&&(l="-0"),n=`${r+i}.${o}.${a}${l}`):d?n=`>=${i}.0.0${l} <${+i+1}.0.0-0`:u&&(n=`>=${i}.${o}.0${l} <${i}.${+o+1}.0-0`),s("xRange return",n),n}))},T=(e,t)=>(s("replaceStars",e,t),e.trim().replace(c[d.STAR],"")),I=(e,t)=>(s("replaceGTE0",e,t),e.trim().replace(c[t.includePrerelease?d.GTE0PRE:d.GTE0],"")),O=e=>(t,n,r,i,o,a,s,l,c,d,u,h,p)=>`${n=b(r)?"":b(i)?`>=${r}.0.0${e?"-0":""}`:b(o)?`>=${r}.${i}.0${e?"-0":""}`:a?`>=${n}`:`>=${n}${e?"-0":""}`} ${l=b(c)?"":b(d)?`<${+c+1}.0.0-0`:b(u)?`<${c}.${+d+1}.0-0`:h?`<=${c}.${d}.${u}-${h}`:e?`<${c}.${d}.${+u+1}-0`:`<=${l}`}`.trim(),R=(e,t,n)=>{for(let n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let n=0;n<e.length;n++)if(s(e[n].semver),e[n].semver!==a.ANY&&e[n].semver.prerelease.length>0){const r=e[n].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0}},9753:(e,t,n)=>{const r=n(503),{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=n(3212),{re:a,t:s}=n(8591),l=n(8276),{compareIdentifiers:c}=n(6386);class d{constructor(e,t){if(t=l(t),e instanceof d){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid Version: ${e}`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?a[s.LOOSE]:a[s.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<o)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof d)){if("string"==typeof e&&e===this.version)return 0;e=new d(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof d||(e=new d(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof d||(e=new d(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return c(n,i)}while(++t)}compareBuild(e){e instanceof d||(e=new d(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return c(n,i)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}e.exports=d},8228:(e,t,n)=>{const r=n(8118);e.exports=(e,t)=>{const n=r(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}},2157:(e,t,n)=>{const r=n(6208),i=n(4722),o=n(1607),a=n(7839),s=n(4319),l=n(4834);e.exports=(e,t,n,c)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return r(e,n,c);case"!=":return i(e,n,c);case">":return o(e,n,c);case">=":return a(e,n,c);case"<":return s(e,n,c);case"<=":return l(e,n,c);default:throw new TypeError(`Invalid operator: ${t}`)}}},301:(e,t,n)=>{const r=n(9753),i=n(8118),{re:o,t:a}=n(8591);e.exports=(e,t)=>{if(e instanceof r)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let n=null;if((t=t||{}).rtl){let t;for(;(t=o[a.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&t.index+t[0].length===n.index+n[0].length||(n=t),o[a.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;o[a.COERCERTL].lastIndex=-1}else n=e.match(o[a.COERCE]);return null===n?null:i(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)}},5459:(e,t,n)=>{const r=n(9753);e.exports=(e,t,n)=>{const i=new r(e,n),o=new r(t,n);return i.compare(o)||i.compareBuild(o)}},3145:(e,t,n)=>{const r=n(5716);e.exports=(e,t)=>r(e,t,!0)},5716:(e,t,n)=>{const r=n(9753);e.exports=(e,t,n)=>new r(e,n).compare(new r(t,n))},3745:(e,t,n)=>{const r=n(8118),i=n(6208);e.exports=(e,t)=>{if(i(e,t))return null;{const n=r(e),i=r(t),o=n.prerelease.length||i.prerelease.length,a=o?"pre":"",s=o?"prerelease":"";for(const e in n)if(("major"===e||"minor"===e||"patch"===e)&&n[e]!==i[e])return a+e;return s}}},6208:(e,t,n)=>{const r=n(5716);e.exports=(e,t,n)=>0===r(e,t,n)},1607:(e,t,n)=>{const r=n(5716);e.exports=(e,t,n)=>r(e,t,n)>0},7839:(e,t,n)=>{const r=n(5716);e.exports=(e,t,n)=>r(e,t,n)>=0},4603:(e,t,n)=>{const r=n(9753);e.exports=(e,t,n,i)=>{"string"==typeof n&&(i=n,n=void 0);try{return new r(e,n).inc(t,i).version}catch(e){return null}}},4319:(e,t,n)=>{const r=n(5716);e.exports=(e,t,n)=>r(e,t,n)<0},4834:(e,t,n)=>{const r=n(5716);e.exports=(e,t,n)=>r(e,t,n)<=0},8913:(e,t,n)=>{const r=n(9753);e.exports=(e,t)=>new r(e,t).major},3273:(e,t,n)=>{const r=n(9753);e.exports=(e,t)=>new r(e,t).minor},4722:(e,t,n)=>{const r=n(5716);e.exports=(e,t,n)=>0!==r(e,t,n)},8118:(e,t,n)=>{const{MAX_LENGTH:r}=n(3212),{re:i,t:o}=n(8591),a=n(9753),s=n(8276);e.exports=(e,t)=>{if(t=s(t),e instanceof a)return e;if("string"!=typeof e)return null;if(e.length>r)return null;if(!(t.loose?i[o.LOOSE]:i[o.FULL]).test(e))return null;try{return new a(e,t)}catch(e){return null}}},5546:(e,t,n)=>{const r=n(9753);e.exports=(e,t)=>new r(e,t).patch},5502:(e,t,n)=>{const r=n(8118);e.exports=(e,t)=>{const n=r(e,t);return n&&n.prerelease.length?n.prerelease:null}},8135:(e,t,n)=>{const r=n(5716);e.exports=(e,t,n)=>r(t,e,n)},3072:(e,t,n)=>{const r=n(5459);e.exports=(e,t)=>e.sort(((e,n)=>r(n,e,t)))},6178:(e,t,n)=>{const r=n(7163);e.exports=(e,t,n)=>{try{t=new r(t,n)}catch(e){return!1}return t.test(e)}},8147:(e,t,n)=>{const r=n(5459);e.exports=(e,t)=>e.sort(((e,n)=>r(e,n,t)))},1051:(e,t,n)=>{const r=n(8118);e.exports=(e,t)=>{const n=r(e,t);return n?n.version:null}},6158:(e,t,n)=>{const r=n(8591);e.exports={re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:n(3212).SEMVER_SPEC_VERSION,SemVer:n(9753),compareIdentifiers:n(6386).compareIdentifiers,rcompareIdentifiers:n(6386).rcompareIdentifiers,parse:n(8118),valid:n(1051),clean:n(8228),inc:n(4603),diff:n(3745),major:n(8913),minor:n(3273),patch:n(5546),prerelease:n(5502),compare:n(5716),rcompare:n(8135),compareLoose:n(3145),compareBuild:n(5459),sort:n(8147),rsort:n(3072),gt:n(1607),lt:n(4319),eq:n(6208),neq:n(4722),gte:n(7839),lte:n(4834),cmp:n(2157),coerce:n(301),Comparator:n(1639),Range:n(7163),satisfies:n(6178),toComparators:n(6862),maxSatisfying:n(4518),minSatisfying:n(1431),minVersion:n(4243),validRange:n(8281),outside:n(2543),gtr:n(6565),ltr:n(1689),intersects:n(6523),simplifyRange:n(167),subset:n(474)}},3212:e=>{const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:t,MAX_SAFE_COMPONENT_LENGTH:16}},503:e=>{const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},6386:e=>{const t=/^[0-9]+$/,n=(e,n)=>{const r=t.test(e),i=t.test(n);return r&&i&&(e=+e,n=+n),e===n?0:r&&!i?-1:i&&!r?1:e<n?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},8276:e=>{const t=["includePrerelease","loose","rtl"];e.exports=e=>e?"object"!=typeof e?{loose:!0}:t.filter((t=>e[t])).reduce(((e,t)=>(e[t]=!0,e)),{}):{}},8591:(e,t,n)=>{const{MAX_SAFE_COMPONENT_LENGTH:r}=n(3212),i=n(503),o=(t=e.exports={}).re=[],a=t.src=[],s=t.t={};let l=0;const c=(e,t,n)=>{const r=l++;i(r,t),s[e]=r,a[r]=t,o[r]=new RegExp(t,n?"g":void 0)};c("NUMERICIDENTIFIER","0|[1-9]\\d*"),c("NUMERICIDENTIFIERLOOSE","[0-9]+"),c("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),c("MAINVERSION",`(${a[s.NUMERICIDENTIFIER]})\\.(${a[s.NUMERICIDENTIFIER]})\\.(${a[s.NUMERICIDENTIFIER]})`),c("MAINVERSIONLOOSE",`(${a[s.NUMERICIDENTIFIERLOOSE]})\\.(${a[s.NUMERICIDENTIFIERLOOSE]})\\.(${a[s.NUMERICIDENTIFIERLOOSE]})`),c("PRERELEASEIDENTIFIER",`(?:${a[s.NUMERICIDENTIFIER]}|${a[s.NONNUMERICIDENTIFIER]})`),c("PRERELEASEIDENTIFIERLOOSE",`(?:${a[s.NUMERICIDENTIFIERLOOSE]}|${a[s.NONNUMERICIDENTIFIER]})`),c("PRERELEASE",`(?:-(${a[s.PRERELEASEIDENTIFIER]}(?:\\.${a[s.PRERELEASEIDENTIFIER]})*))`),c("PRERELEASELOOSE",`(?:-?(${a[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${a[s.PRERELEASEIDENTIFIERLOOSE]})*))`),c("BUILDIDENTIFIER","[0-9A-Za-z-]+"),c("BUILD",`(?:\\+(${a[s.BUILDIDENTIFIER]}(?:\\.${a[s.BUILDIDENTIFIER]})*))`),c("FULLPLAIN",`v?${a[s.MAINVERSION]}${a[s.PRERELEASE]}?${a[s.BUILD]}?`),c("FULL",`^${a[s.FULLPLAIN]}$`),c("LOOSEPLAIN",`[v=\\s]*${a[s.MAINVERSIONLOOSE]}${a[s.PRERELEASELOOSE]}?${a[s.BUILD]}?`),c("LOOSE",`^${a[s.LOOSEPLAIN]}$`),c("GTLT","((?:<|>)?=?)"),c("XRANGEIDENTIFIERLOOSE",`${a[s.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),c("XRANGEIDENTIFIER",`${a[s.NUMERICIDENTIFIER]}|x|X|\\*`),c("XRANGEPLAIN",`[v=\\s]*(${a[s.XRANGEIDENTIFIER]})(?:\\.(${a[s.XRANGEIDENTIFIER]})(?:\\.(${a[s.XRANGEIDENTIFIER]})(?:${a[s.PRERELEASE]})?${a[s.BUILD]}?)?)?`),c("XRANGEPLAINLOOSE",`[v=\\s]*(${a[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[s.XRANGEIDENTIFIERLOOSE]})(?:${a[s.PRERELEASELOOSE]})?${a[s.BUILD]}?)?)?`),c("XRANGE",`^${a[s.GTLT]}\\s*${a[s.XRANGEPLAIN]}$`),c("XRANGELOOSE",`^${a[s.GTLT]}\\s*${a[s.XRANGEPLAINLOOSE]}$`),c("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),c("COERCERTL",a[s.COERCE],!0),c("LONETILDE","(?:~>?)"),c("TILDETRIM",`(\\s*)${a[s.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",c("TILDE",`^${a[s.LONETILDE]}${a[s.XRANGEPLAIN]}$`),c("TILDELOOSE",`^${a[s.LONETILDE]}${a[s.XRANGEPLAINLOOSE]}$`),c("LONECARET","(?:\\^)"),c("CARETTRIM",`(\\s*)${a[s.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",c("CARET",`^${a[s.LONECARET]}${a[s.XRANGEPLAIN]}$`),c("CARETLOOSE",`^${a[s.LONECARET]}${a[s.XRANGEPLAINLOOSE]}$`),c("COMPARATORLOOSE",`^${a[s.GTLT]}\\s*(${a[s.LOOSEPLAIN]})$|^$`),c("COMPARATOR",`^${a[s.GTLT]}\\s*(${a[s.FULLPLAIN]})$|^$`),c("COMPARATORTRIM",`(\\s*)${a[s.GTLT]}\\s*(${a[s.LOOSEPLAIN]}|${a[s.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",c("HYPHENRANGE",`^\\s*(${a[s.XRANGEPLAIN]})\\s+-\\s+(${a[s.XRANGEPLAIN]})\\s*$`),c("HYPHENRANGELOOSE",`^\\s*(${a[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${a[s.XRANGEPLAINLOOSE]})\\s*$`),c("STAR","(<|>)?=?\\s*\\*"),c("GTE0","^\\s*>=\\s*0.0.0\\s*$"),c("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},6565:(e,t,n)=>{const r=n(2543);e.exports=(e,t,n)=>r(e,t,">",n)},6523:(e,t,n)=>{const r=n(7163);e.exports=(e,t,n)=>(e=new r(e,n),t=new r(t,n),e.intersects(t))},1689:(e,t,n)=>{const r=n(2543);e.exports=(e,t,n)=>r(e,t,"<",n)},4518:(e,t,n)=>{const r=n(9753),i=n(7163);e.exports=(e,t,n)=>{let o=null,a=null,s=null;try{s=new i(t,n)}catch(e){return null}return e.forEach((e=>{s.test(e)&&(o&&-1!==a.compare(e)||(o=e,a=new r(o,n)))})),o}},1431:(e,t,n)=>{const r=n(9753),i=n(7163);e.exports=(e,t,n)=>{let o=null,a=null,s=null;try{s=new i(t,n)}catch(e){return null}return e.forEach((e=>{s.test(e)&&(o&&1!==a.compare(e)||(o=e,a=new r(o,n)))})),o}},4243:(e,t,n)=>{const r=n(9753),i=n(7163),o=n(1607);e.exports=(e,t)=>{e=new i(e,t);let n=new r("0.0.0");if(e.test(n))return n;if(n=new r("0.0.0-0"),e.test(n))return n;n=null;for(let t=0;t<e.set.length;++t){const i=e.set[t];let a=null;i.forEach((e=>{const t=new r(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":a&&!o(t,a)||(a=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!a||n&&!o(n,a)||(n=a)}return n&&e.test(n)?n:null}},2543:(e,t,n)=>{const r=n(9753),i=n(1639),{ANY:o}=i,a=n(7163),s=n(6178),l=n(1607),c=n(4319),d=n(4834),u=n(7839);e.exports=(e,t,n,h)=>{let p,f,m,g,w;switch(e=new r(e,h),t=new a(t,h),n){case">":p=l,f=d,m=c,g=">",w=">=";break;case"<":p=c,f=u,m=l,g="<",w="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(e,t,h))return!1;for(let n=0;n<t.set.length;++n){const r=t.set[n];let a=null,s=null;if(r.forEach((e=>{e.semver===o&&(e=new i(">=0.0.0")),a=a||e,s=s||e,p(e.semver,a.semver,h)?a=e:m(e.semver,s.semver,h)&&(s=e)})),a.operator===g||a.operator===w)return!1;if((!s.operator||s.operator===g)&&f(e,s.semver))return!1;if(s.operator===w&&m(e,s.semver))return!1}return!0}},167:(e,t,n)=>{const r=n(6178),i=n(5716);e.exports=(e,t,n)=>{const o=[];let a=null,s=null;const l=e.sort(((e,t)=>i(e,t,n)));for(const e of l)r(e,t,n)?(s=e,a||(a=e)):(s&&o.push([a,s]),s=null,a=null);a&&o.push([a,null]);const c=[];for(const[e,t]of o)e===t?c.push(e):t||e!==l[0]?t?e===l[0]?c.push(`<=${t}`):c.push(`${e} - ${t}`):c.push(`>=${e}`):c.push("*");const d=c.join(" || "),u="string"==typeof t.raw?t.raw:String(t);return d.length<u.length?d:t}},474:(e,t,n)=>{const r=n(7163),i=n(1639),{ANY:o}=i,a=n(6178),s=n(5716),l=(e,t,n)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===o){if(1===t.length&&t[0].semver===o)return!0;e=n.includePrerelease?[new i(">=0.0.0-0")]:[new i(">=0.0.0")]}if(1===t.length&&t[0].semver===o){if(n.includePrerelease)return!0;t=[new i(">=0.0.0")]}const r=new Set;let l,u,h,p,f,m,g;for(const t of e)">"===t.operator||">="===t.operator?l=c(l,t,n):"<"===t.operator||"<="===t.operator?u=d(u,t,n):r.add(t.semver);if(r.size>1)return null;if(l&&u){if(h=s(l.semver,u.semver,n),h>0)return null;if(0===h&&(">="!==l.operator||"<="!==u.operator))return null}for(const e of r){if(l&&!a(e,String(l),n))return null;if(u&&!a(e,String(u),n))return null;for(const r of t)if(!a(e,String(r),n))return!1;return!0}let w=!(!u||n.includePrerelease||!u.semver.prerelease.length)&&u.semver,b=!(!l||n.includePrerelease||!l.semver.prerelease.length)&&l.semver;w&&1===w.prerelease.length&&"<"===u.operator&&0===w.prerelease[0]&&(w=!1);for(const e of t){if(g=g||">"===e.operator||">="===e.operator,m=m||"<"===e.operator||"<="===e.operator,l)if(b&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===b.major&&e.semver.minor===b.minor&&e.semver.patch===b.patch&&(b=!1),">"===e.operator||">="===e.operator){if(p=c(l,e,n),p===e&&p!==l)return!1}else if(">="===l.operator&&!a(l.semver,String(e),n))return!1;if(u)if(w&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===w.major&&e.semver.minor===w.minor&&e.semver.patch===w.patch&&(w=!1),"<"===e.operator||"<="===e.operator){if(f=d(u,e,n),f===e&&f!==u)return!1}else if("<="===u.operator&&!a(u.semver,String(e),n))return!1;if(!e.operator&&(u||l)&&0!==h)return!1}return!(l&&m&&!u&&0!==h||u&&g&&!l&&0!==h||b||w)},c=(e,t,n)=>{if(!e)return t;const r=s(e.semver,t.semver,n);return r>0?e:r<0||">"===t.operator&&">="===e.operator?t:e},d=(e,t,n)=>{if(!e)return t;const r=s(e.semver,t.semver,n);return r<0?e:r>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,n={})=>{if(e===t)return!0;e=new r(e,n),t=new r(t,n);let i=!1;e:for(const r of e.set){for(const e of t.set){const t=l(r,e,n);if(i=i||null!==t,t)continue e}if(i)return!1}return!0}},6862:(e,t,n)=>{const r=n(7163);e.exports=(e,t)=>new r(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},8281:(e,t,n)=>{const r=n(7163);e.exports=(e,t)=>{try{return new r(e,t).range||"*"}catch(e){return null}}},6110:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAppCacheDir=void 0;const r=n(1017),i=n(2037);t.getAppCacheDir=function(){const e=i.homedir();let t;return t="win32"===process.platform?process.env.LOCALAPPDATA||r.join(e,"AppData","Local"):"darwin"===process.platform?r.join(e,"Library","Application Support","Caches"):process.env.XDG_CACHE_HOME||r.join(e,".cache"),t}},3405:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppImageUpdater=void 0;const r=n(9152),i=n(2081),o=n(4857),a=n(7147),s=n(1017),l=n(4502),c=n(3458),d=n(7430),u=n(2310);class h extends l.BaseUpdater{constructor(e,t){super(e,t)}isUpdaterActive(){return null==process.env.APPIMAGE?(null==process.env.SNAP?this._logger.warn("APPIMAGE env is not defined, current application is not an AppImage"):this._logger.info("SNAP env is defined, updater is disabled"),!1):super.isUpdaterActive()}doDownloadUpdate(e){const t=e.updateInfoAndProvider.provider,n=u.findFile(t.resolveFiles(e.updateInfoAndProvider.info),"AppImage");return this.executeDownload({fileExtension:"AppImage",fileInfo:n,downloadUpdateOptions:e,task:async(i,a)=>{const s=process.env.APPIMAGE;if(null==s)throw r.newError("APPIMAGE env is not defined","ERR_UPDATER_OLD_FILE_NOT_FOUND");let l=!1;try{const r={newUrl:n.url,oldFile:s,logger:this._logger,newFile:i,isUseMultipleRangeRequest:t.isUseMultipleRangeRequest,requestHeaders:e.requestHeaders,cancellationToken:e.cancellationToken};this.listenerCount(d.DOWNLOAD_PROGRESS)>0&&(r.onProgress=e=>this.emit(d.DOWNLOAD_PROGRESS,e)),await new c.FileWithEmbeddedBlockMapDifferentialDownloader(n.info,this.httpExecutor,r).download()}catch(e){this._logger.error(`Cannot download differentially, fallback to full download: ${e.stack||e}`),l="linux"===process.platform}l&&await this.httpExecutor.download(n.url,i,a),await o.chmod(i,493)}})}doInstall(e){const t=process.env.APPIMAGE;if(null==t)throw r.newError("APPIMAGE env is not defined","ERR_UPDATER_OLD_FILE_NOT_FOUND");let n;a.unlinkSync(t);const o=s.basename(t);n=s.basename(e.installerPath)!==o&&/\d+\.\d+\.\d+/.test(o)?s.join(s.dirname(t),s.basename(e.installerPath)):t,i.execFileSync("mv",["-f",e.installerPath,n]),n!==t&&this.emit("appimage-filename-updated",n);const l={...process.env,APPIMAGE_SILENT_INSTALL:"true"};return e.isForceRunAfter?i.spawn(n,[],{detached:!0,stdio:"ignore",env:l}).unref():(l.APPIMAGE_EXIT_AFTER_INSTALL="true",i.execFileSync(n,[],{env:l})),!0}}t.AppImageUpdater=h},8459:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoOpLogger=t.AppUpdater=void 0;const r=n(9152),i=n(6113),o=n(2361),a=n(4857),s=n(3292),l=n(3320),c=n(8218),d=n(1017),u=n(6158),h=n(2837),p=n(6431),f=n(1890),m=n(1554),g=n(7430),w=n(4985);class b extends o.EventEmitter{constructor(e,t){super(),this.autoDownload=!0,this.autoInstallOnAppQuit=!0,this.allowPrerelease=!1,this.fullChangelog=!1,this.allowDowngrade=!1,this._channel=null,this.downloadedUpdateHelper=null,this.requestHeaders=null,this._logger=console,this.signals=new g.UpdaterSignal(this),this._appUpdateConfigPath=null,this.clientPromise=null,this.stagingUserIdPromise=new c.Lazy((()=>this.getOrCreateStagingUserId())),this.configOnDisk=new c.Lazy((()=>this.loadUpdateConfig())),this.checkForUpdatesPromise=null,this.updateInfoAndProvider=null,this._testOnlyOptions=null,this.on("error",(e=>{this._logger.error(`Error: ${e.stack||e.message}`)})),null==t?(this.app=new p.ElectronAppAdapter,this.httpExecutor=new f.ElectronHttpExecutor(((e,t)=>this.emit("login",e,t)))):(this.app=t,this.httpExecutor=null);const n=this.app.version,i=u.parse(n);if(null==i)throw r.newError(`App version is not a valid semver version: "${n}"`,"ERR_UPDATER_INVALID_VERSION");this.currentVersion=i,this.allowPrerelease=function(e){const t=u.prerelease(e);return null!=t&&t.length>0}(i),null!=e&&(this.setFeedURL(e),"string"!=typeof e&&e.requestHeaders&&(this.requestHeaders=e.requestHeaders))}get channel(){return this._channel}set channel(e){if(null!=this._channel){if("string"!=typeof e)throw r.newError(`Channel must be a string, but got: ${e}`,"ERR_UPDATER_INVALID_CHANNEL");if(0===e.length)throw r.newError("Channel must be not an empty string","ERR_UPDATER_INVALID_CHANNEL")}this._channel=e,this.allowDowngrade=!0}addAuthHeader(e){this.requestHeaders=Object.assign({},this.requestHeaders,{authorization:e})}get netSession(){return f.getNetSession()}get logger(){return this._logger}set logger(e){this._logger=null==e?new E:e}set updateConfigPath(e){this.clientPromise=null,this._appUpdateConfigPath=e,this.configOnDisk=new c.Lazy((()=>this.loadUpdateConfig()))}getFeedURL(){return"Deprecated. Do not use it."}setFeedURL(e){const t=this.createProviderRuntimeOptions();let n;n="string"==typeof e?new m.GenericProvider({provider:"generic",url:e},this,{...t,isUseMultipleRangeRequest:w.isUrlProbablySupportMultiRangeRequests(e)}):w.createClient(e,this,t),this.clientPromise=Promise.resolve(n)}checkForUpdates(){let e=this.checkForUpdatesPromise;if(null!=e)return this._logger.info("Checking for update (already in progress)"),e;const t=()=>this.checkForUpdatesPromise=null;return this._logger.info("Checking for update"),e=this.doCheckForUpdates().then((e=>(t(),e))).catch((e=>{throw t(),this.emit("error",e,`Cannot check for updates: ${(e.stack||e).toString()}`),e})),this.checkForUpdatesPromise=e,e}isUpdaterActive(){return!!this.app.isPackaged||(this._logger.info("Skip checkForUpdatesAndNotify because application is not packed"),!1)}checkForUpdatesAndNotify(e){return this.isUpdaterActive()?this.checkForUpdates().then((t=>{const r=t.downloadPromise;return null==r?(null!=this._logger.debug&&this._logger.debug("checkForUpdatesAndNotify called, downloadPromise is null"),t):(r.then((()=>{const r=b.formatDownloadNotification(t.updateInfo.version,this.app.name,e);new(n(2298).Notification)(r).show()})),t)})):Promise.resolve(null)}static formatDownloadNotification(e,t,n){return null==n&&(n={title:"A new update is ready to install",body:"{appName} version {version} has been downloaded and will be automatically installed on exit"}),{title:n.title.replace("{appName}",t).replace("{version}",e),body:n.body.replace("{appName}",t).replace("{version}",e)}}async isStagingMatch(e){const t=e.stagingPercentage;let n=t;if(null==n)return!0;if(n=parseInt(n,10),isNaN(n))return this._logger.warn(`Staging percentage is NaN: ${t}`),!0;n/=100;const i=await this.stagingUserIdPromise.value,o=r.UUID.parse(i).readUInt32BE(12)/4294967295;return this._logger.info(`Staging percentage: ${n}, percentage: ${o}, user id: ${i}`),o<n}computeFinalHeaders(e){return null!=this.requestHeaders&&Object.assign(e,this.requestHeaders),e}async isUpdateAvailable(e){const t=u.parse(e.version);if(null==t)throw r.newError(`This file could not be downloaded, or the latest version (from update server) does not have a valid semver version: "${e.version}"`,"ERR_UPDATER_INVALID_VERSION");const n=this.currentVersion;if(u.eq(t,n))return!1;if(!await this.isStagingMatch(e))return!1;const i=u.gt(t,n),o=u.lt(t,n);return!!i||this.allowDowngrade&&o}async getUpdateInfoAndProvider(){await this.app.whenReady(),null==this.clientPromise&&(this.clientPromise=this.configOnDisk.value.then((e=>w.createClient(e,this,this.createProviderRuntimeOptions()))));const e=await this.clientPromise,t=await this.stagingUserIdPromise.value;return e.setRequestHeaders(this.computeFinalHeaders({"x-user-staging-id":t})),{info:await e.getLatestVersion(),provider:e}}createProviderRuntimeOptions(){return{isUseMultipleRangeRequest:!0,platform:null==this._testOnlyOptions?process.platform:this._testOnlyOptions.platform,executor:this.httpExecutor}}async doCheckForUpdates(){this.emit("checking-for-update");const e=await this.getUpdateInfoAndProvider(),t=e.info;if(!await this.isUpdateAvailable(t))return this._logger.info(`Update for version ${this.currentVersion} is not available (latest version: ${t.version}, downgrade is ${this.allowDowngrade?"allowed":"disallowed"}).`),this.emit("update-not-available",t),{versionInfo:t,updateInfo:t};this.updateInfoAndProvider=e,this.onUpdateAvailable(t);const n=new r.CancellationToken;return{versionInfo:t,updateInfo:t,cancellationToken:n,downloadPromise:this.autoDownload?this.downloadUpdate(n):null}}onUpdateAvailable(e){this._logger.info(`Found version ${e.version} (url: ${r.asArray(e.files).map((e=>e.url)).join(", ")})`),this.emit("update-available",e)}downloadUpdate(e=new r.CancellationToken){const t=this.updateInfoAndProvider;if(null==t){const e=new Error("Please check update first");return this.dispatchError(e),Promise.reject(e)}this._logger.info(`Downloading update from ${r.asArray(t.info.files).map((e=>e.url)).join(", ")}`);const n=e=>{if(!(e instanceof r.CancellationError))try{this.dispatchError(e)}catch(e){this._logger.warn(`Cannot dispatch error event: ${e.stack||e}`)}return e};try{return this.doDownloadUpdate({updateInfoAndProvider:t,requestHeaders:this.computeRequestHeaders(t.provider),cancellationToken:e}).catch((e=>{throw n(e)}))}catch(e){return Promise.reject(n(e))}}dispatchError(e){this.emit("error",e,(e.stack||e).toString())}dispatchUpdateDownloaded(e){this.emit(g.UPDATE_DOWNLOADED,e)}async loadUpdateConfig(){return null==this._appUpdateConfigPath&&(this._appUpdateConfigPath=this.app.appUpdateConfigPath),l.load(await s.readFile(this._appUpdateConfigPath,"utf-8"))}computeRequestHeaders(e){const t=e.fileExtraDownloadHeaders;if(null!=t){const e=this.requestHeaders;return null==e?t:{...t,...e}}return this.computeFinalHeaders({accept:"*/*"})}async getOrCreateStagingUserId(){const e=d.join(this.app.userDataPath,".updaterId");try{const t=await s.readFile(e,"utf-8");if(r.UUID.check(t))return t;this._logger.warn(`Staging user id file exists, but content was invalid: ${t}`)}catch(e){"ENOENT"!==e.code&&this._logger.warn(`Couldn't read staging user ID, creating a blank one: ${e}`)}const t=r.UUID.v5(i.randomBytes(4096),r.UUID.OID);this._logger.info(`Generated new staging user ID: ${t}`);try{await a.outputFile(e,t)}catch(e){this._logger.warn(`Couldn't write out staging user ID: ${e}`)}return t}get isAddNoCacheQuery(){const e=this.requestHeaders;if(null==e)return!0;for(const t of Object.keys(e)){const e=t.toLowerCase();if("authorization"===e||"private-token"===e)return!1}return!0}async getOrCreateDownloadHelper(){let e=this.downloadedUpdateHelper;if(null==e){const t=(await this.configOnDisk.value).updaterCacheDirName,n=this._logger;null==t&&n.error("updaterCacheDirName is not specified in app-update.yml Was app build using at least electron-builder 20.34.0?");const r=d.join(this.app.baseCachePath,t||this.app.name);null!=n.debug&&n.debug(`updater cache dir: ${r}`),e=new h.DownloadedUpdateHelper(r),this.downloadedUpdateHelper=e}return e}async executeDownload(e){const t=e.fileInfo,n={headers:e.downloadUpdateOptions.requestHeaders,cancellationToken:e.downloadUpdateOptions.cancellationToken,sha2:t.info.sha2,sha512:t.info.sha512};this.listenerCount(g.DOWNLOAD_PROGRESS)>0&&(n.onProgress=e=>this.emit(g.DOWNLOAD_PROGRESS,e));const i=e.downloadUpdateOptions.updateInfoAndProvider.info,o=i.version,a=t.packageInfo,l=await this.getOrCreateDownloadHelper(),c=l.cacheDirForPendingUpdate;await s.mkdir(c,{recursive:!0});const u=function(){const t=decodeURIComponent(e.fileInfo.url.pathname);return t.endsWith(`.${e.fileExtension}`)?d.posix.basename(t):`update.${e.fileExtension}`}();let p=d.join(c,u);const f=null==a?null:d.join(c,`package-${o}${d.extname(a.path)||".7z"}`),m=async n=>(await l.setDownloadedFile(p,f,i,t,u,n),await e.done({...i,downloadedFile:p}),null==f?[p]:[p,f]),w=this._logger,b=await l.validateDownloadedPath(p,i,t,w);if(null!=b)return p=b,await m(!1);const E=async()=>(await l.clear().catch((()=>{})),await s.unlink(p).catch((()=>{}))),y=await h.createTempUpdateFile(`temp-${u}`,c,w);try{await e.task(y,n,f,E),await s.rename(y,p)}catch(e){throw await E(),e instanceof r.CancellationError&&(w.info("cancelled"),this.emit("update-cancelled",i)),e}return w.info(`New version ${o} has been downloaded to ${p}`),await m(!0)}}t.AppUpdater=b;class E{info(e){}warn(e){}error(e){}}t.NoOpLogger=E},4502:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseUpdater=void 0;const r=n(8459);class i extends r.AppUpdater{constructor(e,t){super(e,t),this.quitAndInstallCalled=!1,this.quitHandlerAdded=!1}quitAndInstall(e=!1,t=!1){this._logger.info("Install on explicit quitAndInstall"),this.install(e,!e||t)?setImmediate((()=>{n(2298).autoUpdater.emit("before-quit-for-update"),this.app.quit()})):this.quitAndInstallCalled=!1}executeDownload(e){return super.executeDownload({...e,done:e=>(this.dispatchUpdateDownloaded(e),this.addQuitHandler(),Promise.resolve())})}install(e,t){if(this.quitAndInstallCalled)return this._logger.warn("install call ignored: quitAndInstallCalled is set to true"),!1;const n=this.downloadedUpdateHelper,r=null==n?null:n.file,i=null==n?null:n.downloadedFileInfo;if(null==r||null==i)return this.dispatchError(new Error("No valid update available, can't quit and install")),!1;this.quitAndInstallCalled=!0;try{return this._logger.info(`Install: isSilent: ${e}, isForceRunAfter: ${t}`),this.doInstall({installerPath:r,isSilent:e,isForceRunAfter:t,isAdminRightsRequired:i.isAdminRightsRequired})}catch(e){return this.dispatchError(e),!1}}addQuitHandler(){!this.quitHandlerAdded&&this.autoInstallOnAppQuit&&(this.quitHandlerAdded=!0,this.app.onQuit((e=>{this.quitAndInstallCalled?this._logger.info("Update installer has already been triggered. Quitting application."):this.autoInstallOnAppQuit?0===e?(this._logger.info("Auto install update on quit"),this.install(!0,!1)):this._logger.info(`Update will be not installed on quit because application is quitting with exit code ${e}`):this._logger.info("Update will not be installed on quit because autoInstallOnAppQuit is set to false.")})))}}t.BaseUpdater=i},2837:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTempUpdateFile=t.DownloadedUpdateHelper=void 0;const r=n(6113),i=n(7147),o=n(2307),a=n(4857),s=n(1017);t.DownloadedUpdateHelper=class{constructor(e){this.cacheDir=e,this._file=null,this._packageFile=null,this.versionInfo=null,this.fileInfo=null,this._downloadedFileInfo=null}get downloadedFileInfo(){return this._downloadedFileInfo}get file(){return this._file}get packageFile(){return this._packageFile}get cacheDirForPendingUpdate(){return s.join(this.cacheDir,"pending")}async validateDownloadedPath(e,t,n,r){if(null!=this.versionInfo&&this.file===e&&null!=this.fileInfo)return o(this.versionInfo,t)&&o(this.fileInfo.info,n.info)&&await a.pathExists(e)?e:null;const i=await this.getValidCachedUpdateFile(n,r);return null===i?null:(r.info(`Update has already been downloaded to ${e}).`),this._file=i,i)}async setDownloadedFile(e,t,n,r,i,o){this._file=e,this._packageFile=t,this.versionInfo=n,this.fileInfo=r,this._downloadedFileInfo={fileName:i,sha512:r.info.sha512,isAdminRightsRequired:!0===r.info.isAdminRightsRequired},o&&await a.outputJson(this.getUpdateInfoFile(),this._downloadedFileInfo)}async clear(){this._file=null,this._packageFile=null,this.versionInfo=null,this.fileInfo=null,await this.cleanCacheDirForPendingUpdate()}async cleanCacheDirForPendingUpdate(){try{await a.emptyDir(this.cacheDirForPendingUpdate)}catch(e){}}async getValidCachedUpdateFile(e,t){var n;const o=this.getUpdateInfoFile();if(!await a.pathExists(o))return null;let l;try{l=await a.readJson(o)}catch(e){let n="No cached update info available";return"ENOENT"!==e.code&&(await this.cleanCacheDirForPendingUpdate(),n+=` (error on read: ${e.message})`),t.info(n),null}if(null===(n=null!==(null==l?void 0:l.fileName))||void 0===n||!n)return t.warn("Cached update info is corrupted: no fileName, directory for cached update will be cleaned"),await this.cleanCacheDirForPendingUpdate(),null;if(e.info.sha512!==l.sha512)return t.info(`Cached update sha512 checksum doesn't match the latest available update. New update must be downloaded. Cached: ${l.sha512}, expected: ${e.info.sha512}. Directory for cached update will be cleaned`),await this.cleanCacheDirForPendingUpdate(),null;const c=s.join(this.cacheDirForPendingUpdate,l.fileName);if(!await a.pathExists(c))return t.info("Cached update file doesn't exist"),null;const d=await function(e,t="sha512",n="base64",o){return new Promise(((a,s)=>{const l=r.createHash(t);l.on("error",s).setEncoding(n),i.createReadStream(e,{...o,highWaterMark:1048576}).on("error",s).on("end",(()=>{l.end(),a(l.read())})).pipe(l,{end:!1})}))}(c);return e.info.sha512!==d?(t.warn(`Sha512 checksum doesn't match the latest available update. New update must be downloaded. Cached: ${d}, expected: ${e.info.sha512}`),await this.cleanCacheDirForPendingUpdate(),null):(this._downloadedFileInfo=l,c)}getUpdateInfoFile(){return s.join(this.cacheDirForPendingUpdate,"update-info.json")}},t.createTempUpdateFile=async function(e,t,n){let r=0,i=s.join(t,e);for(let o=0;o<3;o++)try{return await a.unlink(i),i}catch(o){if("ENOENT"===o.code)return i;n.warn(`Error on remove temp update file: ${o}`),i=s.join(t,`${r++}-${e}`)}return i}},6431:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ElectronAppAdapter=void 0;const r=n(1017),i=n(6110);t.ElectronAppAdapter=class{constructor(e=n(2298).app){this.app=e}whenReady(){return this.app.whenReady()}get version(){return this.app.getVersion()}get name(){return this.app.getName()}get isPackaged(){return!0===this.app.isPackaged}get appUpdateConfigPath(){return this.isPackaged?r.join(process.resourcesPath,"app-update.yml"):r.join(this.app.getAppPath(),"dev-app-update.yml")}get userDataPath(){return this.app.getPath("userData")}get baseCachePath(){return i.getAppCacheDir()}quit(){this.app.quit()}onQuit(e){this.app.once("quit",((t,n)=>e(n)))}}},5741:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MacUpdater=void 0;const r=n(9152),i=n(4857),o=n(7147),a=n(3685),s=n(8459),l=n(2310),c=n(2081);class d extends s.AppUpdater{constructor(e,t){super(e,t),this.nativeUpdater=n(2298).autoUpdater,this.squirrelDownloadedUpdate=!1,this.nativeUpdater.on("error",(e=>{this._logger.warn(e),this.emit("error",e)})),this.nativeUpdater.on("update-downloaded",(()=>{this.squirrelDownloadedUpdate=!0}))}debug(e){null!=this._logger.debug&&this._logger.debug(e)}async doDownloadUpdate(e){let t=e.updateInfoAndProvider.provider.resolveFiles(e.updateInfoAndProvider.info);const n=this._logger;let i=!1;try{this.debug("Checking for macOS Rosetta environment"),i=c.execFileSync("sysctl",["sysctl.proc_translated"],{encoding:"utf8"}).includes("sysctl.proc_translated: 1"),n.info(`Checked for macOS Rosetta environment (isRosetta=${i})`)}catch(e){n.warn(`sysctl shell command to check for macOS Rosetta environment failed: ${e}`)}let o=!1;try{this.debug("Checking for arm64 in uname");const e=c.execFileSync("uname",["-a"],{encoding:"utf8"}).includes("ARM");n.info(`Checked 'uname -a': arm64=${e}`),o=o||e}catch(e){n.warn(`uname shell command to check for arm64 failed: ${e}`)}o=o||"arm64"===process.arch||i;const a=e=>{var t;return e.url.pathname.includes("arm64")||(null===(t=e.info.url)||void 0===t?void 0:t.includes("arm64"))};t=o&&t.some(a)?t.filter((e=>o===a(e))):t.filter((e=>!a(e)));const s=l.findFile(t,"zip",["pkg","dmg"]);if(null==s)throw r.newError(`ZIP file not provided: ${r.safeStringifyJson(t)}`,"ERR_UPDATER_ZIP_FILE_NOT_FOUND");return this.executeDownload({fileExtension:"zip",fileInfo:s,downloadUpdateOptions:e,task:(e,t)=>this.httpExecutor.download(s.url,e,t),done:e=>this.updateDownloaded(s,e)})}async updateDownloaded(e,t){var n;const r=t.downloadedFile,s=null!==(n=e.info.size)&&void 0!==n?n:(await i.stat(r)).size,l=this._logger,c=`fileToProxy=${e.url.href}`;this.debug(`Creating proxy server for native Squirrel.Mac (${c})`);const d=a.createServer();function u(){return`http://127.0.0.1:${d.address().port}`}return this.debug(`Proxy server for native Squirrel.Mac is created (${c})`),d.on("close",(()=>{l.info(`Proxy server for native Squirrel.Mac is closed (${c})`)})),await new Promise(((e,n)=>{const i=`/${Date.now().toString(16)}-${Math.floor(9999*Math.random()).toString(16)}.zip`;d.on("request",((t,a)=>{const c=t.url;if(l.info(`${c} requested`),"/"===c){const e=Buffer.from(`{ "url": "${u()}${i}" }`);return a.writeHead(200,{"Content-Type":"application/json","Content-Length":e.length}),void a.end(e)}if(!c.startsWith(i))return l.warn(`${c} requested, but not supported`),a.writeHead(404),void a.end();l.info(`${i} requested by Squirrel.Mac, pipe ${r}`);let h=!1;a.on("finish",(()=>{try{setImmediate((()=>d.close()))}finally{h||(this.nativeUpdater.removeListener("error",n),e([]))}}));const p=o.createReadStream(r);p.on("error",(e=>{try{a.end()}catch(e){l.warn(`cannot end response: ${e}`)}h=!0,this.nativeUpdater.removeListener("error",n),n(new Error(`Cannot pipe "${r}": ${e}`))})),a.writeHead(200,{"Content-Type":"application/zip","Content-Length":s}),p.pipe(a)})),this.debug(`Proxy server for native Squirrel.Mac is starting to listen (${c})`),d.listen(0,"127.0.0.1",(()=>{this.debug(`Proxy server for native Squirrel.Mac is listening (address=${u()}, ${c})`),this.nativeUpdater.setFeedURL({url:u(),headers:{"Cache-Control":"no-cache"}}),this.dispatchUpdateDownloaded(t),this.autoInstallOnAppQuit?(this.nativeUpdater.once("error",n),this.nativeUpdater.checkForUpdates()):e([])}))}))}quitAndInstall(){this.squirrelDownloadedUpdate?this.nativeUpdater.quitAndInstall():(this.nativeUpdater.on("update-downloaded",(()=>{this.nativeUpdater.quitAndInstall()})),this.autoInstallOnAppQuit||this.nativeUpdater.checkForUpdates())}}t.MacUpdater=d},3023:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NsisUpdater=void 0;const r=n(9152),i=n(2081),o=n(1017),a=n(4502),s=n(3458),l=n(8334),c=n(7430),d=n(1293),u=n(2310),h=n(4857),p=n(6659),f=n(7310),m=n(9796);class g extends a.BaseUpdater{constructor(e,t){super(e,t)}doDownloadUpdate(e){const t=e.updateInfoAndProvider.provider,n=u.findFile(t.resolveFiles(e.updateInfoAndProvider.info),"exe");return this.executeDownload({fileExtension:"exe",downloadUpdateOptions:e,fileInfo:n,task:async(i,o,a,s)=>{const l=n.packageInfo,c=null!=l&&null!=a;(c||await this.differentialDownloadInstaller(n,e,i,t))&&await this.httpExecutor.download(n.url,i,o);const d=await this.verifySignature(i);if(null!=d)throw await s(),r.newError(`New version ${e.updateInfoAndProvider.info.version} is not signed by the application owner: ${d}`,"ERR_UPDATER_INVALID_SIGNATURE");if(c&&await this.differentialDownloadWebPackage(e,l,a,t))try{await this.httpExecutor.download(new f.URL(l.path),a,{headers:e.requestHeaders,cancellationToken:e.cancellationToken,sha512:l.sha512})}catch(e){try{await h.unlink(a)}catch(e){}throw e}}})}async verifySignature(e){let t;try{if(t=(await this.configOnDisk.value).publisherName,null==t)return null}catch(e){if("ENOENT"===e.code)return null;throw e}return await p.verifySignature(Array.isArray(t)?t:[t],e,this._logger)}doInstall(e){const t=["--updated"];e.isSilent&&t.push("/S"),e.isForceRunAfter&&t.push("--force-run");const n=null==this.downloadedUpdateHelper?null:this.downloadedUpdateHelper.packageFile;null!=n&&t.push(`--package-file=${n}`);const r=()=>{w(o.join(process.resourcesPath,"elevate.exe"),[e.installerPath].concat(t)).catch((e=>this.dispatchError(e)))};return e.isAdminRightsRequired?(this._logger.info("isAdminRightsRequired is set to true, run installer using elevate.exe"),r(),!0):(w(e.installerPath,t).catch((e=>{const t=e.code;this._logger.info(`Cannot run installer: error code: ${t}, error message: "${e.message}", will be executed again using elevate if EACCES"`),"UNKNOWN"===t||"EACCES"===t?r():this.dispatchError(e)})),!0)}async differentialDownloadInstaller(e,t,n,i){try{if(null!=this._testOnlyOptions&&!this._testOnlyOptions.isUseDifferentialDownload)return!0;const a=d.blockmapFiles(e.url,this.app.version,t.updateInfoAndProvider.info.version);this._logger.info(`Download block maps (old: "${a[0]}", new: ${a[1]})`);const s=async e=>{const n=await this.httpExecutor.downloadToBuffer(e,{headers:t.requestHeaders,cancellationToken:t.cancellationToken});if(null==n||0===n.length)throw new Error(`Blockmap "${e.href}" is empty`);try{return JSON.parse(m.gunzipSync(n).toString())}catch(t){throw new Error(`Cannot parse blockmap "${e.href}", error: ${t}`)}},u={newUrl:e.url,oldFile:o.join(this.downloadedUpdateHelper.cacheDir,r.CURRENT_APP_INSTALLER_FILE_NAME),logger:this._logger,newFile:n,isUseMultipleRangeRequest:i.isUseMultipleRangeRequest,requestHeaders:t.requestHeaders,cancellationToken:t.cancellationToken};this.listenerCount(c.DOWNLOAD_PROGRESS)>0&&(u.onProgress=e=>this.emit(c.DOWNLOAD_PROGRESS,e));const h=await Promise.all(a.map((e=>s(e))));return await new l.GenericDifferentialDownloader(e.info,this.httpExecutor,u).download(h[0],h[1]),!1}catch(e){if(this._logger.error(`Cannot download differentially, fallback to full download: ${e.stack||e}`),null!=this._testOnlyOptions)throw e;return!0}}async differentialDownloadWebPackage(e,t,n,i){if(null==t.blockMapSize)return!0;try{const a={newUrl:new f.URL(t.path),oldFile:o.join(this.downloadedUpdateHelper.cacheDir,r.CURRENT_APP_PACKAGE_FILE_NAME),logger:this._logger,newFile:n,requestHeaders:this.requestHeaders,isUseMultipleRangeRequest:i.isUseMultipleRangeRequest,cancellationToken:e.cancellationToken};this.listenerCount(c.DOWNLOAD_PROGRESS)>0&&(a.onProgress=e=>this.emit(c.DOWNLOAD_PROGRESS,e)),await new s.FileWithEmbeddedBlockMapDifferentialDownloader(t,this.httpExecutor,a).download()}catch(e){return this._logger.error(`Cannot download differentially, fallback to full download: ${e.stack||e}`),"win32"===process.platform}return!1}}async function w(e,t){return new Promise(((n,r)=>{try{const o=i.spawn(e,t,{detached:!0,stdio:"ignore"});o.on("error",(e=>{r(e)})),o.unref(),void 0!==o.pid&&n(!0)}catch(e){r(e)}}))}t.NsisUpdater=g},3125:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataSplitter=t.copyData=void 0;const r=n(9152),i=n(7147),o=n(2781),a=n(7777),s=Buffer.from("\r\n\r\n");var l;function c(e,t,n,r,o){const a=i.createReadStream("",{fd:n,autoClose:!1,start:e.start,end:e.end-1});a.on("error",r),a.once("end",o),a.pipe(t,{end:!1})}!function(e){e[e.INIT=0]="INIT",e[e.HEADER=1]="HEADER",e[e.BODY=2]="BODY"}(l||(l={})),t.copyData=c;class d extends o.Writable{constructor(e,t,n,r,i,o){super(),this.out=e,this.options=t,this.partIndexToTaskIndex=n,this.partIndexToLength=i,this.finishHandler=o,this.partIndex=-1,this.headerListBuffer=null,this.readState=l.INIT,this.ignoreByteCount=0,this.remainingPartDataCount=0,this.actualPartLength=0,this.boundaryLength=r.length+4,this.ignoreByteCount=this.boundaryLength-2}get isFinished(){return this.partIndex===this.partIndexToLength.length}_write(e,t,n){this.isFinished?console.error(`Trailing ignored data: ${e.length} bytes`):this.handleData(e).then(n).catch(n)}async handleData(e){let t=0;if(0!==this.ignoreByteCount&&0!==this.remainingPartDataCount)throw r.newError("Internal error","ERR_DATA_SPLITTER_BYTE_COUNT_MISMATCH");if(this.ignoreByteCount>0){const n=Math.min(this.ignoreByteCount,e.length);this.ignoreByteCount-=n,t=n}else if(this.remainingPartDataCount>0){const n=Math.min(this.remainingPartDataCount,e.length);this.remainingPartDataCount-=n,await this.processPartData(e,0,n),t=n}if(t!==e.length){if(this.readState===l.HEADER){const n=this.searchHeaderListEnd(e,t);if(-1===n)return;t=n,this.readState=l.BODY,this.headerListBuffer=null}for(;;){if(this.readState===l.BODY)this.readState=l.INIT;else{this.partIndex++;let n=this.partIndexToTaskIndex.get(this.partIndex);if(null==n){if(!this.isFinished)throw r.newError("taskIndex is null","ERR_DATA_SPLITTER_TASK_INDEX_IS_NULL");n=this.options.end}const i=0===this.partIndex?this.options.start:this.partIndexToTaskIndex.get(this.partIndex-1)+1;if(i<n)await this.copyExistingData(i,n);else if(i>n)throw r.newError("prevTaskIndex must be < taskIndex","ERR_DATA_SPLITTER_TASK_INDEX_ASSERT_FAILED");if(this.isFinished)return this.onPartEnd(),void this.finishHandler();if(t=this.searchHeaderListEnd(e,t),-1===t)return void(this.readState=l.HEADER)}const n=this.partIndexToLength[this.partIndex],i=t+n,o=Math.min(i,e.length);if(await this.processPartStarted(e,t,o),this.remainingPartDataCount=n-(o-t),this.remainingPartDataCount>0)return;if(t=i+this.boundaryLength,t>=e.length)return void(this.ignoreByteCount=this.boundaryLength-(e.length-i))}}}copyExistingData(e,t){return new Promise(((n,r)=>{const i=()=>{if(e===t)return void n();const o=this.options.tasks[e];o.kind===a.OperationKind.COPY?c(o,this.out,this.options.oldFileFd,r,(()=>{e++,i()})):r(new Error("Task kind must be COPY"))};i()}))}searchHeaderListEnd(e,t){const n=e.indexOf(s,t);if(-1!==n)return n+s.length;const r=0===t?e:e.slice(t);return null==this.headerListBuffer?this.headerListBuffer=r:this.headerListBuffer=Buffer.concat([this.headerListBuffer,r]),-1}onPartEnd(){const e=this.partIndexToLength[this.partIndex-1];if(this.actualPartLength!==e)throw r.newError(`Expected length: ${e} differs from actual: ${this.actualPartLength}`,"ERR_DATA_SPLITTER_LENGTH_MISMATCH");this.actualPartLength=0}processPartStarted(e,t,n){return 0!==this.partIndex&&this.onPartEnd(),this.processPartData(e,t,n)}processPartData(e,t,n){this.actualPartLength+=n-t;const r=this.out;return r.write(0===t&&e.length===n?e:e.slice(t,n))?Promise.resolve():new Promise(((e,t)=>{r.on("error",t),r.once("drain",(()=>{r.removeListener("error",t),e()}))}))}}t.DataSplitter=d},8144:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DifferentialDownloader=void 0;const r=n(9152),i=n(4857),o=n(7147),a=n(3125),s=n(7310),l=n(7777),c=n(2150),d=n(1385);function u(e,t=" KB"){return new Intl.NumberFormat("en").format((e/1024).toFixed(2))+t}t.DifferentialDownloader=class{constructor(e,t,n){this.blockAwareFileInfo=e,this.httpExecutor=t,this.options=n,this.fileMetadataBuffer=null,this.logger=n.logger}createRequestOptions(){const e={headers:{...this.options.requestHeaders,accept:"*/*"}};return r.configureRequestUrl(this.options.newUrl,e),r.configureRequestOptions(e),e}doDownload(e,t){if(e.version!==t.version)throw new Error(`version is different (${e.version} - ${t.version}), full download is required`);const n=this.logger,r=l.computeOperations(e,t,n);null!=n.debug&&n.debug(JSON.stringify(r,null,2));let i=0,o=0;for(const e of r){const t=e.end-e.start;e.kind===l.OperationKind.DOWNLOAD?i+=t:o+=t}const a=this.blockAwareFileInfo.size;if(i+o+(null==this.fileMetadataBuffer?0:this.fileMetadataBuffer.length)!==a)throw new Error(`Internal error, size mismatch: downloadSize: ${i}, copySize: ${o}, newSize: ${a}`);return n.info(`Full: ${u(a)}, To download: ${u(i)} (${Math.round(i/(a/100))}%)`),this.downloadFile(r)}downloadFile(e){const t=[],n=()=>Promise.all(t.map((e=>i.close(e.descriptor).catch((t=>{this.logger.error(`cannot close file "${e.path}": ${t}`)})))));return this.doDownloadFile(e,t).then(n).catch((e=>n().catch((t=>{try{this.logger.error(`cannot close files: ${t}`)}catch(e){try{console.error(e)}catch(e){}}throw e})).then((()=>{throw e}))))}async doDownloadFile(e,t){const n=await i.open(this.options.oldFile,"r");t.push({descriptor:n,path:this.options.oldFile});const u=await i.open(this.options.newFile,"w");t.push({descriptor:u,path:this.options.newFile});const h=o.createWriteStream(this.options.newFile,{fd:u});await new Promise(((i,o)=>{const u=[];let p;if(!this.options.isUseMultipleRangeRequest&&this.options.onProgress){const t=[];let n=0;for(const r of e)r.kind===l.OperationKind.DOWNLOAD&&(t.push(r.end-r.start),n+=r.end-r.start);const r={expectedByteCounts:t,grandTotal:n};p=new d.ProgressDifferentialDownloadCallbackTransform(r,this.options.cancellationToken,this.options.onProgress),u.push(p)}const f=new r.DigestTransform(this.blockAwareFileInfo.sha512);f.isValidateOnEnd=!1,u.push(f),h.on("finish",(()=>{h.close((()=>{t.splice(1,1);try{f.validate()}catch(e){return void o(e)}i(void 0)}))})),u.push(h);let m=null;for(const e of u)e.on("error",o),m=null==m?e:m.pipe(e);const g=u[0];let w;if(this.options.isUseMultipleRangeRequest)return w=c.executeTasksUsingMultipleRangeRequests(this,e,g,n,o),void w(0);let b=0,E=null;this.logger.info(`Differential download: ${this.options.newUrl}`);const y=this.createRequestOptions();y.redirect="manual",w=t=>{var i,c;if(t>=e.length)return null!=this.fileMetadataBuffer&&g.write(this.fileMetadataBuffer),void g.end();const d=e[t++];if(d.kind===l.OperationKind.COPY)return p&&p.beginFileCopy(),void a.copyData(d,g,n,o,(()=>w(t)));const u=`bytes=${d.start}-${d.end-1}`;y.headers.range=u,null===(c=null===(i=this.logger)||void 0===i?void 0:i.debug)||void 0===c||c.call(i,`download range: ${u}`),p&&p.beginRangeDownload();const h=this.httpExecutor.createRequest(y,(e=>{e.statusCode>=400&&o(r.createHttpError(e)),e.pipe(g,{end:!1}),e.once("end",(()=>{p&&p.endRangeDownload(),100==++b?(b=0,setTimeout((()=>w(t)),1e3)):w(t)}))}));h.on("redirect",((e,t,n)=>{this.logger.info(`Redirect to ${function(e){const t=e.indexOf("?");return t<0?e:e.substring(0,t)}(n)}`),E=n,r.configureRequestUrl(new s.URL(E),y),h.followRedirect()})),this.httpExecutor.addErrorAndTimeoutHandlers(h,o),h.end()},w(0)}))}async readRemoteBytes(e,t){const n=Buffer.allocUnsafe(t+1-e),r=this.createRequestOptions();r.headers.range=`bytes=${e}-${t}`;let i=0;if(await this.request(r,(e=>{e.copy(n,i),i+=e.length})),i!==n.length)throw new Error(`Received data length ${i} is not equal to expected ${n.length}`);return n}request(e,t){return new Promise(((n,r)=>{const i=this.httpExecutor.createRequest(e,(e=>{c.checkIsRangesSupported(e,r)&&(e.on("data",t),e.on("end",(()=>n())))}));this.httpExecutor.addErrorAndTimeoutHandlers(i,r),i.end()}))}}},3458:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileWithEmbeddedBlockMapDifferentialDownloader=void 0;const r=n(4857),i=n(8144),o=n(9796);class a extends i.DifferentialDownloader{async download(){const e=this.blockAwareFileInfo,t=e.size,n=t-(e.blockMapSize+4);this.fileMetadataBuffer=await this.readRemoteBytes(n,t-1);const i=s(this.fileMetadataBuffer.slice(0,this.fileMetadataBuffer.length-4));await this.doDownload(await async function(e){const t=await r.open(e,"r");try{const e=(await r.fstat(t)).size,n=Buffer.allocUnsafe(4);await r.read(t,n,0,n.length,e-n.length);const i=Buffer.allocUnsafe(n.readUInt32BE(0));return await r.read(t,i,0,i.length,e-n.length-i.length),await r.close(t),s(i)}catch(e){throw await r.close(t),e}}(this.options.oldFile),i)}}function s(e){return JSON.parse(o.inflateRawSync(e).toString())}t.FileWithEmbeddedBlockMapDifferentialDownloader=a},8334:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GenericDifferentialDownloader=void 0;const r=n(8144);class i extends r.DifferentialDownloader{download(e,t){return this.doDownload(e,t)}}t.GenericDifferentialDownloader=i},1385:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressDifferentialDownloadCallbackTransform=void 0;const r=n(2781);var i;!function(e){e[e.COPY=0]="COPY",e[e.DOWNLOAD=1]="DOWNLOAD"}(i||(i={}));class o extends r.Transform{constructor(e,t,n){super(),this.progressDifferentialDownloadInfo=e,this.cancellationToken=t,this.onProgress=n,this.start=Date.now(),this.transferred=0,this.delta=0,this.expectedBytes=0,this.index=0,this.operationType=i.COPY,this.nextUpdate=this.start+1e3}_transform(e,t,n){if(this.cancellationToken.cancelled)return void n(new Error("cancelled"),null);if(this.operationType==i.COPY)return void n(null,e);this.transferred+=e.length,this.delta+=e.length;const r=Date.now();r>=this.nextUpdate&&this.transferred!==this.expectedBytes&&this.transferred!==this.progressDifferentialDownloadInfo.grandTotal&&(this.nextUpdate=r+1e3,this.onProgress({total:this.progressDifferentialDownloadInfo.grandTotal,delta:this.delta,transferred:this.transferred,percent:this.transferred/this.progressDifferentialDownloadInfo.grandTotal*100,bytesPerSecond:Math.round(this.transferred/((r-this.start)/1e3))}),this.delta=0),n(null,e)}beginFileCopy(){this.operationType=i.COPY}beginRangeDownload(){this.operationType=i.DOWNLOAD,this.expectedBytes+=this.progressDifferentialDownloadInfo.expectedByteCounts[this.index++]}endRangeDownload(){this.transferred!==this.progressDifferentialDownloadInfo.grandTotal&&this.onProgress({total:this.progressDifferentialDownloadInfo.grandTotal,delta:this.delta,transferred:this.transferred,percent:this.transferred/this.progressDifferentialDownloadInfo.grandTotal*100,bytesPerSecond:Math.round(this.transferred/((Date.now()-this.start)/1e3))})}_flush(e){this.cancellationToken.cancelled?e(new Error("cancelled")):(this.onProgress({total:this.progressDifferentialDownloadInfo.grandTotal,delta:this.delta,transferred:this.transferred,percent:100,bytesPerSecond:Math.round(this.transferred/((Date.now()-this.start)/1e3))}),this.delta=0,this.transferred=0,e(null))}}t.ProgressDifferentialDownloadCallbackTransform=o},7777:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.computeOperations=t.OperationKind=void 0,function(e){e[e.COPY=0]="COPY",e[e.DOWNLOAD=1]="DOWNLOAD"}(n=t.OperationKind||(t.OperationKind={})),t.computeOperations=function(e,t,r){const a=o(e.files),s=o(t.files);let l=null;const c=t.files[0],d=[],u=c.name,h=a.get(u);if(null==h)throw new Error(`no file ${u} in old blockmap`);const p=s.get(u);let f=0;const{checksumToOffset:m,checksumToOldSize:g}=function(e,t,n){const r=new Map,i=new Map;let o=t;for(let t=0;t<e.checksums.length;t++){const a=e.checksums[t],s=e.sizes[t],l=i.get(a);if(void 0===l)r.set(a,o),i.set(a,s);else if(null!=n.debug){const e=l===s?"(same size)":`(size: ${l}, this size: ${s})`;n.debug(`${a} duplicated in blockmap ${e}, it doesn't lead to broken differential downloader, just corresponding block will be skipped)`)}o+=s}return{checksumToOffset:r,checksumToOldSize:i}}(a.get(u),h.offset,r);let w=c.offset;for(let e=0;e<p.checksums.length;w+=p.sizes[e],e++){const t=p.sizes[e],o=p.checksums[e];let a=m.get(o);null!=a&&g.get(o)!==t&&(r.warn(`Checksum ("${o}") matches, but size differs (old: ${g.get(o)}, new: ${t})`),a=void 0),void 0===a?(f++,null!=l&&l.kind===n.DOWNLOAD&&l.end===w?l.end+=t:(l={kind:n.DOWNLOAD,start:w,end:w+t},i(l,d,o,e))):null!=l&&l.kind===n.COPY&&l.end===a?l.end+=t:(l={kind:n.COPY,start:a,end:a+t},i(l,d,o,e))}return f>0&&r.info(`File${"file"===c.name?"":" "+c.name} has ${f} changed blocks`),d};const r="true"===process.env.DIFFERENTIAL_DOWNLOAD_PLAN_BUILDER_VALIDATE_RANGES;function i(e,t,i,o){if(r&&0!==t.length){const r=t[t.length-1];if(r.kind===e.kind&&e.start<r.end&&e.start>r.start){const t=[r.start,r.end,e.start,e.end].reduce(((e,t)=>e<t?e:t));throw new Error(`operation (block index: ${o}, checksum: ${i}, kind: ${n[e.kind]}) overlaps previous operation (checksum: ${i}):\nabs: ${r.start} until ${r.end} and ${e.start} until ${e.end}\nrel: ${r.start-t} until ${r.end-t} and ${e.start-t} until ${e.end-t}`)}}t.push(e)}function o(e){const t=new Map;for(const n of e)t.set(n.name,n);return t}},2150:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkIsRangesSupported=t.executeTasksUsingMultipleRangeRequests=void 0;const r=n(9152),i=n(3125),o=n(7777);function a(e,t){if(e.statusCode>=400)return t(r.createHttpError(e)),!1;if(206!==e.statusCode){const n=r.safeGetHeader(e,"accept-ranges");if(null==n||"none"===n)return t(new Error(`Server doesn't support Accept-Ranges (response code ${e.statusCode})`)),!1}return!0}t.executeTasksUsingMultipleRangeRequests=function(e,t,n,s,l){const c=d=>{if(d>=t.length)return null!=e.fileMetadataBuffer&&n.write(e.fileMetadataBuffer),void n.end();const u=d+1e3;!function(e,t,n,s,l){let c="bytes=",d=0;const u=new Map,h=[];for(let e=t.start;e<t.end;e++){const n=t.tasks[e];n.kind===o.OperationKind.DOWNLOAD&&(c+=`${n.start}-${n.end-1}, `,u.set(d,e),d++,h.push(n.end-n.start))}if(d<=1){const r=c=>{if(c>=t.end)return void s();const d=t.tasks[c++];if(d.kind===o.OperationKind.COPY)i.copyData(d,n,t.oldFileFd,l,(()=>r(c)));else{const t=e.createRequestOptions();t.headers.Range=`bytes=${d.start}-${d.end-1}`;const i=e.httpExecutor.createRequest(t,(e=>{a(e,l)&&(e.pipe(n,{end:!1}),e.once("end",(()=>r(c))))}));e.httpExecutor.addErrorAndTimeoutHandlers(i,l),i.end()}};return void r(t.start)}const p=e.createRequestOptions();p.headers.Range=c.substring(0,c.length-2);const f=e.httpExecutor.createRequest(p,(e=>{if(!a(e,l))return;const o=r.safeGetHeader(e,"content-type"),c=/^multipart\/.+?(?:; boundary=(?:(?:"(.+)")|(?:([^\s]+))))$/i.exec(o);if(null==c)return void l(new Error(`Content-Type "multipart/byteranges" is expected, but got "${o}"`));const d=new i.DataSplitter(n,t,u,c[1]||c[2],h,s);d.on("error",l),e.pipe(d),e.on("end",(()=>{setTimeout((()=>{f.abort(),l(new Error("Response ends without calling any handlers"))}),1e4)}))}));e.httpExecutor.addErrorAndTimeoutHandlers(f,l),f.end()}(e,{tasks:t,start:d,end:Math.min(t.length,u),oldFileFd:s},n,(()=>c(u)),l)};return c},t.checkIsRangesSupported=a},1890:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ElectronHttpExecutor=t.getNetSession=t.NET_SESSION_NAME=void 0;const r=n(9152);function i(){return n(2298).session.fromPartition(t.NET_SESSION_NAME,{cache:!1})}t.NET_SESSION_NAME="electron-updater",t.getNetSession=i;class o extends r.HttpExecutor{constructor(e){super(),this.proxyLoginCallback=e,this.cachedSession=null}async download(e,t,n){return await n.cancellationToken.createPromise(((i,o,a)=>{const s={headers:n.headers||void 0,redirect:"manual"};r.configureRequestUrl(e,s),r.configureRequestOptions(s),this.doDownload(s,{destination:t,options:n,onCancel:a,callback:e=>{null==e?i(t):o(e)},responseHandler:null},0)}))}createRequest(e,t){e.headers&&e.headers.Host&&(e.host=e.headers.Host,delete e.headers.Host),null==this.cachedSession&&(this.cachedSession=i());const r=n(2298).net.request({...e,session:this.cachedSession});return r.on("response",t),null!=this.proxyLoginCallback&&r.on("login",this.proxyLoginCallback),r}addRedirectHandlers(e,t,n,i,o){e.on("redirect",((a,s,l)=>{e.abort(),i>this.maxRedirects?n(this.createMaxRedirectError()):o(r.HttpExecutor.prepareRedirectUrlOptions(l,t))}))}}t.ElectronHttpExecutor=o},7430:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpdaterSignal=t.UPDATE_DOWNLOADED=t.DOWNLOAD_PROGRESS=t.NsisUpdater=t.MacUpdater=t.AppImageUpdater=t.Provider=t.CancellationToken=t.NoOpLogger=t.AppUpdater=void 0;const r=n(9152);Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return r.CancellationToken}});var i=n(8459);Object.defineProperty(t,"AppUpdater",{enumerable:!0,get:function(){return i.AppUpdater}}),Object.defineProperty(t,"NoOpLogger",{enumerable:!0,get:function(){return i.NoOpLogger}});var o=n(2310);Object.defineProperty(t,"Provider",{enumerable:!0,get:function(){return o.Provider}});var a=n(3405);Object.defineProperty(t,"AppImageUpdater",{enumerable:!0,get:function(){return a.AppImageUpdater}});var s=n(5741);Object.defineProperty(t,"MacUpdater",{enumerable:!0,get:function(){return s.MacUpdater}});var l=n(3023);let c;function d(e,t,n){e.on(t,n)}Object.defineProperty(t,"NsisUpdater",{enumerable:!0,get:function(){return l.NsisUpdater}}),Object.defineProperty(t,"autoUpdater",{enumerable:!0,get:()=>c||(c="win32"===process.platform?new(n(3023).NsisUpdater):"darwin"===process.platform?new(n(5741).MacUpdater):new(n(3405).AppImageUpdater),c)}),t.DOWNLOAD_PROGRESS="download-progress",t.UPDATE_DOWNLOADED="update-downloaded",t.UpdaterSignal=class{constructor(e){this.emitter=e}login(e){d(this.emitter,"login",e)}progress(e){d(this.emitter,t.DOWNLOAD_PROGRESS,e)}updateDownloaded(e){d(this.emitter,t.UPDATE_DOWNLOADED,e)}updateCancelled(e){d(this.emitter,"update-cancelled",e)}}},4985:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createClient=t.isUrlProbablySupportMultiRangeRequests=void 0;const r=n(9152),i=n(6552),o=n(5494),a=n(1554),s=n(4184),l=n(3933),c=n(7268);function d(e){return!e.includes("s3.amazonaws.com")}t.isUrlProbablySupportMultiRangeRequests=d,t.createClient=function(e,t,n){if("string"==typeof e)throw r.newError("Please pass PublishConfiguration object","ERR_UPDATER_INVALID_PROVIDER_CONFIGURATION");const u=e.provider;switch(u){case"github":{const r=e,i=(r.private?process.env.GH_TOKEN||process.env.GITHUB_TOKEN:null)||r.token;return null==i?new s.GitHubProvider(r,t,n):new c.PrivateGitHubProvider(r,t,i,n)}case"bitbucket":return new o.BitbucketProvider(e,t,n);case"keygen":return new l.KeygenProvider(e,t,n);case"s3":case"spaces":return new a.GenericProvider({provider:"generic",url:r.getS3LikeProviderBaseUrl(e),channel:e.channel||null},t,{...n,isUseMultipleRangeRequest:!1});case"generic":{const r=e;return new a.GenericProvider(r,t,{...n,isUseMultipleRangeRequest:!1!==r.useMultipleRangeRequest&&d(r.url)})}case"bintray":return new i.BintrayProvider(e,n);case"custom":{const i=e,o=i.updateProvider;if(!o)throw r.newError("Custom provider not specified","ERR_UPDATER_INVALID_PROVIDER_CONFIGURATION");return new o(i,t,n)}default:throw r.newError(`Unsupported provider: ${u}`,"ERR_UPDATER_UNSUPPORTED_PROVIDER")}}},6552:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BintrayProvider=void 0;const r=n(9152),i=n(4048),o=n(7310),a=n(1293),s=n(2310);class l extends s.Provider{constructor(e,t){super(t),this.client=new i.BintrayClient(e,t.executor,new r.CancellationToken),this.baseUrl=a.newBaseUrl(`https://dl.bintray.com/${this.client.owner}/${this.client.repo}`)}setRequestHeaders(e){super.setRequestHeaders(e),this.client.setRequestHeaders(e)}async getLatestVersion(){try{const e=await this.client.getVersion("_latest"),t=a.getChannelFilename(this.getDefaultChannelName()),n=await this.client.getVersionFiles(e.name),i=n.find((e=>e.name.endsWith(`_${t}`)||e.name.endsWith(`-${t}`)));if(null==i)throw r.newError(`Cannot find channel file "${t}", existing files:\n${n.map((e=>JSON.stringify(e,null,2))).join(",\n")}`,"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND");const l=new o.URL(`https://dl.bintray.com/${this.client.owner}/${this.client.repo}/${i.name}`);return s.parseUpdateInfo(await this.httpRequest(l),t,l)}catch(e){if("statusCode"in e&&404===e.statusCode)throw r.newError(`No latest version, please ensure that user, package and repository correctly configured. Or at least one version is published. ${e.stack||e.message}`,"ERR_UPDATER_LATEST_VERSION_NOT_FOUND");throw e}}resolveFiles(e){return s.resolveFiles(e,this.baseUrl)}}t.BintrayProvider=l},5494:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BitbucketProvider=void 0;const r=n(9152),i=n(1293),o=n(2310);class a extends o.Provider{constructor(e,t,n){super({...n,isUseMultipleRangeRequest:!1}),this.configuration=e,this.updater=t;const{owner:r,slug:o}=e;this.baseUrl=i.newBaseUrl(`https://api.bitbucket.org/2.0/repositories/${r}/${o}/downloads`)}get channel(){return this.updater.channel||this.configuration.channel||"latest"}async getLatestVersion(){const e=new r.CancellationToken,t=i.getChannelFilename(this.getCustomChannelName(this.channel)),n=i.newUrlFromBase(t,this.baseUrl,this.updater.isAddNoCacheQuery);try{const r=await this.httpRequest(n,void 0,e);return o.parseUpdateInfo(r,t,n)}catch(e){throw r.newError(`Unable to find latest version on ${this.toString()}, please ensure release exists: ${e.stack||e.message}`,"ERR_UPDATER_LATEST_VERSION_NOT_FOUND")}}resolveFiles(e){return o.resolveFiles(e,this.baseUrl)}toString(){const{owner:e,slug:t}=this.configuration;return`Bitbucket (owner: ${e}, slug: ${t}, channel: ${this.channel})`}}t.BitbucketProvider=a},1554:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GenericProvider=void 0;const r=n(9152),i=n(1293),o=n(2310);class a extends o.Provider{constructor(e,t,n){super(n),this.configuration=e,this.updater=t,this.baseUrl=i.newBaseUrl(this.configuration.url)}get channel(){const e=this.updater.channel||this.configuration.channel;return null==e?this.getDefaultChannelName():this.getCustomChannelName(e)}async getLatestVersion(){const e=i.getChannelFilename(this.channel),t=i.newUrlFromBase(e,this.baseUrl,this.updater.isAddNoCacheQuery);for(let n=0;;n++)try{return o.parseUpdateInfo(await this.httpRequest(t),e,t)}catch(t){if(t instanceof r.HttpError&&404===t.statusCode)throw r.newError(`Cannot find channel "${e}" update info: ${t.stack||t.message}`,"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND");if("ECONNREFUSED"===t.code&&n<3){await new Promise(((e,t)=>{try{setTimeout(e,1e3*n)}catch(e){t(e)}}));continue}throw t}}resolveFiles(e){return o.resolveFiles(e,this.baseUrl)}}t.GenericProvider=a},4184:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeReleaseNotes=t.GitHubProvider=t.BaseGitHubProvider=void 0;const r=n(9152),i=n(6158),o=n(7310),a=n(1293),s=n(2310),l=/\/tag\/([^/]+)$/;class c extends s.Provider{constructor(e,t,n){super({...n,isUseMultipleRangeRequest:!1}),this.options=e,this.baseUrl=a.newBaseUrl(r.githubUrl(e,t));const i="github.com"===t?"api.github.com":t;this.baseApiUrl=a.newBaseUrl(r.githubUrl(e,i))}computeGithubBasePath(e){const t=this.options.host;return null!=t&&"github.com"!==t&&"api.github.com"!==t?`/api/v3${e}`:e}}function d(e){const t=e.elementValueOrEmpty("content");return"No content."===t?"":t}function u(e,t,n,r){if(!t)return d(r);const o=[];for(const t of n.getElements("entry")){const n=/\/tag\/v?([^/]+)$/.exec(t.element("link").attribute("href"))[1];i.lt(e,n)&&o.push({version:n,note:d(t)})}return o.sort(((e,t)=>i.rcompare(e.version,t.version)))}t.BaseGitHubProvider=c,t.GitHubProvider=class extends c{constructor(e,t,n){super(e,"github.com",n),this.options=e,this.updater=t}async getLatestVersion(){const e=new r.CancellationToken,t=await this.httpRequest(a.newUrlFromBase(`${this.basePath}.atom`,this.baseUrl),{accept:"application/xml, application/atom+xml, text/xml, */*"},e),n=r.parseXml(t);let i,o=n.element("entry",!1,"No published versions on GitHub");try{if(this.updater.allowPrerelease)i=l.exec(o.element("link").attribute("href"))[1];else{i=await this.getLatestTagName(e);for(const e of n.getElements("entry"))if(l.exec(e.element("link").attribute("href"))[1]===i){o=e;break}}}catch(e){throw r.newError(`Cannot parse releases feed: ${e.stack||e.message},\nXML:\n${t}`,"ERR_UPDATER_INVALID_RELEASE_FEED")}if(null==i)throw r.newError("No published versions on GitHub","ERR_UPDATER_NO_PUBLISHED_VERSIONS");const c=a.getChannelFilename(this.getDefaultChannelName()),d=a.newUrlFromBase(this.getBaseDownloadPath(i,c),this.baseUrl),h=this.createRequestOptions(d);let p;try{p=await this.executor.request(h,e)}catch(e){if(!this.updater.allowPrerelease&&e instanceof r.HttpError&&404===e.statusCode)throw r.newError(`Cannot find ${c} in the latest release artifacts (${d}): ${e.stack||e.message}`,"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND");throw e}const f=s.parseUpdateInfo(p,c,d);return null==f.releaseName&&(f.releaseName=o.elementValueOrEmpty("title")),null==f.releaseNotes&&(f.releaseNotes=u(this.updater.currentVersion,this.updater.fullChangelog,n,o)),{tag:i,...f}}async getLatestTagName(e){const t=this.options,n=null==t.host||"github.com"===t.host?a.newUrlFromBase(`${this.basePath}/latest`,this.baseUrl):new o.URL(`${this.computeGithubBasePath(`/repos/${t.owner}/${t.repo}/releases`)}/latest`,this.baseApiUrl);try{const t=await this.httpRequest(n,{Accept:"application/json"},e);return null==t?null:JSON.parse(t).tag_name}catch(e){throw r.newError(`Unable to find latest version on GitHub (${n}), please ensure a production release exists: ${e.stack||e.message}`,"ERR_UPDATER_LATEST_VERSION_NOT_FOUND")}}get basePath(){return`/${this.options.owner}/${this.options.repo}/releases`}resolveFiles(e){return s.resolveFiles(e,this.baseUrl,(t=>this.getBaseDownloadPath(e.tag,t.replace(/ /g,"-"))))}getBaseDownloadPath(e,t){return`${this.basePath}/download/${e}/${t}`}},t.computeReleaseNotes=u},3933:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeygenProvider=void 0;const r=n(9152),i=n(1293),o=n(2310);class a extends o.Provider{constructor(e,t,n){super({...n,isUseMultipleRangeRequest:!1}),this.configuration=e,this.updater=t,this.baseUrl=i.newBaseUrl(`https://api.keygen.sh/v1/accounts/${this.configuration.account}/artifacts`)}get channel(){return this.updater.channel||this.configuration.channel||"stable"}async getLatestVersion(){const e=new r.CancellationToken,t=i.getChannelFilename(this.getCustomChannelName(this.channel)),n=i.newUrlFromBase(t,this.baseUrl,this.updater.isAddNoCacheQuery);try{const r=await this.httpRequest(n,{Accept:"application/vnd.api+json"},e);return o.parseUpdateInfo(r,t,n)}catch(e){throw r.newError(`Unable to find latest version on ${this.toString()}, please ensure release exists: ${e.stack||e.message}`,"ERR_UPDATER_LATEST_VERSION_NOT_FOUND")}}resolveFiles(e){return o.resolveFiles(e,this.baseUrl)}toString(){const{account:e,product:t,platform:n}=this.configuration;return`Keygen (account: ${e}, product: ${t}, platform: ${n}, channel: ${this.channel})`}}t.KeygenProvider=a},7268:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrivateGitHubProvider=void 0;const r=n(9152),i=n(3320),o=n(1017),a=n(7310),s=n(1293),l=n(4184),c=n(2310);class d extends l.BaseGitHubProvider{constructor(e,t,n,r){super(e,"api.github.com",r),this.updater=t,this.token=n}createRequestOptions(e,t){const n=super.createRequestOptions(e,t);return n.redirect="manual",n}async getLatestVersion(){const e=new r.CancellationToken,t=s.getChannelFilename(this.getDefaultChannelName()),n=await this.getLatestVersionInfo(e),o=n.assets.find((e=>e.name===t));if(null==o)throw r.newError(`Cannot find ${t} in the release ${n.html_url||n.name}`,"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND");const l=new a.URL(o.url);let c;try{c=i.load(await this.httpRequest(l,this.configureHeaders("application/octet-stream"),e))}catch(e){if(e instanceof r.HttpError&&404===e.statusCode)throw r.newError(`Cannot find ${t} in the latest release artifacts (${l}): ${e.stack||e.message}`,"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND");throw e}return c.assets=n.assets,c}get fileExtraDownloadHeaders(){return this.configureHeaders("application/octet-stream")}configureHeaders(e){return{accept:e,authorization:`token ${this.token}`}}async getLatestVersionInfo(e){const t=this.updater.allowPrerelease;let n=this.basePath;t||(n=`${n}/latest`);const i=s.newUrlFromBase(n,this.baseUrl);try{const n=JSON.parse(await this.httpRequest(i,this.configureHeaders("application/vnd.github.v3+json"),e));return t?n.find((e=>e.prerelease))||n[0]:n}catch(e){throw r.newError(`Unable to find latest version on GitHub (${i}), please ensure a production release exists: ${e.stack||e.message}`,"ERR_UPDATER_LATEST_VERSION_NOT_FOUND")}}get basePath(){return this.computeGithubBasePath(`/repos/${this.options.owner}/${this.options.repo}/releases`)}resolveFiles(e){return c.getFileList(e).map((t=>{const n=o.posix.basename(t.url).replace(/ /g,"-"),i=e.assets.find((e=>null!=e&&e.name===n));if(null==i)throw r.newError(`Cannot find asset "${n}" in: ${JSON.stringify(e.assets,null,2)}`,"ERR_UPDATER_ASSET_NOT_FOUND");return{url:new a.URL(i.url),info:t}}))}}t.PrivateGitHubProvider=d},2310:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveFiles=t.getFileList=t.parseUpdateInfo=t.findFile=t.Provider=void 0;const r=n(9152),i=n(3320),o=n(1293);function a(e){const t=e.files;if(null!=t&&t.length>0)return t;if(null!=e.path)return[{url:e.path,sha2:e.sha2,sha512:e.sha512}];throw r.newError(`No files provided: ${r.safeStringifyJson(e)}`,"ERR_UPDATER_NO_FILES_PROVIDED")}t.Provider=class{constructor(e){this.runtimeOptions=e,this.requestHeaders=null,this.executor=e.executor}get isUseMultipleRangeRequest(){return!1!==this.runtimeOptions.isUseMultipleRangeRequest}getChannelFilePrefix(){if("linux"===this.runtimeOptions.platform){const e=process.env.TEST_UPDATER_ARCH||process.arch;return"-linux"+("x64"===e?"":`-${e}`)}return"darwin"===this.runtimeOptions.platform?"-mac":""}getDefaultChannelName(){return this.getCustomChannelName("latest")}getCustomChannelName(e){return`${e}${this.getChannelFilePrefix()}`}get fileExtraDownloadHeaders(){return null}setRequestHeaders(e){this.requestHeaders=e}httpRequest(e,t,n){return this.executor.request(this.createRequestOptions(e,t),n)}createRequestOptions(e,t){const n={};return null==this.requestHeaders?null!=t&&(n.headers=t):n.headers=null==t?this.requestHeaders:{...this.requestHeaders,...t},r.configureRequestUrl(e,n),n}},t.findFile=function(e,t,n){if(0===e.length)throw r.newError("No files provided","ERR_UPDATER_NO_FILES_PROVIDED");const i=e.find((e=>e.url.pathname.toLowerCase().endsWith(`.${t}`)));return null!=i?i:null==n?e[0]:e.find((e=>!n.some((t=>e.url.pathname.toLowerCase().endsWith(`.${t}`)))))},t.parseUpdateInfo=function(e,t,n){if(null==e)throw r.newError(`Cannot parse update info from ${t} in the latest release artifacts (${n}): rawData: null`,"ERR_UPDATER_INVALID_UPDATE_INFO");let o;try{o=i.load(e)}catch(i){throw r.newError(`Cannot parse update info from ${t} in the latest release artifacts (${n}): ${i.stack||i.message}, rawData: ${e}`,"ERR_UPDATER_INVALID_UPDATE_INFO")}return o},t.getFileList=a,t.resolveFiles=function(e,t,n=(e=>e)){const i=a(e).map((e=>{if(null==e.sha2&&null==e.sha512)throw r.newError(`Update info doesn't contain nor sha256 neither sha512 checksum: ${r.safeStringifyJson(e)}`,"ERR_UPDATER_NO_CHECKSUM");return{url:o.newUrlFromBase(n(e.url),t),info:e}})),s=e.packages,l=null==s?null:s[process.arch]||s.ia32;return null!=l&&(i[0].packageInfo={...l,path:o.newUrlFromBase(n(l.path),t).href}),i}},1293:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.blockmapFiles=t.getChannelFilename=t.newUrlFromBase=t.newBaseUrl=void 0;const r=n(7310),i=n(1658);function o(e,t,n=!1){const i=new r.URL(e,t),o=t.search;return null!=o&&0!==o.length?i.search=o:n&&(i.search=`noCache=${Date.now().toString(32)}`),i}t.newBaseUrl=function(e){const t=new r.URL(e);return t.pathname.endsWith("/")||(t.pathname+="/"),t},t.newUrlFromBase=o,t.getChannelFilename=function(e){return`${e}.yml`},t.blockmapFiles=function(e,t,n){const r=o(`${e.pathname}.blockmap`,e);return[o(`${e.pathname.replace(new RegExp(i(n),"g"),t)}.blockmap`,e),r]}},6659:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.verifySignature=void 0;const r=n(9152),i=n(2081),o=n(2037);t.verifySignature=function(e,t,n){return new Promise((a=>{const s=t.replace(/'/g,"''").replace(/`/g,"``");i.execFile("powershell.exe",["-NoProfile","-NonInteractive","-InputFormat","None","-Command",`Get-AuthenticodeSignature '${s}' | ConvertTo-Json -Compress | ForEach-Object { [Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($_)) }`],{timeout:2e4},((t,s,l)=>{try{if(null!=t||l)return function(e,t,n){if(function(){const e=o.release();return e.startsWith("6.")&&!e.startsWith("6.3")}())e.warn(`Cannot execute Get-AuthenticodeSignature: ${t||n}. Ignoring signature validation due to unsupported powershell version. Please upgrade to powershell 3 or higher.`);else{try{i.execFileSync("powershell.exe",["-NoProfile","-NonInteractive","-Command","ConvertTo-Json test"],{timeout:1e4})}catch(t){return void e.warn(`Cannot execute ConvertTo-Json: ${t.message}. Ignoring signature validation due to unsupported powershell version. Please upgrade to powershell 3 or higher.`)}if(null!=t)throw t;n&&e.warn(`Cannot execute Get-AuthenticodeSignature, stderr: ${n}. Ignoring signature validation due to unknown stderr.`)}}(n,t,l),void a(null);const c=function(e){const t=JSON.parse(e);delete t.PrivateKey,delete t.IsOSBinary,delete t.SignatureType;const n=t.SignerCertificate;return null!=n&&(delete n.Archived,delete n.Extensions,delete n.Handle,delete n.HasPrivateKey,delete n.SubjectName),delete t.Path,t}(Buffer.from(s,"base64").toString("utf-8"));if(0===c.Status){const t=r.parseDn(c.SignerCertificate.Subject).get("CN");if(e.includes(t))return void a(null)}const d=`publisherNames: ${e.join(" | ")}, raw info: `+JSON.stringify(c,((e,t)=>"RawData"===e?void 0:t),2);n.warn(`Sign verification failed, installer signed with incorrect certificate: ${d}`),a(d)}catch(e){return n.warn(`Cannot execute Get-AuthenticodeSignature: ${t}. Ignoring signature validation due to unknown error.`),void a(null)}}))}))}},3320:(e,t,n)=>{"use strict";var r=n(7990),i=n(3150);function o(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}e.exports.Type=n(1364),e.exports.Schema=n(7657),e.exports.FAILSAFE_SCHEMA=n(4795),e.exports.JSON_SCHEMA=n(5966),e.exports.CORE_SCHEMA=n(9471),e.exports.DEFAULT_SCHEMA=n(6601),e.exports.load=r.load,e.exports.loadAll=r.loadAll,e.exports.dump=i.dump,e.exports.YAMLException=n(8425),e.exports.types={binary:n(3531),float:n(5215),map:n(945),null:n(151),pairs:n(6879),set:n(4982),timestamp:n(2156),bool:n(8771),int:n(1518),merge:n(7452),omap:n(1605),seq:n(6451),str:n(48)},e.exports.safeLoad=o("safeLoad","load"),e.exports.safeLoadAll=o("safeLoadAll","loadAll"),e.exports.safeDump=o("safeDump","dump")},8347:e=>{"use strict";function t(e){return null==e}e.exports.isNothing=t,e.exports.isObject=function(e){return"object"==typeof e&&null!==e},e.exports.toArray=function(e){return Array.isArray(e)?e:t(e)?[]:[e]},e.exports.repeat=function(e,t){var n,r="";for(n=0;n<t;n+=1)r+=e;return r},e.exports.isNegativeZero=function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e},e.exports.extend=function(e,t){var n,r,i,o;if(t)for(n=0,r=(o=Object.keys(t)).length;n<r;n+=1)e[i=o[n]]=t[i];return e}},3150:(e,t,n)=>{"use strict";var r=n(8347),i=n(8425),o=n(6601),a=Object.prototype.toString,s=Object.prototype.hasOwnProperty,l=65279,c={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},d=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],u=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function h(e){var t,n,o;if(t=e.toString(16).toUpperCase(),e<=255)n="x",o=2;else if(e<=65535)n="u",o=4;else{if(!(e<=4294967295))throw new i("code point within a string may not be greater than 0xFFFFFFFF");n="U",o=8}return"\\"+n+r.repeat("0",o-t.length)+t}function p(e){this.schema=e.schema||o,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=r.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=function(e,t){var n,r,i,o,a,l,c;if(null===t)return{};for(n={},i=0,o=(r=Object.keys(t)).length;i<o;i+=1)a=r[i],l=String(t[a]),"!!"===a.slice(0,2)&&(a="tag:yaml.org,2002:"+a.slice(2)),(c=e.compiledTypeMap.fallback[a])&&s.call(c.styleAliases,l)&&(l=c.styleAliases[l]),n[a]=l;return n}(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType='"'===e.quotingType?2:1,this.forceQuotes=e.forceQuotes||!1,this.replacer="function"==typeof e.replacer?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function f(e,t){for(var n,i=r.repeat(" ",t),o=0,a=-1,s="",l=e.length;o<l;)-1===(a=e.indexOf("\n",o))?(n=e.slice(o),o=l):(n=e.slice(o,a+1),o=a+1),n.length&&"\n"!==n&&(s+=i),s+=n;return s}function m(e,t){return"\n"+r.repeat(" ",e.indent*t)}function g(e){return 32===e||9===e}function w(e){return 32<=e&&e<=126||161<=e&&e<=55295&&8232!==e&&8233!==e||57344<=e&&e<=65533&&e!==l||65536<=e&&e<=1114111}function b(e){return w(e)&&e!==l&&13!==e&&10!==e}function E(e,t,n){var r=b(e),i=r&&!g(e);return(n?r:r&&44!==e&&91!==e&&93!==e&&123!==e&&125!==e)&&35!==e&&!(58===t&&!i)||b(t)&&!g(t)&&35===e||58===t&&i}function y(e,t){var n,r=e.charCodeAt(t);return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1))>=56320&&n<=57343?1024*(r-55296)+n-56320+65536:r}function _(e){return/^\n* /.test(e)}function v(e,t,n,r,o){e.dump=function(){if(0===t.length)return 2===e.quotingType?'""':"''";if(!e.noCompatMode&&(-1!==d.indexOf(t)||u.test(t)))return 2===e.quotingType?'"'+t+'"':"'"+t+"'";var a=e.indent*Math.max(1,n),s=-1===e.lineWidth?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-a),p=r||e.flowLevel>-1&&n>=e.flowLevel;switch(function(e,t,n,r,i,o,a,s){var c,d,u=0,h=null,p=!1,f=!1,m=-1!==r,b=-1,v=w(d=y(e,0))&&d!==l&&!g(d)&&45!==d&&63!==d&&58!==d&&44!==d&&91!==d&&93!==d&&123!==d&&125!==d&&35!==d&&38!==d&&42!==d&&33!==d&&124!==d&&61!==d&&62!==d&&39!==d&&34!==d&&37!==d&&64!==d&&96!==d&&function(e){return!g(e)&&58!==e}(y(e,e.length-1));if(t||a)for(c=0;c<e.length;u>=65536?c+=2:c++){if(!w(u=y(e,c)))return 5;v=v&&E(u,h,s),h=u}else{for(c=0;c<e.length;u>=65536?c+=2:c++){if(10===(u=y(e,c)))p=!0,m&&(f=f||c-b-1>r&&" "!==e[b+1],b=c);else if(!w(u))return 5;v=v&&E(u,h,s),h=u}f=f||m&&c-b-1>r&&" "!==e[b+1]}return p||f?n>9&&_(e)?5:a?2===o?5:2:f?4:3:!v||a||i(e)?2===o?5:2:1}(t,p,e.indent,s,(function(t){return function(e,t){var n,r;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(e.implicitTypes[n].resolve(t))return!0;return!1}(e,t)}),e.quotingType,e.forceQuotes&&!r,o)){case 1:return t;case 2:return"'"+t.replace(/'/g,"''")+"'";case 3:return"|"+C(t,e.indent)+A(f(t,a));case 4:return">"+C(t,e.indent)+A(f(function(e,t){for(var n,r,i,o=/(\n+)([^\n]*)/g,a=(i=-1!==(i=e.indexOf("\n"))?i:e.length,o.lastIndex=i,T(e.slice(0,i),t)),s="\n"===e[0]||" "===e[0];r=o.exec(e);){var l=r[1],c=r[2];n=" "===c[0],a+=l+(s||n||""===c?"":"\n")+T(c,t),s=n}return a}(t,s),a));case 5:return'"'+function(e){for(var t,n="",r=0,i=0;i<e.length;r>=65536?i+=2:i++)r=y(e,i),!(t=c[r])&&w(r)?(n+=e[i],r>=65536&&(n+=e[i+1])):n+=t||h(r);return n}(t)+'"';default:throw new i("impossible error: invalid scalar style")}}()}function C(e,t){var n=_(e)?String(t):"",r="\n"===e[e.length-1];return n+(!r||"\n"!==e[e.length-2]&&"\n"!==e?r?"":"-":"+")+"\n"}function A(e){return"\n"===e[e.length-1]?e.slice(0,-1):e}function T(e,t){if(""===e||" "===e[0])return e;for(var n,r,i=/ [^ ]/g,o=0,a=0,s=0,l="";n=i.exec(e);)(s=n.index)-o>t&&(r=a>o?a:s,l+="\n"+e.slice(o,r),o=r+1),a=s;return l+="\n",e.length-o>t&&a>o?l+=e.slice(o,a)+"\n"+e.slice(a+1):l+=e.slice(o),l.slice(1)}function I(e,t,n,r){var i,o,a,s="",l=e.tag;for(i=0,o=n.length;i<o;i+=1)a=n[i],e.replacer&&(a=e.replacer.call(n,String(i),a)),(R(e,t+1,a,!0,!0,!1,!0)||void 0===a&&R(e,t+1,null,!0,!0,!1,!0))&&(r&&""===s||(s+=m(e,t)),e.dump&&10===e.dump.charCodeAt(0)?s+="-":s+="- ",s+=e.dump);e.tag=l,e.dump=s||"[]"}function O(e,t,n){var r,o,l,c,d,u;for(l=0,c=(o=n?e.explicitTypes:e.implicitTypes).length;l<c;l+=1)if(((d=o[l]).instanceOf||d.predicate)&&(!d.instanceOf||"object"==typeof t&&t instanceof d.instanceOf)&&(!d.predicate||d.predicate(t))){if(n?d.multi&&d.representName?e.tag=d.representName(t):e.tag=d.tag:e.tag="?",d.represent){if(u=e.styleMap[d.tag]||d.defaultStyle,"[object Function]"===a.call(d.represent))r=d.represent(t,u);else{if(!s.call(d.represent,u))throw new i("!<"+d.tag+'> tag resolver accepts not "'+u+'" style');r=d.represent[u](t,u)}e.dump=r}return!0}return!1}function R(e,t,n,r,o,s,l){e.tag=null,e.dump=n,O(e,n,!1)||O(e,n,!0);var c,d=a.call(e.dump),u=r;r&&(r=e.flowLevel<0||e.flowLevel>t);var h,p,f="[object Object]"===d||"[object Array]"===d;if(f&&(p=-1!==(h=e.duplicates.indexOf(n))),(null!==e.tag&&"?"!==e.tag||p||2!==e.indent&&t>0)&&(o=!1),p&&e.usedDuplicates[h])e.dump="*ref_"+h;else{if(f&&p&&!e.usedDuplicates[h]&&(e.usedDuplicates[h]=!0),"[object Object]"===d)r&&0!==Object.keys(e.dump).length?(function(e,t,n,r){var o,a,s,l,c,d,u="",h=e.tag,p=Object.keys(n);if(!0===e.sortKeys)p.sort();else if("function"==typeof e.sortKeys)p.sort(e.sortKeys);else if(e.sortKeys)throw new i("sortKeys must be a boolean or a function");for(o=0,a=p.length;o<a;o+=1)d="",r&&""===u||(d+=m(e,t)),l=n[s=p[o]],e.replacer&&(l=e.replacer.call(n,s,l)),R(e,t+1,s,!0,!0,!0)&&((c=null!==e.tag&&"?"!==e.tag||e.dump&&e.dump.length>1024)&&(e.dump&&10===e.dump.charCodeAt(0)?d+="?":d+="? "),d+=e.dump,c&&(d+=m(e,t)),R(e,t+1,l,!0,c)&&(e.dump&&10===e.dump.charCodeAt(0)?d+=":":d+=": ",u+=d+=e.dump));e.tag=h,e.dump=u||"{}"}(e,t,e.dump,o),p&&(e.dump="&ref_"+h+e.dump)):(function(e,t,n){var r,i,o,a,s,l="",c=e.tag,d=Object.keys(n);for(r=0,i=d.length;r<i;r+=1)s="",""!==l&&(s+=", "),e.condenseFlow&&(s+='"'),a=n[o=d[r]],e.replacer&&(a=e.replacer.call(n,o,a)),R(e,t,o,!1,!1)&&(e.dump.length>1024&&(s+="? "),s+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),R(e,t,a,!1,!1)&&(l+=s+=e.dump));e.tag=c,e.dump="{"+l+"}"}(e,t,e.dump),p&&(e.dump="&ref_"+h+" "+e.dump));else if("[object Array]"===d)r&&0!==e.dump.length?(e.noArrayIndent&&!l&&t>0?I(e,t-1,e.dump,o):I(e,t,e.dump,o),p&&(e.dump="&ref_"+h+e.dump)):(function(e,t,n){var r,i,o,a="",s=e.tag;for(r=0,i=n.length;r<i;r+=1)o=n[r],e.replacer&&(o=e.replacer.call(n,String(r),o)),(R(e,t,o,!1,!1)||void 0===o&&R(e,t,null,!1,!1))&&(""!==a&&(a+=","+(e.condenseFlow?"":" ")),a+=e.dump);e.tag=s,e.dump="["+a+"]"}(e,t,e.dump),p&&(e.dump="&ref_"+h+" "+e.dump));else{if("[object String]"!==d){if("[object Undefined]"===d)return!1;if(e.skipInvalid)return!1;throw new i("unacceptable kind of an object to dump "+d)}"?"!==e.tag&&v(e,e.dump,t,s,u)}null!==e.tag&&"?"!==e.tag&&(c=encodeURI("!"===e.tag[0]?e.tag.slice(1):e.tag).replace(/!/g,"%21"),c="!"===e.tag[0]?"!"+c:"tag:yaml.org,2002:"===c.slice(0,18)?"!!"+c.slice(18):"!<"+c+">",e.dump=c+" "+e.dump)}return!0}function S(e,t){var n,r,i=[],o=[];for(k(e,i,o),n=0,r=o.length;n<r;n+=1)t.duplicates.push(i[o[n]]);t.usedDuplicates=new Array(r)}function k(e,t,n){var r,i,o;if(null!==e&&"object"==typeof e)if(-1!==(i=t.indexOf(e)))-1===n.indexOf(i)&&n.push(i);else if(t.push(e),Array.isArray(e))for(i=0,o=e.length;i<o;i+=1)k(e[i],t,n);else for(i=0,o=(r=Object.keys(e)).length;i<o;i+=1)k(e[r[i]],t,n)}e.exports.dump=function(e,t){var n=new p(t=t||{});n.noRefs||S(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),R(n,0,r,!0,!0)?n.dump+"\n":""}},8425:e=>{"use strict";function t(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+="\n\n"+e.mark.snippet),r+" "+n):r}function n(e,n){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=n,this.message=t(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n.prototype.toString=function(e){return this.name+": "+t(this,e)},e.exports=n},7990:(e,t,n)=>{"use strict";var r=n(8347),i=n(8425),o=n(192),a=n(6601),s=Object.prototype.hasOwnProperty,l=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,c=/[\x85\u2028\u2029]/,d=/[,\[\]\{\}]/,u=/^(?:!|!!|![a-z\-]+!)$/i,h=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function p(e){return Object.prototype.toString.call(e)}function f(e){return 10===e||13===e}function m(e){return 9===e||32===e}function g(e){return 9===e||32===e||10===e||13===e}function w(e){return 44===e||91===e||93===e||123===e||125===e}function b(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}function E(e){return 48===e?"\0":97===e?"":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"":95===e?" ":76===e?"\u2028":80===e?"\u2029":""}function y(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}for(var _=new Array(256),v=new Array(256),C=0;C<256;C++)_[C]=E(C)?1:0,v[C]=E(C);function A(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||a,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function T(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=o(n),new i(t,n)}function I(e,t){throw T(e,t)}function O(e,t){e.onWarning&&e.onWarning.call(null,T(e,t))}var R={YAML:function(e,t,n){var r,i,o;null!==e.version&&I(e,"duplication of %YAML directive"),1!==n.length&&I(e,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(n[0]))&&I(e,"ill-formed argument of the YAML directive"),i=parseInt(r[1],10),o=parseInt(r[2],10),1!==i&&I(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=o<2,1!==o&&2!==o&&O(e,"unsupported YAML version of the document")},TAG:function(e,t,n){var r,i;2!==n.length&&I(e,"TAG directive accepts exactly two arguments"),r=n[0],i=n[1],u.test(r)||I(e,"ill-formed tag handle (first argument) of the TAG directive"),s.call(e.tagMap,r)&&I(e,'there is a previously declared suffix for "'+r+'" tag handle'),h.test(i)||I(e,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch(t){I(e,"tag prefix is malformed: "+i)}e.tagMap[r]=i}};function S(e,t,n,r){var i,o,a,s;if(t<n){if(s=e.input.slice(t,n),r)for(i=0,o=s.length;i<o;i+=1)9===(a=s.charCodeAt(i))||32<=a&&a<=1114111||I(e,"expected valid JSON character");else l.test(s)&&I(e,"the stream contains non-printable characters");e.result+=s}}function k(e,t,n,i){var o,a,l,c;for(r.isObject(n)||I(e,"cannot merge mappings; the provided source object is unacceptable"),l=0,c=(o=Object.keys(n)).length;l<c;l+=1)a=o[l],s.call(t,a)||(t[a]=n[a],i[a]=!0)}function D(e,t,n,r,i,o,a,l,c){var d,u;if(Array.isArray(i))for(d=0,u=(i=Array.prototype.slice.call(i)).length;d<u;d+=1)Array.isArray(i[d])&&I(e,"nested arrays are not supported inside keys"),"object"==typeof i&&"[object Object]"===p(i[d])&&(i[d]="[object Object]");if("object"==typeof i&&"[object Object]"===p(i)&&(i="[object Object]"),i=String(i),null===t&&(t={}),"tag:yaml.org,2002:merge"===r)if(Array.isArray(o))for(d=0,u=o.length;d<u;d+=1)k(e,t,o[d],n);else k(e,t,o,n);else e.json||s.call(n,i)||!s.call(t,i)||(e.line=a||e.line,e.lineStart=l||e.lineStart,e.position=c||e.position,I(e,"duplicated mapping key")),"__proto__"===i?Object.defineProperty(t,i,{configurable:!0,enumerable:!0,writable:!0,value:o}):t[i]=o,delete n[i];return t}function P(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):I(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function M(e,t,n){for(var r=0,i=e.input.charCodeAt(e.position);0!==i;){for(;m(i);)9===i&&-1===e.firstTabInLine&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&35===i)do{i=e.input.charCodeAt(++e.position)}while(10!==i&&13!==i&&0!==i);if(!f(i))break;for(P(e),i=e.input.charCodeAt(e.position),r++,e.lineIndent=0;32===i;)e.lineIndent++,i=e.input.charCodeAt(++e.position)}return-1!==n&&0!==r&&e.lineIndent<n&&O(e,"deficient indentation"),r}function N(e){var t,n=e.position;return!(45!==(t=e.input.charCodeAt(n))&&46!==t||t!==e.input.charCodeAt(n+1)||t!==e.input.charCodeAt(n+2)||(n+=3,0!==(t=e.input.charCodeAt(n))&&!g(t)))}function x(e,t){1===t?e.result+=" ":t>1&&(e.result+=r.repeat("\n",t-1))}function F(e,t){var n,r,i=e.tag,o=e.anchor,a=[],s=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=a),r=e.input.charCodeAt(e.position);0!==r&&(-1!==e.firstTabInLine&&(e.position=e.firstTabInLine,I(e,"tab characters must not be used in indentation")),45===r)&&g(e.input.charCodeAt(e.position+1));)if(s=!0,e.position++,M(e,!0,-1)&&e.lineIndent<=t)a.push(null),r=e.input.charCodeAt(e.position);else if(n=e.line,$(e,t,3,!1,!0),a.push(e.result),M(e,!0,-1),r=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&0!==r)I(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break;return!!s&&(e.tag=i,e.anchor=o,e.kind="sequence",e.result=a,!0)}function L(e){var t,n,r,i,o=!1,a=!1;if(33!==(i=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&I(e,"duplication of a tag property"),60===(i=e.input.charCodeAt(++e.position))?(o=!0,i=e.input.charCodeAt(++e.position)):33===i?(a=!0,n="!!",i=e.input.charCodeAt(++e.position)):n="!",t=e.position,o){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&62!==i);e.position<e.length?(r=e.input.slice(t,e.position),i=e.input.charCodeAt(++e.position)):I(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==i&&!g(i);)33===i&&(a?I(e,"tag suffix cannot contain exclamation marks"):(n=e.input.slice(t-1,e.position+1),u.test(n)||I(e,"named tag handle cannot contain such characters"),a=!0,t=e.position+1)),i=e.input.charCodeAt(++e.position);r=e.input.slice(t,e.position),d.test(r)&&I(e,"tag suffix cannot contain flow indicator characters")}r&&!h.test(r)&&I(e,"tag name cannot contain such characters: "+r);try{r=decodeURIComponent(r)}catch(t){I(e,"tag name is malformed: "+r)}return o?e.tag=r:s.call(e.tagMap,n)?e.tag=e.tagMap[n]+r:"!"===n?e.tag="!"+r:"!!"===n?e.tag="tag:yaml.org,2002:"+r:I(e,'undeclared tag handle "'+n+'"'),!0}function U(e){var t,n;if(38!==(n=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&I(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!g(n)&&!w(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&I(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function $(e,t,n,i,o){var a,l,c,d,u,h,p,E,C,A=1,T=!1,O=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,a=l=c=4===n||3===n,i&&M(e,!0,-1)&&(T=!0,e.lineIndent>t?A=1:e.lineIndent===t?A=0:e.lineIndent<t&&(A=-1)),1===A)for(;L(e)||U(e);)M(e,!0,-1)?(T=!0,c=a,e.lineIndent>t?A=1:e.lineIndent===t?A=0:e.lineIndent<t&&(A=-1)):c=!1;if(c&&(c=T||o),1!==A&&4!==n||(E=1===n||2===n?t:t+1,C=e.position-e.lineStart,1===A?c&&(F(e,C)||function(e,t,n){var r,i,o,a,s,l,c,d=e.tag,u=e.anchor,h={},p=Object.create(null),f=null,w=null,b=null,E=!1,y=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=h),c=e.input.charCodeAt(e.position);0!==c;){if(E||-1===e.firstTabInLine||(e.position=e.firstTabInLine,I(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),o=e.line,63!==c&&58!==c||!g(r)){if(a=e.line,s=e.lineStart,l=e.position,!$(e,n,2,!1,!0))break;if(e.line===o){for(c=e.input.charCodeAt(e.position);m(c);)c=e.input.charCodeAt(++e.position);if(58===c)g(c=e.input.charCodeAt(++e.position))||I(e,"a whitespace character is expected after the key-value separator within a block mapping"),E&&(D(e,h,p,f,w,null,a,s,l),f=w=b=null),y=!0,E=!1,i=!1,f=e.tag,w=e.result;else{if(!y)return e.tag=d,e.anchor=u,!0;I(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!y)return e.tag=d,e.anchor=u,!0;I(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===c?(E&&(D(e,h,p,f,w,null,a,s,l),f=w=b=null),y=!0,E=!0,i=!0):E?(E=!1,i=!0):I(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,c=r;if((e.line===o||e.lineIndent>t)&&(E&&(a=e.line,s=e.lineStart,l=e.position),$(e,t,4,!0,i)&&(E?w=e.result:b=e.result),E||(D(e,h,p,f,w,b,a,s,l),f=w=b=null),M(e,!0,-1),c=e.input.charCodeAt(e.position)),(e.line===o||e.lineIndent>t)&&0!==c)I(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return E&&D(e,h,p,f,w,null,a,s,l),y&&(e.tag=d,e.anchor=u,e.kind="mapping",e.result=h),y}(e,C,E))||function(e,t){var n,r,i,o,a,s,l,c,d,u,h,p,f=!0,m=e.tag,w=e.anchor,b=Object.create(null);if(91===(p=e.input.charCodeAt(e.position)))a=93,c=!1,o=[];else{if(123!==p)return!1;a=125,c=!0,o={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=o),p=e.input.charCodeAt(++e.position);0!==p;){if(M(e,!0,t),(p=e.input.charCodeAt(e.position))===a)return e.position++,e.tag=m,e.anchor=w,e.kind=c?"mapping":"sequence",e.result=o,!0;f?44===p&&I(e,"expected the node content, but found ','"):I(e,"missed comma between flow collection entries"),h=null,s=l=!1,63===p&&g(e.input.charCodeAt(e.position+1))&&(s=l=!0,e.position++,M(e,!0,t)),n=e.line,r=e.lineStart,i=e.position,$(e,t,1,!1,!0),u=e.tag,d=e.result,M(e,!0,t),p=e.input.charCodeAt(e.position),!l&&e.line!==n||58!==p||(s=!0,p=e.input.charCodeAt(++e.position),M(e,!0,t),$(e,t,1,!1,!0),h=e.result),c?D(e,o,b,u,d,h,n,r,i):s?o.push(D(e,null,b,u,d,h,n,r,i)):o.push(d),M(e,!0,t),44===(p=e.input.charCodeAt(e.position))?(f=!0,p=e.input.charCodeAt(++e.position)):f=!1}I(e,"unexpected end of the stream within a flow collection")}(e,E)?O=!0:(l&&function(e,t){var n,i,o,a,s,l=1,c=!1,d=!1,u=t,h=0,p=!1;if(124===(a=e.input.charCodeAt(e.position)))i=!1;else{if(62!==a)return!1;i=!0}for(e.kind="scalar",e.result="";0!==a;)if(43===(a=e.input.charCodeAt(++e.position))||45===a)1===l?l=43===a?3:2:I(e,"repeat of a chomping mode identifier");else{if(!((o=48<=(s=a)&&s<=57?s-48:-1)>=0))break;0===o?I(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):d?I(e,"repeat of an indentation width identifier"):(u=t+o-1,d=!0)}if(m(a)){do{a=e.input.charCodeAt(++e.position)}while(m(a));if(35===a)do{a=e.input.charCodeAt(++e.position)}while(!f(a)&&0!==a)}for(;0!==a;){for(P(e),e.lineIndent=0,a=e.input.charCodeAt(e.position);(!d||e.lineIndent<u)&&32===a;)e.lineIndent++,a=e.input.charCodeAt(++e.position);if(!d&&e.lineIndent>u&&(u=e.lineIndent),f(a))h++;else{if(e.lineIndent<u){3===l?e.result+=r.repeat("\n",c?1+h:h):1===l&&c&&(e.result+="\n");break}for(i?m(a)?(p=!0,e.result+=r.repeat("\n",c?1+h:h)):p?(p=!1,e.result+=r.repeat("\n",h+1)):0===h?c&&(e.result+=" "):e.result+=r.repeat("\n",h):e.result+=r.repeat("\n",c?1+h:h),c=!0,d=!0,h=0,n=e.position;!f(a)&&0!==a;)a=e.input.charCodeAt(++e.position);S(e,n,e.position,!1)}}return!0}(e,E)||function(e,t){var n,r,i;if(39!==(n=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,r=i=e.position;0!==(n=e.input.charCodeAt(e.position));)if(39===n){if(S(e,r,e.position,!0),39!==(n=e.input.charCodeAt(++e.position)))return!0;r=e.position,e.position++,i=e.position}else f(n)?(S(e,r,i,!0),x(e,M(e,!1,t)),r=i=e.position):e.position===e.lineStart&&N(e)?I(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);I(e,"unexpected end of the stream within a single quoted scalar")}(e,E)||function(e,t){var n,r,i,o,a,s,l;if(34!==(s=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;0!==(s=e.input.charCodeAt(e.position));){if(34===s)return S(e,n,e.position,!0),e.position++,!0;if(92===s){if(S(e,n,e.position,!0),f(s=e.input.charCodeAt(++e.position)))M(e,!1,t);else if(s<256&&_[s])e.result+=v[s],e.position++;else if((a=120===(l=s)?2:117===l?4:85===l?8:0)>0){for(i=a,o=0;i>0;i--)(a=b(s=e.input.charCodeAt(++e.position)))>=0?o=(o<<4)+a:I(e,"expected hexadecimal character");e.result+=y(o),e.position++}else I(e,"unknown escape sequence");n=r=e.position}else f(s)?(S(e,n,r,!0),x(e,M(e,!1,t)),n=r=e.position):e.position===e.lineStart&&N(e)?I(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}I(e,"unexpected end of the stream within a double quoted scalar")}(e,E)?O=!0:function(e){var t,n,r;if(42!==(r=e.input.charCodeAt(e.position)))return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;0!==r&&!g(r)&&!w(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&I(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),s.call(e.anchorMap,n)||I(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],M(e,!0,-1),!0}(e)?(O=!0,null===e.tag&&null===e.anchor||I(e,"alias node should not have any properties")):function(e,t,n){var r,i,o,a,s,l,c,d,u=e.kind,h=e.result;if(g(d=e.input.charCodeAt(e.position))||w(d)||35===d||38===d||42===d||33===d||124===d||62===d||39===d||34===d||37===d||64===d||96===d)return!1;if((63===d||45===d)&&(g(r=e.input.charCodeAt(e.position+1))||n&&w(r)))return!1;for(e.kind="scalar",e.result="",i=o=e.position,a=!1;0!==d;){if(58===d){if(g(r=e.input.charCodeAt(e.position+1))||n&&w(r))break}else if(35===d){if(g(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&N(e)||n&&w(d))break;if(f(d)){if(s=e.line,l=e.lineStart,c=e.lineIndent,M(e,!1,-1),e.lineIndent>=t){a=!0,d=e.input.charCodeAt(e.position);continue}e.position=o,e.line=s,e.lineStart=l,e.lineIndent=c;break}}a&&(S(e,i,o,!1),x(e,e.line-s),i=o=e.position,a=!1),m(d)||(o=e.position+1),d=e.input.charCodeAt(++e.position)}return S(e,i,o,!1),!!e.result||(e.kind=u,e.result=h,!1)}(e,E,1===n)&&(O=!0,null===e.tag&&(e.tag="?")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===A&&(O=c&&F(e,C))),null===e.tag)null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);else if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&I(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),d=0,u=e.implicitTypes.length;d<u;d+=1)if((p=e.implicitTypes[d]).resolve(e.result)){e.result=p.construct(e.result),e.tag=p.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else if("!"!==e.tag){if(s.call(e.typeMap[e.kind||"fallback"],e.tag))p=e.typeMap[e.kind||"fallback"][e.tag];else for(p=null,d=0,u=(h=e.typeMap.multi[e.kind||"fallback"]).length;d<u;d+=1)if(e.tag.slice(0,h[d].tag.length)===h[d].tag){p=h[d];break}p||I(e,"unknown tag !<"+e.tag+">"),null!==e.result&&p.kind!==e.kind&&I(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+p.kind+'", not "'+e.kind+'"'),p.resolve(e.result,e.tag)?(e.result=p.construct(e.result,e.tag),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):I(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||O}function B(e){var t,n,r,i,o=e.position,a=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);0!==(i=e.input.charCodeAt(e.position))&&(M(e,!0,-1),i=e.input.charCodeAt(e.position),!(e.lineIndent>0||37!==i));){for(a=!0,i=e.input.charCodeAt(++e.position),t=e.position;0!==i&&!g(i);)i=e.input.charCodeAt(++e.position);for(r=[],(n=e.input.slice(t,e.position)).length<1&&I(e,"directive name must not be less than one character in length");0!==i;){for(;m(i);)i=e.input.charCodeAt(++e.position);if(35===i){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&!f(i));break}if(f(i))break;for(t=e.position;0!==i&&!g(i);)i=e.input.charCodeAt(++e.position);r.push(e.input.slice(t,e.position))}0!==i&&P(e),s.call(R,n)?R[n](e,n,r):O(e,'unknown document directive "'+n+'"')}M(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,M(e,!0,-1)):a&&I(e,"directives end mark is expected"),$(e,e.lineIndent-1,4,!1,!0),M(e,!0,-1),e.checkLineBreaks&&c.test(e.input.slice(o,e.position))&&O(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&N(e)?46===e.input.charCodeAt(e.position)&&(e.position+=3,M(e,!0,-1)):e.position<e.length-1&&I(e,"end of the stream or a document separator is expected")}function j(e,t){t=t||{},0!==(e=String(e)).length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var n=new A(e,t),r=e.indexOf("\0");for(-1!==r&&(n.position=r,I(n,"null byte is not allowed in input")),n.input+="\0";32===n.input.charCodeAt(n.position);)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)B(n);return n.documents}e.exports.loadAll=function(e,t,n){null!==t&&"object"==typeof t&&void 0===n&&(n=t,t=null);var r=j(e,n);if("function"!=typeof t)return r;for(var i=0,o=r.length;i<o;i+=1)t(r[i])},e.exports.load=function(e,t){var n=j(e,t);if(0!==n.length){if(1===n.length)return n[0];throw new i("expected a single document in the stream, but found more")}}},7657:(e,t,n)=>{"use strict";var r=n(8425),i=n(1364);function o(e,t){var n=[];return e[t].forEach((function(e){var t=n.length;n.forEach((function(n,r){n.tag===e.tag&&n.kind===e.kind&&n.multi===e.multi&&(t=r)})),n[t]=e})),n}function a(e){return this.extend(e)}a.prototype.extend=function(e){var t=[],n=[];if(e instanceof i)n.push(e);else if(Array.isArray(e))n=n.concat(e);else{if(!e||!Array.isArray(e.implicit)&&!Array.isArray(e.explicit))throw new r("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit))}t.forEach((function(e){if(!(e instanceof i))throw new r("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new r("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new r("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")})),n.forEach((function(e){if(!(e instanceof i))throw new r("Specified list of YAML types (or a single Type object) contains a non-Type object.")}));var s=Object.create(a.prototype);return s.implicit=(this.implicit||[]).concat(t),s.explicit=(this.explicit||[]).concat(n),s.compiledImplicit=o(s,"implicit"),s.compiledExplicit=o(s,"explicit"),s.compiledTypeMap=function(){var e,t,n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function r(e){e.multi?(n.multi[e.kind].push(e),n.multi.fallback.push(e)):n[e.kind][e.tag]=n.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(r);return n}(s.compiledImplicit,s.compiledExplicit),s},e.exports=a},9471:(e,t,n)=>{"use strict";e.exports=n(5966)},6601:(e,t,n)=>{"use strict";e.exports=n(9471).extend({implicit:[n(2156),n(7452)],explicit:[n(3531),n(1605),n(6879),n(4982)]})},4795:(e,t,n)=>{"use strict";var r=n(7657);e.exports=new r({explicit:[n(48),n(6451),n(945)]})},5966:(e,t,n)=>{"use strict";e.exports=n(4795).extend({implicit:[n(151),n(8771),n(1518),n(5215)]})},192:(e,t,n)=>{"use strict";var r=n(8347);function i(e,t,n,r,i){var o="",a="",s=Math.floor(i/2)-1;return r-t>s&&(t=r-s+(o=" ... ").length),n-r>s&&(n=r+s-(a=" ...").length),{str:o+e.slice(t,n).replace(/\t/g,"→")+a,pos:r-t+o.length}}function o(e,t){return r.repeat(" ",t-e.length)+e}e.exports=function(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var n,a=/\r?\n|\r|\0/g,s=[0],l=[],c=-1;n=a.exec(e.buffer);)l.push(n.index),s.push(n.index+n[0].length),e.position<=n.index&&c<0&&(c=s.length-2);c<0&&(c=s.length-1);var d,u,h="",p=Math.min(e.line+t.linesAfter,l.length).toString().length,f=t.maxLength-(t.indent+p+3);for(d=1;d<=t.linesBefore&&!(c-d<0);d++)u=i(e.buffer,s[c-d],l[c-d],e.position-(s[c]-s[c-d]),f),h=r.repeat(" ",t.indent)+o((e.line-d+1).toString(),p)+" | "+u.str+"\n"+h;for(u=i(e.buffer,s[c],l[c],e.position,f),h+=r.repeat(" ",t.indent)+o((e.line+1).toString(),p)+" | "+u.str+"\n",h+=r.repeat("-",t.indent+p+3+u.pos)+"^\n",d=1;d<=t.linesAfter&&!(c+d>=l.length);d++)u=i(e.buffer,s[c+d],l[c+d],e.position-(s[c]-s[c+d]),f),h+=r.repeat(" ",t.indent)+o((e.line+d+1).toString(),p)+" | "+u.str+"\n";return h.replace(/\n$/,"")}},1364:(e,t,n)=>{"use strict";var r=n(8425),i=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],o=["scalar","sequence","mapping"];e.exports=function(e,t){var n,a;if(t=t||{},Object.keys(t).forEach((function(t){if(-1===i.indexOf(t))throw new r('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')})),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=(n=t.styleAliases||null,a={},null!==n&&Object.keys(n).forEach((function(e){n[e].forEach((function(t){a[String(t)]=e}))})),a),-1===o.indexOf(this.kind))throw new r('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}},3531:(e,t,n)=>{"use strict";var r=n(1364),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";e.exports=new r("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,r=0,o=e.length,a=i;for(n=0;n<o;n++)if(!((t=a.indexOf(e.charAt(n)))>64)){if(t<0)return!1;r+=6}return r%8==0},construct:function(e){var t,n,r=e.replace(/[\r\n=]/g,""),o=r.length,a=i,s=0,l=[];for(t=0;t<o;t++)t%4==0&&t&&(l.push(s>>16&255),l.push(s>>8&255),l.push(255&s)),s=s<<6|a.indexOf(r.charAt(t));return 0==(n=o%4*6)?(l.push(s>>16&255),l.push(s>>8&255),l.push(255&s)):18===n?(l.push(s>>10&255),l.push(s>>2&255)):12===n&&l.push(s>>4&255),new Uint8Array(l)},predicate:function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)},represent:function(e){var t,n,r="",o=0,a=e.length,s=i;for(t=0;t<a;t++)t%3==0&&t&&(r+=s[o>>18&63],r+=s[o>>12&63],r+=s[o>>6&63],r+=s[63&o]),o=(o<<8)+e[t];return 0==(n=a%3)?(r+=s[o>>18&63],r+=s[o>>12&63],r+=s[o>>6&63],r+=s[63&o]):2===n?(r+=s[o>>10&63],r+=s[o>>4&63],r+=s[o<<2&63],r+=s[64]):1===n&&(r+=s[o>>2&63],r+=s[o<<4&63],r+=s[64],r+=s[64]),r}})},8771:(e,t,n)=>{"use strict";var r=n(1364);e.exports=new r("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"})},5215:(e,t,n)=>{"use strict";var r=n(8347),i=n(1364),o=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),a=/^[-+]?[0-9]+e/;e.exports=new i("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!(!o.test(e)||"_"===e[e.length-1])},construct:function(e){var t,n;return n="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===n?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:n*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||r.isNegativeZero(e))},represent:function(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(r.isNegativeZero(e))return"-0.0";return n=e.toString(10),a.test(n)?n.replace("e",".e"):n},defaultStyle:"lowercase"})},1518:(e,t,n)=>{"use strict";var r=n(8347),i=n(1364);function o(e){return 48<=e&&e<=55}function a(e){return 48<=e&&e<=57}e.exports=new i("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,r=e.length,i=0,s=!1;if(!r)return!1;if("-"!==(t=e[i])&&"+"!==t||(t=e[++i]),"0"===t){if(i+1===r)return!0;if("b"===(t=e[++i])){for(i++;i<r;i++)if("_"!==(t=e[i])){if("0"!==t&&"1"!==t)return!1;s=!0}return s&&"_"!==t}if("x"===t){for(i++;i<r;i++)if("_"!==(t=e[i])){if(!(48<=(n=e.charCodeAt(i))&&n<=57||65<=n&&n<=70||97<=n&&n<=102))return!1;s=!0}return s&&"_"!==t}if("o"===t){for(i++;i<r;i++)if("_"!==(t=e[i])){if(!o(e.charCodeAt(i)))return!1;s=!0}return s&&"_"!==t}}if("_"===t)return!1;for(;i<r;i++)if("_"!==(t=e[i])){if(!a(e.charCodeAt(i)))return!1;s=!0}return!(!s||"_"===t)},construct:function(e){var t,n=e,r=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),"-"!==(t=n[0])&&"+"!==t||("-"===t&&(r=-1),t=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===t){if("b"===n[1])return r*parseInt(n.slice(2),2);if("x"===n[1])return r*parseInt(n.slice(2),16);if("o"===n[1])return r*parseInt(n.slice(2),8)}return r*parseInt(n,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!r.isNegativeZero(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}})},945:(e,t,n)=>{"use strict";var r=n(1364);e.exports=new r("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}})},7452:(e,t,n)=>{"use strict";var r=n(1364);e.exports=new r("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}})},151:(e,t,n)=>{"use strict";var r=n(1364);e.exports=new r("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"})},1605:(e,t,n)=>{"use strict";var r=n(1364),i=Object.prototype.hasOwnProperty,o=Object.prototype.toString;e.exports=new r("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,r,a,s,l=[],c=e;for(t=0,n=c.length;t<n;t+=1){if(r=c[t],s=!1,"[object Object]"!==o.call(r))return!1;for(a in r)if(i.call(r,a)){if(s)return!1;s=!0}if(!s)return!1;if(-1!==l.indexOf(a))return!1;l.push(a)}return!0},construct:function(e){return null!==e?e:[]}})},6879:(e,t,n)=>{"use strict";var r=n(1364),i=Object.prototype.toString;e.exports=new r("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,r,o,a,s=e;for(a=new Array(s.length),t=0,n=s.length;t<n;t+=1){if(r=s[t],"[object Object]"!==i.call(r))return!1;if(1!==(o=Object.keys(r)).length)return!1;a[t]=[o[0],r[o[0]]]}return!0},construct:function(e){if(null===e)return[];var t,n,r,i,o,a=e;for(o=new Array(a.length),t=0,n=a.length;t<n;t+=1)r=a[t],i=Object.keys(r),o[t]=[i[0],r[i[0]]];return o}})},6451:(e,t,n)=>{"use strict";var r=n(1364);e.exports=new r("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}})},4982:(e,t,n)=>{"use strict";var r=n(1364),i=Object.prototype.hasOwnProperty;e.exports=new r("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){if(null===e)return!0;var t,n=e;for(t in n)if(i.call(n,t)&&null!==n[t])return!1;return!0},construct:function(e){return null!==e?e:{}}})},48:(e,t,n)=>{"use strict";var r=n(1364);e.exports=new r("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}})},2156:(e,t,n)=>{"use strict";var r=n(1364),i=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),o=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");e.exports=new r("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==i.exec(e)||null!==o.exec(e))},construct:function(e){var t,n,r,a,s,l,c,d,u=0,h=null;if(null===(t=i.exec(e))&&(t=o.exec(e)),null===t)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,a=+t[3],!t[4])return new Date(Date.UTC(n,r,a));if(s=+t[4],l=+t[5],c=+t[6],t[7]){for(u=t[7].slice(0,3);u.length<3;)u+="0";u=+u}return t[9]&&(h=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(h=-h)),d=new Date(Date.UTC(n,r,a,s,l,c,u)),h&&d.setTime(d.getTime()-h),d},instanceOf:Date,represent:function(e){return e.toISOString()}})},8218:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Lazy=void 0,t.Lazy=class{constructor(e){this._value=null,this.creator=e}get hasValue(){return null==this.creator}get value(){if(null==this.creator)return this._value;const e=this.creator();return this.value=e,e}set value(e){this._value=e,this.creator=null}}},1658:e=>{var t=/[\\^$.*+?()[\]{}|]/g,n=RegExp(t.source),r="object"==typeof global&&global&&global.Object===Object&&global,i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")(),a=Object.prototype.toString,s=o.Symbol,l=s?s.prototype:void 0,c=l?l.toString:void 0;e.exports=function(e){var r;return(e=null==(r=e)?"":function(e){if("string"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==a.call(e)}(e))return c?c.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(r))&&n.test(e)?e.replace(t,"\\$&"):e}},2307:(e,t,n)=>{e=n.nmd(e);var r="__lodash_hash_undefined__",i=9007199254740991,o="[object Arguments]",a="[object Array]",s="[object Boolean]",l="[object Date]",c="[object Error]",d="[object Function]",u="[object Map]",h="[object Number]",p="[object Object]",f="[object Promise]",m="[object RegExp]",g="[object Set]",w="[object String]",b="[object WeakMap]",E="[object ArrayBuffer]",y="[object DataView]",_=/^\[object .+?Constructor\]$/,v=/^(?:0|[1-9]\d*)$/,C={};C["[object Float32Array]"]=C["[object Float64Array]"]=C["[object Int8Array]"]=C["[object Int16Array]"]=C["[object Int32Array]"]=C["[object Uint8Array]"]=C["[object Uint8ClampedArray]"]=C["[object Uint16Array]"]=C["[object Uint32Array]"]=!0,C[o]=C[a]=C[E]=C[s]=C[y]=C[l]=C[c]=C[d]=C[u]=C[h]=C[p]=C[m]=C[g]=C[w]=C[b]=!1;var A="object"==typeof global&&global&&global.Object===Object&&global,T="object"==typeof self&&self&&self.Object===Object&&self,I=A||T||Function("return this")(),O=t&&!t.nodeType&&t,R=O&&e&&!e.nodeType&&e,S=R&&R.exports===O,k=S&&A.process,D=function(){try{return k&&k.binding&&k.binding("util")}catch(e){}}(),P=D&&D.isTypedArray;function M(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function N(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function x(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var F,L,U,$=Array.prototype,B=Function.prototype,j=Object.prototype,W=I["__core-js_shared__"],H=B.toString,G=j.hasOwnProperty,q=(F=/[^.]+$/.exec(W&&W.keys&&W.keys.IE_PROTO||""))?"Symbol(src)_1."+F:"",V=j.toString,z=RegExp("^"+H.call(G).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),K=S?I.Buffer:void 0,X=I.Symbol,Y=I.Uint8Array,J=j.propertyIsEnumerable,Q=$.splice,Z=X?X.toStringTag:void 0,ee=Object.getOwnPropertySymbols,te=K?K.isBuffer:void 0,ne=(L=Object.keys,U=Object,function(e){return L(U(e))}),re=Re(I,"DataView"),ie=Re(I,"Map"),oe=Re(I,"Promise"),ae=Re(I,"Set"),se=Re(I,"WeakMap"),le=Re(Object,"create"),ce=Pe(re),de=Pe(ie),ue=Pe(oe),he=Pe(ae),pe=Pe(se),fe=X?X.prototype:void 0,me=fe?fe.valueOf:void 0;function ge(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function we(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function be(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Ee(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new be;++t<n;)this.add(e[t])}function ye(e){var t=this.__data__=new we(e);this.size=t.size}function _e(e,t){for(var n=e.length;n--;)if(Me(e[n][0],t))return n;return-1}function ve(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Z&&Z in Object(e)?function(e){var t=G.call(e,Z),n=e[Z];try{e[Z]=void 0;var r=!0}catch(e){}var i=V.call(e);return r&&(t?e[Z]=n:delete e[Z]),i}(e):function(e){return V.call(e)}(e)}function Ce(e){return Be(e)&&ve(e)==o}function Ae(e,t,n,r,i){return e===t||(null==e||null==t||!Be(e)&&!Be(t)?e!=e&&t!=t:function(e,t,n,r,i,d){var f=xe(e),b=xe(t),_=f?a:ke(e),v=b?a:ke(t),C=(_=_==o?p:_)==p,A=(v=v==o?p:v)==p,T=_==v;if(T&&Fe(e)){if(!Fe(t))return!1;f=!0,C=!1}if(T&&!C)return d||(d=new ye),f||je(e)?Te(e,t,n,r,i,d):function(e,t,n,r,i,o,a){switch(n){case y:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case E:return!(e.byteLength!=t.byteLength||!o(new Y(e),new Y(t)));case s:case l:case h:return Me(+e,+t);case c:return e.name==t.name&&e.message==t.message;case m:case w:return e==t+"";case u:var d=N;case g:var p=1&r;if(d||(d=x),e.size!=t.size&&!p)return!1;var f=a.get(e);if(f)return f==t;r|=2,a.set(e,t);var b=Te(d(e),d(t),r,i,o,a);return a.delete(e),b;case"[object Symbol]":if(me)return me.call(e)==me.call(t)}return!1}(e,t,_,n,r,i,d);if(!(1&n)){var I=C&&G.call(e,"__wrapped__"),O=A&&G.call(t,"__wrapped__");if(I||O){var R=I?e.value():e,S=O?t.value():t;return d||(d=new ye),i(R,S,n,r,d)}}return!!T&&(d||(d=new ye),function(e,t,n,r,i,o){var a=1&n,s=Ie(e),l=s.length;if(l!=Ie(t).length&&!a)return!1;for(var c=l;c--;){var d=s[c];if(!(a?d in t:G.call(t,d)))return!1}var u=o.get(e);if(u&&o.get(t))return u==t;var h=!0;o.set(e,t),o.set(t,e);for(var p=a;++c<l;){var f=e[d=s[c]],m=t[d];if(r)var g=a?r(m,f,d,t,e,o):r(f,m,d,e,t,o);if(!(void 0===g?f===m||i(f,m,n,r,o):g)){h=!1;break}p||(p="constructor"==d)}if(h&&!p){var w=e.constructor,b=t.constructor;w==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof w&&w instanceof w&&"function"==typeof b&&b instanceof b||(h=!1)}return o.delete(e),o.delete(t),h}(e,t,n,r,i,d))}(e,t,n,r,Ae,i))}function Te(e,t,n,r,i,o){var a=1&n,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=o.get(e);if(c&&o.get(t))return c==t;var d=-1,u=!0,h=2&n?new Ee:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var p=e[d],f=t[d];if(r)var m=a?r(f,p,d,t,e,o):r(p,f,d,e,t,o);if(void 0!==m){if(m)continue;u=!1;break}if(h){if(!M(t,(function(e,t){if(a=t,!h.has(a)&&(p===e||i(p,e,n,r,o)))return h.push(t);var a}))){u=!1;break}}else if(p!==f&&!i(p,f,n,r,o)){u=!1;break}}return o.delete(e),o.delete(t),u}function Ie(e){return function(e,t,n){var r=t(e);return xe(e)?r:function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}(r,n(e))}(e,We,Se)}function Oe(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Re(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!$e(e)||function(e){return!!q&&q in e}(e))&&(Le(e)?z:_).test(Pe(e))}(n)?n:void 0}ge.prototype.clear=function(){this.__data__=le?le(null):{},this.size=0},ge.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ge.prototype.get=function(e){var t=this.__data__;if(le){var n=t[e];return n===r?void 0:n}return G.call(t,e)?t[e]:void 0},ge.prototype.has=function(e){var t=this.__data__;return le?void 0!==t[e]:G.call(t,e)},ge.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=le&&void 0===t?r:t,this},we.prototype.clear=function(){this.__data__=[],this.size=0},we.prototype.delete=function(e){var t=this.__data__,n=_e(t,e);return!(n<0||(n==t.length-1?t.pop():Q.call(t,n,1),--this.size,0))},we.prototype.get=function(e){var t=this.__data__,n=_e(t,e);return n<0?void 0:t[n][1]},we.prototype.has=function(e){return _e(this.__data__,e)>-1},we.prototype.set=function(e,t){var n=this.__data__,r=_e(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},be.prototype.clear=function(){this.size=0,this.__data__={hash:new ge,map:new(ie||we),string:new ge}},be.prototype.delete=function(e){var t=Oe(this,e).delete(e);return this.size-=t?1:0,t},be.prototype.get=function(e){return Oe(this,e).get(e)},be.prototype.has=function(e){return Oe(this,e).has(e)},be.prototype.set=function(e,t){var n=Oe(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Ee.prototype.add=Ee.prototype.push=function(e){return this.__data__.set(e,r),this},Ee.prototype.has=function(e){return this.__data__.has(e)},ye.prototype.clear=function(){this.__data__=new we,this.size=0},ye.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},ye.prototype.get=function(e){return this.__data__.get(e)},ye.prototype.has=function(e){return this.__data__.has(e)},ye.prototype.set=function(e,t){var n=this.__data__;if(n instanceof we){var r=n.__data__;if(!ie||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new be(r)}return n.set(e,t),this.size=n.size,this};var Se=ee?function(e){return null==e?[]:(e=Object(e),function(t,n){for(var r=-1,i=null==t?0:t.length,o=0,a=[];++r<i;){var s=t[r];l=s,J.call(e,l)&&(a[o++]=s)}var l;return a}(ee(e)))}:function(){return[]},ke=ve;function De(e,t){return!!(t=null==t?i:t)&&("number"==typeof e||v.test(e))&&e>-1&&e%1==0&&e<t}function Pe(e){if(null!=e){try{return H.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Me(e,t){return e===t||e!=e&&t!=t}(re&&ke(new re(new ArrayBuffer(1)))!=y||ie&&ke(new ie)!=u||oe&&ke(oe.resolve())!=f||ae&&ke(new ae)!=g||se&&ke(new se)!=b)&&(ke=function(e){var t=ve(e),n=t==p?e.constructor:void 0,r=n?Pe(n):"";if(r)switch(r){case ce:return y;case de:return u;case ue:return f;case he:return g;case pe:return b}return t});var Ne=Ce(function(){return arguments}())?Ce:function(e){return Be(e)&&G.call(e,"callee")&&!J.call(e,"callee")},xe=Array.isArray,Fe=te||function(){return!1};function Le(e){if(!$e(e))return!1;var t=ve(e);return t==d||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Ue(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}function $e(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Be(e){return null!=e&&"object"==typeof e}var je=P?function(e){return function(t){return e(t)}}(P):function(e){return Be(e)&&Ue(e.length)&&!!C[ve(e)]};function We(e){return null!=(t=e)&&Ue(t.length)&&!Le(t)?function(e,t){var n=xe(e),r=!n&&Ne(e),i=!n&&!r&&Fe(e),o=!n&&!r&&!i&&je(e),a=n||r||i||o,s=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],l=s.length;for(var c in e)!t&&!G.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||De(c,l))||s.push(c);return s}(e):function(e){if(n=(t=e)&&t.constructor,t!==("function"==typeof n&&n.prototype||j))return ne(e);var t,n,r=[];for(var i in Object(e))G.call(e,i)&&"constructor"!=i&&r.push(i);return r}(e);var t}e.exports=function(e,t){return Ae(e,t)}},9593:(e,t,n)=>{"use strict";const r=n(4411),i=Symbol("max"),o=Symbol("length"),a=Symbol("lengthCalculator"),s=Symbol("allowStale"),l=Symbol("maxAge"),c=Symbol("dispose"),d=Symbol("noDisposeOnSet"),u=Symbol("lruList"),h=Symbol("cache"),p=Symbol("updateAgeOnGet"),f=()=>1,m=(e,t,n)=>{const r=e[h].get(t);if(r){const t=r.value;if(g(e,t)){if(b(e,r),!e[s])return}else n&&(e[p]&&(r.value.now=Date.now()),e[u].unshiftNode(r));return t.value}},g=(e,t)=>{if(!t||!t.maxAge&&!e[l])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[l]&&n>e[l]},w=e=>{if(e[o]>e[i])for(let t=e[u].tail;e[o]>e[i]&&null!==t;){const n=t.prev;b(e,t),t=n}},b=(e,t)=>{if(t){const n=t.value;e[c]&&e[c](n.key,n.value),e[o]-=n.length,e[h].delete(n.key),e[u].removeNode(t)}};class E{constructor(e,t,n,r,i){this.key=e,this.value=t,this.length=n,this.now=r,this.maxAge=i||0}}const y=(e,t,n,r)=>{let i=n.value;g(e,i)&&(b(e,n),e[s]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};e.exports=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[i]=e.max||1/0;const t=e.length||f;if(this[a]="function"!=typeof t?f:t,this[s]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[l]=e.maxAge||0,this[c]=e.dispose,this[d]=e.noDisposeOnSet||!1,this[p]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[i]=e||1/0,w(this)}get max(){return this[i]}set allowStale(e){this[s]=!!e}get allowStale(){return this[s]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[l]=e,w(this)}get maxAge(){return this[l]}set lengthCalculator(e){"function"!=typeof e&&(e=f),e!==this[a]&&(this[a]=e,this[o]=0,this[u].forEach((e=>{e.length=this[a](e.value,e.key),this[o]+=e.length}))),w(this)}get lengthCalculator(){return this[a]}get length(){return this[o]}get itemCount(){return this[u].length}rforEach(e,t){t=t||this;for(let n=this[u].tail;null!==n;){const r=n.prev;y(this,e,n,t),n=r}}forEach(e,t){t=t||this;for(let n=this[u].head;null!==n;){const r=n.next;y(this,e,n,t),n=r}}keys(){return this[u].toArray().map((e=>e.key))}values(){return this[u].toArray().map((e=>e.value))}reset(){this[c]&&this[u]&&this[u].length&&this[u].forEach((e=>this[c](e.key,e.value))),this[h]=new Map,this[u]=new r,this[o]=0}dump(){return this[u].map((e=>!g(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[u]}set(e,t,n){if((n=n||this[l])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,s=this[a](t,e);if(this[h].has(e)){if(s>this[i])return b(this,this[h].get(e)),!1;const a=this[h].get(e).value;return this[c]&&(this[d]||this[c](e,a.value)),a.now=r,a.maxAge=n,a.value=t,this[o]+=s-a.length,a.length=s,this.get(e),w(this),!0}const p=new E(e,t,s,r,n);return p.length>this[i]?(this[c]&&this[c](e,t),!1):(this[o]+=p.length,this[u].unshift(p),this[h].set(e,this[u].head),w(this),!0)}has(e){if(!this[h].has(e))return!1;const t=this[h].get(e).value;return!g(this,t)}get(e){return m(this,e,!0)}peek(e){return m(this,e,!1)}pop(){const e=this[u].tail;return e?(b(this,e),e.value):null}del(e){b(this,this[h].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const r=e[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{const e=i-t;e>0&&this.set(r.k,r.v,e)}}}prune(){this[h].forEach(((e,t)=>m(this,t,!1)))}}},6099:(e,t,n)=>{!function(e){e.parser=function(e,t){return new i(e,t)},e.SAXParser=i,e.SAXStream=a,e.createStream=function(e,t){return new a(e,t)},e.MAX_BUFFER_LENGTH=65536;var t,r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function i(t,n){if(!(this instanceof i))return new i(t,n);var o=this;!function(e){for(var t=0,n=r.length;t<n;t++)e[r[t]]=""}(o),o.q=o.c="",o.bufferCheckPosition=e.MAX_BUFFER_LENGTH,o.opt=n||{},o.opt.lowercase=o.opt.lowercase||o.opt.lowercasetags,o.looseCase=o.opt.lowercase?"toLowerCase":"toUpperCase",o.tags=[],o.closed=o.closedRoot=o.sawRoot=!1,o.tag=o.error=null,o.strict=!!t,o.noscript=!(!t&&!o.opt.noscript),o.state=v.BEGIN,o.strictEntities=o.opt.strictEntities,o.ENTITIES=o.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),o.attribList=[],o.opt.xmlns&&(o.ns=Object.create(c)),o.trackPosition=!1!==o.opt.position,o.trackPosition&&(o.position=o.line=o.column=0),A(o,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),i.prototype={end:function(){S(this)},write:function(t){var n=this;if(this.error)throw this.error;if(n.closed)return R(n,"Cannot write after close. Assign an onready handler.");if(null===t)return S(n);"object"==typeof t&&(t=t.toString());for(var i=0,o="";o=U(t,i++),n.c=o,o;)switch(n.trackPosition&&(n.position++,"\n"===o?(n.line++,n.column=0):n.column++),n.state){case v.BEGIN:if(n.state=v.BEGIN_WHITESPACE,"\ufeff"===o)continue;L(n,o);continue;case v.BEGIN_WHITESPACE:L(n,o);continue;case v.TEXT:if(n.sawRoot&&!n.closedRoot){for(var a=i-1;o&&"<"!==o&&"&"!==o;)(o=U(t,i++))&&n.trackPosition&&(n.position++,"\n"===o?(n.line++,n.column=0):n.column++);n.textNode+=t.substring(a,i-1)}"<"!==o||n.sawRoot&&n.closedRoot&&!n.strict?(f(o)||n.sawRoot&&!n.closedRoot||k(n,"Text data outside of root node."),"&"===o?n.state=v.TEXT_ENTITY:n.textNode+=o):(n.state=v.OPEN_WAKA,n.startTagPosition=n.position);continue;case v.SCRIPT:"<"===o?n.state=v.SCRIPT_ENDING:n.script+=o;continue;case v.SCRIPT_ENDING:"/"===o?n.state=v.CLOSE_TAG:(n.script+="<"+o,n.state=v.SCRIPT);continue;case v.OPEN_WAKA:if("!"===o)n.state=v.SGML_DECL,n.sgmlDecl="";else if(f(o));else if(w(d,o))n.state=v.OPEN_TAG,n.tagName=o;else if("/"===o)n.state=v.CLOSE_TAG,n.tagName="";else if("?"===o)n.state=v.PROC_INST,n.procInstName=n.procInstBody="";else{if(k(n,"Unencoded <"),n.startTagPosition+1<n.position){var s=n.position-n.startTagPosition;o=new Array(s).join(" ")+o}n.textNode+="<"+o,n.state=v.TEXT}continue;case v.SGML_DECL:"[CDATA["===(n.sgmlDecl+o).toUpperCase()?(T(n,"onopencdata"),n.state=v.CDATA,n.sgmlDecl="",n.cdata=""):n.sgmlDecl+o==="--"?(n.state=v.COMMENT,n.comment="",n.sgmlDecl=""):"DOCTYPE"===(n.sgmlDecl+o).toUpperCase()?(n.state=v.DOCTYPE,(n.doctype||n.sawRoot)&&k(n,"Inappropriately located doctype declaration"),n.doctype="",n.sgmlDecl=""):">"===o?(T(n,"onsgmldeclaration",n.sgmlDecl),n.sgmlDecl="",n.state=v.TEXT):m(o)?(n.state=v.SGML_DECL_QUOTED,n.sgmlDecl+=o):n.sgmlDecl+=o;continue;case v.SGML_DECL_QUOTED:o===n.q&&(n.state=v.SGML_DECL,n.q=""),n.sgmlDecl+=o;continue;case v.DOCTYPE:">"===o?(n.state=v.TEXT,T(n,"ondoctype",n.doctype),n.doctype=!0):(n.doctype+=o,"["===o?n.state=v.DOCTYPE_DTD:m(o)&&(n.state=v.DOCTYPE_QUOTED,n.q=o));continue;case v.DOCTYPE_QUOTED:n.doctype+=o,o===n.q&&(n.q="",n.state=v.DOCTYPE);continue;case v.DOCTYPE_DTD:n.doctype+=o,"]"===o?n.state=v.DOCTYPE:m(o)&&(n.state=v.DOCTYPE_DTD_QUOTED,n.q=o);continue;case v.DOCTYPE_DTD_QUOTED:n.doctype+=o,o===n.q&&(n.state=v.DOCTYPE_DTD,n.q="");continue;case v.COMMENT:"-"===o?n.state=v.COMMENT_ENDING:n.comment+=o;continue;case v.COMMENT_ENDING:"-"===o?(n.state=v.COMMENT_ENDED,n.comment=O(n.opt,n.comment),n.comment&&T(n,"oncomment",n.comment),n.comment=""):(n.comment+="-"+o,n.state=v.COMMENT);continue;case v.COMMENT_ENDED:">"!==o?(k(n,"Malformed comment"),n.comment+="--"+o,n.state=v.COMMENT):n.state=v.TEXT;continue;case v.CDATA:"]"===o?n.state=v.CDATA_ENDING:n.cdata+=o;continue;case v.CDATA_ENDING:"]"===o?n.state=v.CDATA_ENDING_2:(n.cdata+="]"+o,n.state=v.CDATA);continue;case v.CDATA_ENDING_2:">"===o?(n.cdata&&T(n,"oncdata",n.cdata),T(n,"onclosecdata"),n.cdata="",n.state=v.TEXT):"]"===o?n.cdata+="]":(n.cdata+="]]"+o,n.state=v.CDATA);continue;case v.PROC_INST:"?"===o?n.state=v.PROC_INST_ENDING:f(o)?n.state=v.PROC_INST_BODY:n.procInstName+=o;continue;case v.PROC_INST_BODY:if(!n.procInstBody&&f(o))continue;"?"===o?n.state=v.PROC_INST_ENDING:n.procInstBody+=o;continue;case v.PROC_INST_ENDING:">"===o?(T(n,"onprocessinginstruction",{name:n.procInstName,body:n.procInstBody}),n.procInstName=n.procInstBody="",n.state=v.TEXT):(n.procInstBody+="?"+o,n.state=v.PROC_INST_BODY);continue;case v.OPEN_TAG:w(u,o)?n.tagName+=o:(D(n),">"===o?N(n):"/"===o?n.state=v.OPEN_TAG_SLASH:(f(o)||k(n,"Invalid character in tag name"),n.state=v.ATTRIB));continue;case v.OPEN_TAG_SLASH:">"===o?(N(n,!0),x(n)):(k(n,"Forward-slash in opening tag not followed by >"),n.state=v.ATTRIB);continue;case v.ATTRIB:if(f(o))continue;">"===o?N(n):"/"===o?n.state=v.OPEN_TAG_SLASH:w(d,o)?(n.attribName=o,n.attribValue="",n.state=v.ATTRIB_NAME):k(n,"Invalid attribute name");continue;case v.ATTRIB_NAME:"="===o?n.state=v.ATTRIB_VALUE:">"===o?(k(n,"Attribute without value"),n.attribValue=n.attribName,M(n),N(n)):f(o)?n.state=v.ATTRIB_NAME_SAW_WHITE:w(u,o)?n.attribName+=o:k(n,"Invalid attribute name");continue;case v.ATTRIB_NAME_SAW_WHITE:if("="===o)n.state=v.ATTRIB_VALUE;else{if(f(o))continue;k(n,"Attribute without value"),n.tag.attributes[n.attribName]="",n.attribValue="",T(n,"onattribute",{name:n.attribName,value:""}),n.attribName="",">"===o?N(n):w(d,o)?(n.attribName=o,n.state=v.ATTRIB_NAME):(k(n,"Invalid attribute name"),n.state=v.ATTRIB)}continue;case v.ATTRIB_VALUE:if(f(o))continue;m(o)?(n.q=o,n.state=v.ATTRIB_VALUE_QUOTED):(k(n,"Unquoted attribute value"),n.state=v.ATTRIB_VALUE_UNQUOTED,n.attribValue=o);continue;case v.ATTRIB_VALUE_QUOTED:if(o!==n.q){"&"===o?n.state=v.ATTRIB_VALUE_ENTITY_Q:n.attribValue+=o;continue}M(n),n.q="",n.state=v.ATTRIB_VALUE_CLOSED;continue;case v.ATTRIB_VALUE_CLOSED:f(o)?n.state=v.ATTRIB:">"===o?N(n):"/"===o?n.state=v.OPEN_TAG_SLASH:w(d,o)?(k(n,"No whitespace between attributes"),n.attribName=o,n.attribValue="",n.state=v.ATTRIB_NAME):k(n,"Invalid attribute name");continue;case v.ATTRIB_VALUE_UNQUOTED:if(!g(o)){"&"===o?n.state=v.ATTRIB_VALUE_ENTITY_U:n.attribValue+=o;continue}M(n),">"===o?N(n):n.state=v.ATTRIB;continue;case v.CLOSE_TAG:if(n.tagName)">"===o?x(n):w(u,o)?n.tagName+=o:n.script?(n.script+="</"+n.tagName,n.tagName="",n.state=v.SCRIPT):(f(o)||k(n,"Invalid tagname in closing tag"),n.state=v.CLOSE_TAG_SAW_WHITE);else{if(f(o))continue;b(d,o)?n.script?(n.script+="</"+o,n.state=v.SCRIPT):k(n,"Invalid tagname in closing tag."):n.tagName=o}continue;case v.CLOSE_TAG_SAW_WHITE:if(f(o))continue;">"===o?x(n):k(n,"Invalid characters in closing tag");continue;case v.TEXT_ENTITY:case v.ATTRIB_VALUE_ENTITY_Q:case v.ATTRIB_VALUE_ENTITY_U:var l,c;switch(n.state){case v.TEXT_ENTITY:l=v.TEXT,c="textNode";break;case v.ATTRIB_VALUE_ENTITY_Q:l=v.ATTRIB_VALUE_QUOTED,c="attribValue";break;case v.ATTRIB_VALUE_ENTITY_U:l=v.ATTRIB_VALUE_UNQUOTED,c="attribValue"}";"===o?(n[c]+=F(n),n.entity="",n.state=l):w(n.entity.length?p:h,o)?n.entity+=o:(k(n,"Invalid character in entity name"),n[c]+="&"+n.entity+o,n.entity="",n.state=l);continue;default:throw new Error(n,"Unknown state: "+n.state)}return n.position>=n.bufferCheckPosition&&function(t){for(var n=Math.max(e.MAX_BUFFER_LENGTH,10),i=0,o=0,a=r.length;o<a;o++){var s=t[r[o]].length;if(s>n)switch(r[o]){case"textNode":I(t);break;case"cdata":T(t,"oncdata",t.cdata),t.cdata="";break;case"script":T(t,"onscript",t.script),t.script="";break;default:R(t,"Max buffer length exceeded: "+r[o])}i=Math.max(i,s)}var l=e.MAX_BUFFER_LENGTH-i;t.bufferCheckPosition=l+t.position}(n),n},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;I(e=this),""!==e.cdata&&(T(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(T(e,"onscript",e.script),e.script="")}};try{t=n(2781).Stream}catch(e){t=function(){}}var o=e.EVENTS.filter((function(e){return"error"!==e&&"end"!==e}));function a(e,n){if(!(this instanceof a))return new a(e,n);t.apply(this),this._parser=new i(e,n),this.writable=!0,this.readable=!0;var r=this;this._parser.onend=function(){r.emit("end")},this._parser.onerror=function(e){r.emit("error",e),r._parser.error=null},this._decoder=null,o.forEach((function(e){Object.defineProperty(r,"on"+e,{get:function(){return r._parser["on"+e]},set:function(t){if(!t)return r.removeAllListeners(e),r._parser["on"+e]=t,t;r.on(e,t)},enumerable:!0,configurable:!1})}))}a.prototype=Object.create(t.prototype,{constructor:{value:a}}),a.prototype.write=function(e){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(e)){if(!this._decoder){var t=n(1576).StringDecoder;this._decoder=new t("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},a.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},a.prototype.on=function(e,n){var r=this;return r._parser["on"+e]||-1===o.indexOf(e)||(r._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),r.emit.apply(r,t)}),t.prototype.on.call(r,e,n)};var s="http://www.w3.org/XML/1998/namespace",l="http://www.w3.org/2000/xmlns/",c={xml:s,xmlns:l},d=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,u=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,h=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,p=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function f(e){return" "===e||"\n"===e||"\r"===e||"\t"===e}function m(e){return'"'===e||"'"===e}function g(e){return">"===e||f(e)}function w(e,t){return e.test(t)}function b(e,t){return!w(e,t)}var E,y,_,v=0;for(var C in e.STATE={BEGIN:v++,BEGIN_WHITESPACE:v++,TEXT:v++,TEXT_ENTITY:v++,OPEN_WAKA:v++,SGML_DECL:v++,SGML_DECL_QUOTED:v++,DOCTYPE:v++,DOCTYPE_QUOTED:v++,DOCTYPE_DTD:v++,DOCTYPE_DTD_QUOTED:v++,COMMENT_STARTING:v++,COMMENT:v++,COMMENT_ENDING:v++,COMMENT_ENDED:v++,CDATA:v++,CDATA_ENDING:v++,CDATA_ENDING_2:v++,PROC_INST:v++,PROC_INST_BODY:v++,PROC_INST_ENDING:v++,OPEN_TAG:v++,OPEN_TAG_SLASH:v++,ATTRIB:v++,ATTRIB_NAME:v++,ATTRIB_NAME_SAW_WHITE:v++,ATTRIB_VALUE:v++,ATTRIB_VALUE_QUOTED:v++,ATTRIB_VALUE_CLOSED:v++,ATTRIB_VALUE_UNQUOTED:v++,ATTRIB_VALUE_ENTITY_Q:v++,ATTRIB_VALUE_ENTITY_U:v++,CLOSE_TAG:v++,CLOSE_TAG_SAW_WHITE:v++,SCRIPT:v++,SCRIPT_ENDING:v++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach((function(t){var n=e.ENTITIES[t],r="number"==typeof n?String.fromCharCode(n):n;e.ENTITIES[t]=r})),e.STATE)e.STATE[e.STATE[C]]=C;function A(e,t,n){e[t]&&e[t](n)}function T(e,t,n){e.textNode&&I(e),A(e,t,n)}function I(e){e.textNode=O(e.opt,e.textNode),e.textNode&&A(e,"ontext",e.textNode),e.textNode=""}function O(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function R(e,t){return I(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,A(e,"onerror",t),e}function S(e){return e.sawRoot&&!e.closedRoot&&k(e,"Unclosed root tag"),e.state!==v.BEGIN&&e.state!==v.BEGIN_WHITESPACE&&e.state!==v.TEXT&&R(e,"Unexpected end"),I(e),e.c="",e.closed=!0,A(e,"onend"),i.call(e,e.strict,e.opt),e}function k(e,t){if("object"!=typeof e||!(e instanceof i))throw new Error("bad call to strictFail");e.strict&&R(e,t)}function D(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,n=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(n.ns=t.ns),e.attribList.length=0,T(e,"onopentagstart",n)}function P(e,t){var n=e.indexOf(":")<0?["",e]:e.split(":"),r=n[0],i=n[1];return t&&"xmlns"===e&&(r="xmlns",i=""),{prefix:r,local:i}}function M(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=P(e.attribName,!0),n=t.prefix,r=t.local;if("xmlns"===n)if("xml"===r&&e.attribValue!==s)k(e,"xml: prefix must be bound to "+s+"\nActual: "+e.attribValue);else if("xmlns"===r&&e.attribValue!==l)k(e,"xmlns: prefix must be bound to "+l+"\nActual: "+e.attribValue);else{var i=e.tag,o=e.tags[e.tags.length-1]||e;i.ns===o.ns&&(i.ns=Object.create(o.ns)),i.ns[r]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,T(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function N(e,t){if(e.opt.xmlns){var n=e.tag,r=P(e.tagName);n.prefix=r.prefix,n.local=r.local,n.uri=n.ns[r.prefix]||"",n.prefix&&!n.uri&&(k(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),n.uri=r.prefix);var i=e.tags[e.tags.length-1]||e;n.ns&&i.ns!==n.ns&&Object.keys(n.ns).forEach((function(t){T(e,"onopennamespace",{prefix:t,uri:n.ns[t]})}));for(var o=0,a=e.attribList.length;o<a;o++){var s=e.attribList[o],l=s[0],c=s[1],d=P(l,!0),u=d.prefix,h=d.local,p=""===u?"":n.ns[u]||"",f={name:l,value:c,prefix:u,local:h,uri:p};u&&"xmlns"!==u&&!p&&(k(e,"Unbound namespace prefix: "+JSON.stringify(u)),f.uri=u),e.tag.attributes[l]=f,T(e,"onattribute",f)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),T(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=v.TEXT:e.state=v.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function x(e){if(!e.tagName)return k(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=v.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=v.SCRIPT);T(e,"onscript",e.script),e.script=""}var t=e.tags.length,n=e.tagName;e.strict||(n=n[e.looseCase]());for(var r=n;t--&&e.tags[t].name!==r;)k(e,"Unexpected close tag");if(t<0)return k(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=v.TEXT);e.tagName=n;for(var i=e.tags.length;i-- >t;){var o=e.tag=e.tags.pop();e.tagName=e.tag.name,T(e,"onclosetag",e.tagName);var a={};for(var s in o.ns)a[s]=o.ns[s];var l=e.tags[e.tags.length-1]||e;e.opt.xmlns&&o.ns!==l.ns&&Object.keys(o.ns).forEach((function(t){var n=o.ns[t];T(e,"onclosenamespace",{prefix:t,uri:n})}))}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=v.TEXT}function F(e){var t,n=e.entity,r=n.toLowerCase(),i="";return e.ENTITIES[n]?e.ENTITIES[n]:e.ENTITIES[r]?e.ENTITIES[r]:("#"===(n=r).charAt(0)&&("x"===n.charAt(1)?(n=n.slice(2),i=(t=parseInt(n,16)).toString(16)):(n=n.slice(1),i=(t=parseInt(n,10)).toString(10))),n=n.replace(/^0+/,""),isNaN(t)||i.toLowerCase()!==n?(k(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function L(e,t){"<"===t?(e.state=v.OPEN_WAKA,e.startTagPosition=e.position):f(t)||(k(e,"Non-whitespace before first tag."),e.textNode=t,e.state=v.TEXT)}function U(e,t){var n="";return t<e.length&&(n=e.charAt(t)),n}v=e.STATE,String.fromCodePoint||(E=String.fromCharCode,y=Math.floor,_=function(){var e,t,n=16384,r=[],i=-1,o=arguments.length;if(!o)return"";for(var a="";++i<o;){var s=Number(arguments[i]);if(!isFinite(s)||s<0||s>1114111||y(s)!==s)throw RangeError("Invalid code point: "+s);s<=65535?r.push(s):(e=55296+((s-=65536)>>10),t=s%1024+56320,r.push(e,t)),(i+1===o||r.length>n)&&(a+=E.apply(null,r),r.length=0)}return a},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:_,configurable:!0,writable:!0}):String.fromCodePoint=_)}(t)},2130:(e,t,n)=>{"use strict";const r=n(2037),i=n(6224),o=n(2146),{env:a}=process;let s;function l(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function c(e,t){if(0===s)return 0;if(o("color=16m")||o("color=full")||o("color=truecolor"))return 3;if(o("color=256"))return 2;if(e&&!t&&void 0===s)return 0;const n=s||0;if("dumb"===a.TERM)return n;if("win32"===process.platform){const e=r.release().split(".");return Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in a)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some((e=>e in a))||"codeship"===a.CI_NAME?1:n;if("TEAMCITY_VERSION"in a)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(a.TEAMCITY_VERSION)?1:0;if("truecolor"===a.COLORTERM)return 3;if("TERM_PROGRAM"in a){const e=parseInt((a.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(a.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(a.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(a.TERM)||"COLORTERM"in a?1:n}o("no-color")||o("no-colors")||o("color=false")||o("color=never")?s=0:(o("color")||o("colors")||o("color=true")||o("color=always"))&&(s=1),"FORCE_COLOR"in a&&(s="true"===a.FORCE_COLOR?1:"false"===a.FORCE_COLOR?0:0===a.FORCE_COLOR.length?1:Math.min(parseInt(a.FORCE_COLOR,10),3)),e.exports={supportsColor:function(e){return l(c(e,e&&e.isTTY))},stdout:l(c(!0,i.isatty(1))),stderr:l(c(!0,i.isatty(2)))}},2146:e=>{"use strict";e.exports=(e,t=process.argv)=>{const n=e.startsWith("-")?"":1===e.length?"-":"--",r=t.indexOf(n+e),i=t.indexOf("--");return-1!==r&&(-1===i||r<i)}},9602:e=>{"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},4411:(e,t,n)=>{"use strict";function r(e){var t=this;if(t instanceof r||(t=new r),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);return t}function i(e,t,n){var r=t===e.head?new s(n,null,t,e):new s(n,t,t.next,e);return null===r.next&&(e.tail=r),null===r.prev&&(e.head=r),e.length++,r}function o(e,t){e.tail=new s(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function a(e,t){e.head=new s(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function s(e,t,n,r){if(!(this instanceof s))return new s(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}e.exports=r,r.Node=s,r.create=r,r.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},r.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},r.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},r.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},r.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)a(this,arguments[e]);return this.length},r.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},r.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},r.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},r.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},r.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},r.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},r.prototype.map=function(e,t){t=t||this;for(var n=new r,i=this.head;null!==i;)n.push(e.call(t,i.value,this)),i=i.next;return n},r.prototype.mapReverse=function(e,t){t=t||this;for(var n=new r,i=this.tail;null!==i;)n.push(e.call(t,i.value,this)),i=i.prev;return n},r.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=e(n,r.value,i),r=r.next;return n},r.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=e(n,r.value,i),r=r.prev;return n},r.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},r.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},r.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new r;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,o=this.head;null!==o&&i<e;i++)o=o.next;for(;null!==o&&i<t;i++,o=o.next)n.push(o.value);return n},r.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new r;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,o=this.tail;null!==o&&i>t;i--)o=o.prev;for(;null!==o&&i>e;i--,o=o.prev)n.push(o.value);return n},r.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,o=this.head;null!==o&&r<e;r++)o=o.next;var a=[];for(r=0;o&&r<t;r++)a.push(o.value),o=this.removeNode(o);for(null===o&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev),r=0;r<n.length;r++)o=i(this,o,n[r]);return a},r.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};try{n(9602)(r)}catch(e){}},4857:e=>{"use strict";e.exports=require("fs-extra")},2081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},2298:e=>{"use strict";e.exports=require("electron")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3292:e=>{"use strict";e.exports=require("fs/promises")},3685:e=>{"use strict";e.exports=require("http")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},1576:e=>{"use strict";e.exports=require("string_decoder")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var r={};(()=>{"use strict";n.r(r);var e=n(1017),t=n.n(e);global.__static=t().join(__dirname,"/static").replace(/\\/g,"\\\\");var i=n(2298),o=n(8539),a=n(2037),s=n.n(a),l=n(4857),c=n.n(l),d=n(3292),u=n.n(d);const h=async e=>{try{return await u().access(e),!0}catch(e){return!1}},p=e=>{try{c().ensureDirSync(e)}catch(e){if("EEXIST"!==e.code)throw e}},f=e=>{try{return c().existsSync(e)&&c().lstatSync(e).isDirectory()}catch(e){return!1}},m=e=>{try{if(!c().existsSync(e))return!1;const n=c().lstatSync(e);if(n.isDirectory())return!0;if(n.isSymbolicLink()){const n=t().resolve(t().dirname(e),c().readlinkSync(e));return f(n)}return!1}catch(e){return!1}},g=e=>{try{return c().existsSync(e)&&c().lstatSync(e).isFile()}catch(e){return!1}},w=e=>{try{if(!c().existsSync(e))return!1;const n=c().lstatSync(e);if(n.isFile())return!0;if(n.isSymbolicLink()){const n=t().resolve(t().dirname(e),c().readlinkSync(e));return g(n)}return!1}catch(e){return!1}},b=e=>{try{return c().existsSync(e)&&c().lstatSync(e).isSymbolicLink()}catch(e){return!1}},E=require("arg");var y=n.n(E);const _=(e=null,t=!0)=>{null===e&&(e=process.argv.slice(1));const n={"--debug":Boolean,"--safe":Boolean,"--new-window":Boolean,"-n":"--new-window","--disable-gpu":Boolean,"--disable-spellcheck":Boolean,"--user-data-dir":String,"--help":Boolean,"-h":"--help","--verbose":y().COUNT,"-v":"--verbose","--version":Boolean};return y()(n,{argv:e,permissive:t})};let v=0;const C=()=>"mt-"+v++,A=e=>{const t=e.match(/#{1,6} {1,}(.*\S.*)(?:\n|$)/g);return t?t.map((e=>{const t=e.trim().match(/(#{1,6}) {1,}(.+)/);return{level:t[1].length,content:t[2].trim()}})).sort(((e,t)=>e.level-t.level))[0].content:""},T=e=>{if("userData"===e)throw new Error('Do not use "getPath" for user data path!');return i.app.getPath(e)},I=e=>process.stdout.write(e),O=e=>I(e+"\n"),R=require("electron-log");var S=n.n(R);const k="darwin"===process.platform,D="win32"===process.platform,P="linux"===process.platform,M=Object.freeze({minWidth:550,minHeight:350,webPreferences:{contextIsolation:!1,spellcheck:!0,nodeIntegration:!0,webSecurity:!1},useContentSize:!0,show:!0,frame:!1,titleBarStyle:"hiddenInset",zoomFactor:1}),N=Object.freeze({minWidth:450,minHeight:350,width:950,height:650,webPreferences:{contextIsolation:!1,spellcheck:!0,nodeIntegration:!0,webSecurity:!1},fullscreenable:!1,fullscreen:!1,minimizable:!1,useContentSize:!0,show:!0,frame:!1,thickFrame:!k,titleBarStyle:"hiddenInset",zoomFactor:1}),x=Object.freeze(["html","docx","odt","latex","tex","ltx","rst","rest","org","wiki","dokuwiki","textile","opml","epub"]),F=Object.freeze(["$RECYCLE.BIN"]),L=Object.freeze({styledHtml:".html",pdf:".pdf"}),U=k?21:32,$=/(?:\r\n|\n)/g,B=/(?:[^\r]\n)|(?:^\n$)/,j=/\r\n/,W=/^http(s)?:\/\/([a-z0-9\-._~]+\.[a-z]{2,}|[0-9.]+|localhost|\[[a-f0-9.:]+\])(:[0-9]{1,5})?(\/[\S]+)?/i,H=!!process.env.MARKTEXT_EXIT_ON_ERROR,G=!process.env.MARKTEXT_ERROR_INTERACTION;let q=e=>console.error(e);const V=()=>`${s().type()} ${s().arch()} ${s().release()} (${s().platform()})`,z=async(e,t,n)=>{const{message:r,stack:o}=t;if("main"===n&&q(((e,t)=>{const{message:n,stack:r}=e;return`Version: v0.17.1 (17a839d)\nOS: ${V()}\nType: ${t}\nDate: ${(new Date).toUTCString()}\nMessage: ${n}\nStack: ${r}\n`})(t,n)),H)return console.log("MarkText was terminated due to an unexpected error (MARKTEXT_EXIT_ON_ERROR variable was set)!"),void process.exit(1);if(G)if(i.app.isReady()){const{response:t}=await i.dialog.showMessageBox({type:"error",buttons:["OK","Copy Error","Report..."],defaultId:0,noLink:!0,message:e,detail:o});switch(t){case 1:i.clipboard.writeText(`${e}\n${o}`);break;case 2:((e,t)=>{i.shell.openExternal(((e,t)=>{const n=new URL("https://github.com/marktext/marktext/issues/new");return e&&n.searchParams.set("title",e),t&&n.searchParams.set("body",t),n.toString()})(e,t))})(r?`Unexpected error: ${r}`:e,`### Description\n\n${e}.\n\n\x3c!-- Please describe, how the bug occurred --\x3e\n\n### Stack Trace\n\n\`\`\`\n${o}\n\`\`\`\n\n### Version\n\nMarkText: v0.17.1 (17a839d)\nOperating system: ${V()}`)}}else i.dialog.showErrorBox(e,o),process.exit(1)};var K=n(9713),X=n.n(K),Y=n(2081);const J=require("dayjs");var Q=n.n(J),Z=n(7147),ee=n.n(Z);process.platform;const te=Object.freeze(["markdown","mdown","mkdn","md","mkd","mdwn","mdtxt","mdtext","text","txt"]),ne=(Object.freeze(te.map((e=>"*."+e))),Object.freeze(["jpeg","jpg","png","gif","svg","webp"])),re=e=>!(!e||"string"!=typeof e)&&te.some((t=>e.toLowerCase().endsWith(`.${t}`))),ie=e=>{if(!w(e))return!1;if(b(e)){const n=t().resolve(t().dirname(e),ee().readlinkSync(e));return g(n)&&re(n)}return re(e)},oe=(e,n)=>{if(!e||!n)return!1;const r=t().relative(e,n);return r&&!r.startsWith("..")&&!t().isAbsolute(r)},ae=e=>{if(b(e)){const n=t().dirname(e),r=t().resolve(n,c().readlinkSync(e));return g(r)||f(r)?t().resolve(r):(console.error(`Cannot resolve link target "${e}" (${r}).`),"")}return t().resolve(e)},se=(e,t,n,r="utf-8")=>e?(e=!n||e.endsWith(n)?e:`${e}${n}`,c().outputFile(e,t,r)):Promise.reject(new Error("[ERROR] Cannot save file without path.")),le=require("iconv-lite");var ce=n.n(le);const de=require("ced");var ue=n.n(de);const he={"BIG5-CP950":"big5",KSC:"euckr","ISO-2022-KR":"euckr",GB:"gb2312",ISO_2022_CN:"gb2312",JIS:"shiftjis",SJS:"shiftjis",Unicode:"utf8","ASCII-7-bit":"utf8",ASCII:"utf8",MACINTOSH:"utf8"},pe={utf8:[239,187,191],utf16be:[254,255],utf16le:[255,254]},fe=(e,t)=>!(e.length<t.length)&&t.every(((t,n)=>t===e[n])),me=(e,t)=>e.replace($,(e=>"lf"===e?"\n":"crlf"===e?"\r\n":(S().error(`Invalid end of line character: expected "lf" or "crlf" but got "${e}".`),"\n"))(t)),ge=e=>{const t=m(e);if(t||ie(e)){const n=ae(e);if(n)return{isDir:t,path:n};console.error(`[ERROR] Cannot resolve "${e}".`)}return null},we=(e,n,r)=>{const{adjustLineEndingOnSave:i,lineEnding:o}=r,{encoding:a,isBom:s}=r.encoding,l=t().extname(e)||".md";i&&(n=me(n,o));const c=ce().encode(n,a,{addBOM:s});return se(e,c,l,void 0)},be=async(e,n,r=!0,i=2)=>{let o=await u().readFile(t().resolve(e));const a=((e,t)=>{let n="utf8";for(const[t,n]of Object.entries(pe))if(fe(e,n))return{encoding:t,isBom:!0};return t&&(n=ue()(e),n=he[n]?he[n]:n.toLowerCase().replace(/-_/g,"")),{encoding:n,isBom:!1}})(o,r);if(!ce().encodingExists(a.encoding))throw new Error(`"${a.encoding}" encoding is not supported.`);let s=ce().decode(o,a.encoding);const l=B.test(s),c=j.test(s),d=l&&c;let h=n;l&&!c?h="lf":c&&!l&&(h="crlf");let p=!1;if((d||!l&&!c||"lf"!==h)&&(p="lf"!==h,s=me(s,"lf")),2===i)if(s){const e=s.length-1;i=e>=1&&"\n"===s[e]&&"\n"===s[e-1]?2:"\n"===s[e]?1:0}else i=3;return{markdown:s,filename:t().basename(e),pathname:e,encoding:a,lineEnding:h,adjustLineEndingOnSave:p,trimTrailingNewline:i,isMixedLineEndings:d}};var Ee=n(2361),ye=n.n(Ee);const _e=require("native-keymap");let ve=null;const Ce=()=>(ve={layout:(0,_e.getCurrentKeyboardLayout)(),keymap:(0,_e.getKeyMap)()},ve),Ae=()=>ve||Ce(),Te="onDidChangeKeyboardLayout";class Ie extends(ye()){constructor(){super(),this._isSubscribed=!1,this._emitTimer=null}addListener(e){this._ensureNativeListener(),this.on(Te,e)}removeListener(e){this.removeListener(Te,e)}_ensureNativeListener(){this._isSubscribed||(this._isSubscribed=!0,(0,_e.onDidChangeKeyboardLayout)((()=>{clearTimeout(this._emitTimer),this._emitTimer=setTimeout((()=>{this.emit(Te,Ce()),this._emitTimer=null}),150)})))}}const Oe=new Ie,Re=e=>{i.ipcMain.emit("set-user-preference",{theme:e})},Se=Object.freeze({EDIT_COPY:"edit.copy",EDIT_COPY_AS_HTML:"edit.copy-as-html",EDIT_COPY_AS_MARKDOWN:"edit.copy-as-markdown",EDIT_CREATE_PARAGRAPH:"edit.create-paragraph",EDIT_CUT:"edit.cut",EDIT_DELETE_PARAGRAPH:"edit.delete-paragraph",EDIT_DUPLICATE:"edit.duplicate",EDIT_FIND:"edit.find",EDIT_FIND_IN_FOLDER:"edit.find-in-folder",EDIT_FIND_NEXT:"edit.find-next",EDIT_FIND_PREVIOUS:"edit.find-previous",EDIT_PASTE:"edit.paste",EDIT_PASTE_AS_PLAINTEXT:"edit.paste-as-plaintext",EDIT_REDO:"edit.redo",EDIT_REPLACE:"edit.replace",EDIT_SCREENSHOT:"edit.screenshot",EDIT_SELECT_ALL:"edit.select-all",EDIT_UNDO:"edit.undo",FILE_CHECK_UPDATE:"file.check-update",FILE_CLOSE_TAB:"file.close-tab",FILE_CLOSE_WINDOW:"file.close-window",FILE_EXPORT_FILE:"file.export-file",FILE_IMPORT_FILE:"file.import-file",FILE_MOVE_FILE:"file.move-file",FILE_NEW_FILE:"file.new-window",FILE_NEW_TAB:"file.new-tab",FILE_OPEN_FILE:"file.open-file",FILE_OPEN_FOLDER:"file.open-folder",FILE_PREFERENCES:"file.preferences",FILE_PRINT:"file.print",FILE_QUICK_OPEN:"file.quick-open",FILE_QUIT:"file.quit",FILE_RENAME_FILE:"file.rename-file",FILE_SAVE:"file.save",FILE_SAVE_AS:"file.save-as",FORMAT_CLEAR_FORMAT:"format.clear-format",FORMAT_EMPHASIS:"format.emphasis",FORMAT_HIGHLIGHT:"format.highlight",FORMAT_HYPERLINK:"format.hyperlink",FORMAT_IMAGE:"format.image",FORMAT_INLINE_CODE:"format.inline-code",FORMAT_INLINE_MATH:"format.inline-math",FORMAT_STRIKE:"format.strike",FORMAT_STRONG:"format.strong",FORMAT_SUBSCRIPT:"format.subscript",FORMAT_SUPERSCRIPT:"format.superscript",FORMAT_UNDERLINE:"format.underline",MT_HIDE:"mt.hide",MT_HIDE_OTHERS:"mt.hide-others",PARAGRAPH_BULLET_LIST:"paragraph.bullet-list",PARAGRAPH_CODE_FENCE:"paragraph.code-fence",PARAGRAPH_DEGRADE_HEADING:"paragraph.degrade-heading",PARAGRAPH_FRONT_MATTER:"paragraph.front-matter",PARAGRAPH_HEADING_1:"paragraph.heading-1",PARAGRAPH_HEADING_2:"paragraph.heading-2",PARAGRAPH_HEADING_3:"paragraph.heading-3",PARAGRAPH_HEADING_4:"paragraph.heading-4",PARAGRAPH_HEADING_5:"paragraph.heading-5",PARAGRAPH_HEADING_6:"paragraph.heading-6",PARAGRAPH_HORIZONTAL_LINE:"paragraph.horizontal-line",PARAGRAPH_HTML_BLOCK:"paragraph.html-block",PARAGRAPH_LOOSE_LIST_ITEM:"paragraph.loose-list-item",PARAGRAPH_MATH_FORMULA:"paragraph.math-formula",PARAGRAPH_ORDERED_LIST:"paragraph.order-list",PARAGRAPH_PARAGRAPH:"paragraph.paragraph",PARAGRAPH_QUOTE_BLOCK:"paragraph.quote-block",PARAGRAPH_TABLE:"paragraph.table",PARAGRAPH_TASK_LIST:"paragraph.task-list",PARAGRAPH_INCREASE_HEADING:"paragraph.upgrade-heading",TABS_CYCLE_BACKWARD:"tabs.cycle-backward",TABS_CYCLE_FORWARD:"tabs.cycle-forward",TABS_SWITCH_TO_EIGHTH:"tabs.switch-to-eighth",TABS_SWITCH_TO_FIFTH:"tabs.switch-to-fifth",TABS_SWITCH_TO_FIRST:"tabs.switch-to-first",TABS_SWITCH_TO_FOURTH:"tabs.switch-to-fourth",TABS_SWITCH_TO_LEFT:"tabs.switch-to-left",TABS_SWITCH_TO_NINTH:"tabs.switch-to-ninth",TABS_SWITCH_TO_RIGHT:"tabs.switch-to-right",TABS_SWITCH_TO_SECOND:"tabs.switch-to-second",TABS_SWITCH_TO_SEVENTH:"tabs.switch-to-seventh",TABS_SWITCH_TO_SIXTH:"tabs.switch-to-sixth",TABS_SWITCH_TO_TENTH:"tabs.switch-to-tenth",TABS_SWITCH_TO_THIRD:"tabs.switch-to-third",VIEW_COMMAND_PALETTE:"view.command-palette",VIEW_DEV_RELOAD:"view.dev-reload",VIEW_FOCUS_MODE:"view.focus-mode",VIEW_FORCE_RELOAD_IMAGES:"view.reload-images",VIEW_SOURCE_CODE_MODE:"view.source-code-mode",VIEW_TOGGLE_DEV_TOOLS:"view.toggle-dev-tools",VIEW_TOGGLE_SIDEBAR:"view.toggle-sidebar",VIEW_TOGGLE_TABBAR:"view.toggle-tabbar",VIEW_TOGGLE_TOC:"view.toggle-toc",VIEW_TYPEWRITER_MODE:"view.typewriter-mode",WINDOW_MINIMIZE:"window.minimize",WINDOW_TOGGLE_ALWAYS_ON_TOP:"window.toggle-always-on-top",WINDOW_TOGGLE_FULL_SCREEN:"window.toggle-full-screen",WINDOW_ZOOM_IN:"window.zoom-in",WINDOW_ZOOM_OUT:"window.zoom-out"}),ke=e=>{e&&e.webContents&&e.webContents.send("mt::execute-command-by-id","file.quick-open")},De=e=>{e&&e.webContents&&e.webContents.send("mt::tabs-cycle-left")},Pe=e=>{e&&e.webContents&&e.webContents.send("mt::tabs-cycle-right")},Me=(e,t)=>{e&&e.webContents&&e.webContents.send("mt::switch-tab-by-index",t)},Ne=Se,xe=new class{constructor(){this._commands=new Map}add(e,t){const{_commands:n}=this;if(n.has(e))throw new Error(`Command with id="${e}" already exists.`);n.set(e,t)}remove(e){return this._commands.delete(e)}has(e){return this._commands.has(e)}execute(e,...t){const n=this._commands.get(e);if(!n)throw new Error(`No command found with id="${e}".`);return n(...t)}__verifyDefaultCommands(){const{_commands:e}=this;Object.keys(Ne).forEach((t=>{const n=Ne[t];e.has(n)||console.error(`[DEBUG] Default command with id="${n}" isn't available!`)}))}},Fe=require("fuzzaldrin"),Le=new Map,Ue=new Map,$e=(e,n,r)=>{const i=new RegExp("("+ne.join("|")+")$","i"),o=e.map((e=>{const r=t().join(n,e);let o="";return f(r)?o="directory":g(r)&&i.test(e)&&(o="image"),{file:e,type:o}})).filter((({file:e,type:t})=>!F.includes(e)&&("directory"===t||"image"===t)));if(Le.set(n,o),void 0!==r)return(0,Fe.filter)(o,r,{key:"file"})};i.ipcMain.on("mt::ask-for-image-auto-path",((e,{pathname:n,src:r,id:o})=>{const a=i.BrowserWindow.fromWebContents(e.sender);if(!r||"string"!=typeof r)return void a.webContents.send(`mt::response-of-image-path-${o}`,[]);if(r.endsWith("/")||r.endsWith("\\")||r.endsWith("."))return a.webContents.send(`mt::response-of-image-path-${o}`,[]);const s=t().isAbsolute(r)?r:t().join(t().dirname(n),r);((e,t)=>{let n=[];return Le.has(e)?(n=(0,Fe.filter)(Le.get(e),t,{key:"file"}),Promise.resolve(n)):new Promise(((r,i)=>{ee().readdir(e,((o,a)=>{o?i(o):(n=$e(a,e,t),(e=>{if(Ue.has(e))return;const t=ee().watch(e,((t,n)=>{"rename"===t&&(e=>{ee().readdir(e,((t,n)=>{t?S().error("imagePathAutoComplement::rebuild:",t):$e(n,e)}))})(e)}));Ue.set(e,t)})(e),r(n))}))}))})(t().dirname(s),t().basename(s)).then((e=>a.webContents.send(`mt::response-of-image-path-${o}`,e))).catch((e=>(S().error(e),a.webContents.send(`mt::response-of-image-path-${o}`,[]))))}));const Be=e=>{et(e,"undo")},je=e=>{et(e,"redo")},We=e=>{et(e,"copyAsMarkdown")},He=e=>{et(e,"copyAsHtml")},Ge=e=>{et(e,"pasteAsPlainText")},qe=e=>{et(e,"selectAll")},Ve=e=>{et(e,"duplicate")},ze=e=>{et(e,"createParagraph")},Ke=e=>{et(e,"deleteParagraph")},Xe=e=>{et(e,"find")},Ye=e=>{et(e,"findNext")},Je=e=>{et(e,"findPrev")},Qe=e=>{et(e,"undo")},Ze=e=>{et(e,"findInFolder")},et=(e,t)=>{e&&e.webContents&&e.webContents.send("mt::editor-edit-action",t)},tt=e=>{e&&e.webContents.cut()},nt=e=>{e&&e.webContents.copy()},rt=e=>{e&&e.webContents.paste()},it=e=>{i.ipcMain.emit("screen-capture",e)},ot=(e,t)=>{e&&e.webContents&&e.webContents.send("mt::set-line-ending",t)};function at(e){return{label:"&Edit",submenu:[{label:"Undo",accelerator:e.getAccelerator(Ne.EDIT_UNDO),click:(e,t)=>{Be(t)}},{label:"Redo",accelerator:e.getAccelerator(Ne.EDIT_REDO),click:(e,t)=>{je(t)}},{type:"separator"},{label:"Cut",accelerator:e.getAccelerator(Ne.EDIT_CUT),click(e,t){tt(t)}},{label:"Copy",accelerator:e.getAccelerator(Ne.EDIT_COPY),click(e,t){nt(t)}},{label:"Paste",accelerator:e.getAccelerator(Ne.EDIT_PASTE),click(e,t){rt(t)}},{type:"separator"},{label:"Copy as Markdown",accelerator:e.getAccelerator(Ne.EDIT_COPY_AS_MARKDOWN),click(e,t){We(t)}},{label:"Copy as HTML",accelerator:e.getAccelerator(Ne.EDIT_COPY_AS_HTML),click(e,t){He(t)}},{label:"Paste as Plain Text",accelerator:e.getAccelerator(Ne.EDIT_PASTE_AS_PLAINTEXT),click(e,t){Ge(t)}},{type:"separator"},{label:"Select All",accelerator:e.getAccelerator(Ne.EDIT_SELECT_ALL),click(e,t){qe(t)}},{type:"separator"},{label:"Duplicate",accelerator:e.getAccelerator(Ne.EDIT_DUPLICATE),click(e,t){Ve(t)}},{label:"Create Paragraph",accelerator:e.getAccelerator(Ne.EDIT_CREATE_PARAGRAPH),click(e,t){ze(t)}},{label:"Delete Paragraph",accelerator:e.getAccelerator(Ne.EDIT_DELETE_PARAGRAPH),click(e,t){Ke(t)}},{type:"separator"},{label:"Find",accelerator:e.getAccelerator(Ne.EDIT_FIND),click(e,t){Xe(t)}},{label:"Find Next",accelerator:e.getAccelerator(Ne.EDIT_FIND_NEXT),click(e,t){Ye(t)}},{label:"Find Previous",accelerator:e.getAccelerator(Ne.EDIT_FIND_PREVIOUS),click(e,t){Je(t)}},{label:"Replace",accelerator:e.getAccelerator(Ne.EDIT_REPLACE),click(e,t){Qe(t)}},{type:"separator"},{label:"Find in Folder",accelerator:e.getAccelerator(Ne.EDIT_FIND_IN_FOLDER),click(e,t){Ze(t)}},{type:"separator"},{label:"Screenshot",id:"screenshot",visible:k,accelerator:e.getAccelerator(Ne.EDIT_SCREENSHOT),click(e,t){it(t)}},{type:"separator"},{label:"Line Ending",submenu:[{id:"crlfLineEndingMenuEntry",label:"Carriage return and line feed (CRLF)",type:"radio",click(e,t){ot(t,"crlf")}},{id:"lfLineEndingMenuEntry",label:"Line feed (LF)",type:"radio",click(e,t){ot(t,"lf")}}]}]}}function st(e){return{label:"Edit",submenu:[{label:"Cut",accelerator:e.getAccelerator("edit.cut"),role:"cut"},{label:"Copy",accelerator:e.getAccelerator("edit.copy"),role:"copy"},{label:"Paste",accelerator:e.getAccelerator("edit.paste"),role:"paste"},{type:"separator"},{label:"Select All",accelerator:e.getAccelerator("edit.select-all"),role:"selectAll"}]}}var lt=n(7430);let ct=!1,dt=null;lt.autoUpdater.autoDownload=!1,lt.autoUpdater.on("error",(e=>{dt&&dt.webContents.send("mt::UPDATE_ERROR",null===e?"Error: unknown":(e.message||e).toString())})),lt.autoUpdater.on("update-available",(()=>{dt&&dt.webContents.send("mt::UPDATE_AVAILABLE","Found an update, do you want download and install now?"),ct=!1})),lt.autoUpdater.on("update-not-available",(()=>{dt&&dt.webContents.send("mt::UPDATE_NOT_AVAILABLE","Current version is up-to-date."),ct=!1})),lt.autoUpdater.on("update-downloaded",(()=>{dt&&dt.webContents.send("mt::UPDATE_DOWNLOADED","Update downloaded, application will be quit for update..."),setImmediate((()=>lt.autoUpdater.quitAndInstall()))})),i.ipcMain.on("mt::NEED_UPDATE",((e,{needUpdate:t})=>{t?lt.autoUpdater.downloadUpdate():ct=!1})),i.ipcMain.on("mt::check-for-update",(e=>{const t=i.BrowserWindow.fromWebContents(e.sender);ht(t)}));const ut=()=>{i.ipcMain.emit("app-create-settings-window")},ht=e=>{ct||(ct=!0,dt=e,lt.autoUpdater.checkForUpdates())},pt=()=>{k&&i.Menu.sendActionToFirstResponder("hide:")},ft=()=>{k&&i.Menu.sendActionToFirstResponder("hideOtherApplications:")},mt="typewriterModeMenuItem",gt="focusModeMenuItem",wt=(e,t)=>{e&&e.webContents&&e.webContents.send("mt::toggle-view-mode-entry",t)},bt=(e,t,n)=>{e&&e.webContents&&e.webContents.send("mt::set-view-layout",{[t]:n})},Et=(e,t)=>{e&&e.webContents&&e.webContents.send("mt::toggle-view-layout-entry",t)},yt=e=>{e&&global.MARKTEXT_DEBUG&&e.webContents.toggleDevTools()},_t=e=>{e&&global.MARKTEXT_DEBUG&&i.ipcMain.emit("window-reload-by-id",e.id)},vt=e=>{e&&e.webContents&&e.webContents.send("mt::show-command-palette")},Ct=e=>{wt(e,"focus")},At=e=>{wt(e,"sourceCode")},Tt=e=>{Et(e,"showSideBar")},It=e=>{Et(e,"showTabBar")},Ot=e=>{bt(e,"rightColumn","toc")},Rt=e=>{wt(e,"typewriter")},St=e=>{e&&e.webContents&&e.webContents.send("mt::invalidate-image-cache")},kt=require("command-exists");var Dt=n.n(kt);const Pt="pandoc",Mt=(e,t,...n)=>{const r=Nt()?process.env.MARKTEXT_PANDOC:Pt,i=["-s",e,"-t",t].concat(n),o=()=>new Promise(((e,t)=>{const n=(0,Y.spawn)(r,i);n.on("error",t);let o="";n.stdout.on("data",(e=>{o+=e.toString()})),n.stdout.on("end",(()=>e(o))),n.stdout.on("error",t),n.stdin.end()}));return o.stream=e=>{const t=(0,Y.spawn)(r,i);return e.pipe(t.stdin),t.stdout},o};Mt.exists=()=>!!Nt()||Dt().sync(Pt);const Nt=()=>!!process.env.MARKTEXT_PANDOC&&w(process.env.MARKTEXT_PANDOC),xt=Mt,Ft=e=>"pdf"===e?[{name:"Portable Document Format",extensions:["pdf"]}]:"styledHtml"===e?[{name:"Hypertext Markup Language",extensions:["html"]}]:void 0,Lt=async(e,{id:n,filename:r,markdown:o,pathname:a,options:s,defaultPath:l})=>{const c=i.BrowserWindow.fromWebContents(e.sender);let d=A(o);d||(d=r||"Untitled");const u=!!a;let h=a;if(!h){const{filePath:e,canceled:n}=await i.dialog.showSaveDialog(c,{defaultPath:t().join(l||T("documents"),`${d}.md`)});e&&!n&&(h=e)}if(!h)return Promise.resolve();h=t().resolve(h);const p=t().extname(h)||".md";return h=h.endsWith(p)?h:h+=p,we(h,o,s).then((()=>{if(u)i.ipcMain.emit("window-file-saved",c.id,h),c.webContents.send("mt::tab-saved",n);else{i.ipcMain.emit("window-add-file-path",c.id,h),i.ipcMain.emit("menu-add-recently-used",h);const e=t().basename(h);c.webContents.send("mt::set-pathname",{id:n,pathname:h,filename:e})}return n})).catch((e=>{S().error("Error while saving:",e),c.webContents.send("mt::tab-save-failure",n,e.message)}))},Ut=async(e,t)=>{const{response:n}=await i.dialog.showMessageBox(e,{type:"warning",buttons:["Save","Cancel","Don't save"],defaultId:0,message:`Do you want to save the changes you made to ${t.length} ${1===t.length?"file":"files"}?\n\n${t.map((e=>e.filename)).join("\n")}`,detail:"Your changes will be lost if you don't save them.",cancelId:1,noLink:!0});switch(n){case 2:return{needSave:!1};case 0:return new Promise(((e,t)=>{setTimeout((()=>{e({needSave:!0})}))}));default:return null}},$t=e=>e.webContents.send("mt::pandoc-not-exists",{title:"Import Warning",type:"warning",message:"Install pandoc before you want to import files.",time:1e4}),Bt=async(e,t)=>{try{const n=xt(t,"markdown"),r=await n();i.ipcMain.emit("app-open-markdown-by-id",e,r)}catch(e){S().error("Error while converting file:",e)}},jt=e=>{e.webContents.send("mt::print-service-clearup")};i.ipcMain.on("mt::save-tabs",((e,t)=>{Promise.all(t.map((t=>Lt(e,t)))).catch(S().error)})),i.ipcMain.on("mt::save-and-close-tabs",(async(e,t)=>{const n=i.BrowserWindow.fromWebContents(e.sender),r=await Ut(n,t);if(!r)return;const{needSave:o}=r;if(o)Promise.all(t.map((t=>Lt(e,t)))).then((e=>{const t=e.filter((e=>null!=e));n.webContents.send("mt::force-close-tabs-by-id",t)})).catch((e=>{S().error("Error while save all:",e)}));else{const e=t.map((e=>e.id));n.webContents.send("mt::force-close-tabs-by-id",e)}})),i.ipcMain.on("mt::response-file-save-as",(async(e,{id:n,filename:r,markdown:o,pathname:a,options:s,defaultPath:l})=>{const c=i.BrowserWindow.fromWebContents(e.sender);let d=A(o);d||(d=r||"Untitled");const u=!!a;let{filePath:h,canceled:p}=await i.dialog.showSaveDialog(c,{defaultPath:a||t().join(l||T("documents"),`${d}.md`)});h&&!p&&(h=t().resolve(h),we(h,o,s).then((()=>{if(u)if(a!==h){i.ipcMain.emit("window-change-file-path",c.id,h,a);const e=t().basename(h);c.webContents.send("mt::set-pathname",{id:n,pathname:h,filename:e})}else i.ipcMain.emit("window-file-saved",c.id,h),c.webContents.send("mt::tab-saved",n);else{i.ipcMain.emit("window-add-file-path",c.id,h),i.ipcMain.emit("menu-add-recently-used",h);const e=t().basename(h);c.webContents.send("mt::set-pathname",{id:n,pathname:h,filename:e})}})).catch((e=>{S().error("Error while save as:",e),c.webContents.send("mt::tab-save-failure",n,e.message)})))})),i.ipcMain.on("mt::close-window-confirm",(async(e,t)=>{const n=i.BrowserWindow.fromWebContents(e.sender),r=await Ut(n,t);if(!r)return;const{needSave:o}=r;o?Promise.all(t.map((t=>Lt(e,t)))).then((()=>{i.ipcMain.emit("window-close-by-id",n.id)})).catch((e=>{S().error("Error while saving before quit:",e),i.dialog.showMessageBox(n,{type:"error",buttons:["Close","Keep It Open"],message:"Failure while saving files",detail:e.message}).then((({response:e})=>{n.id&&0===e&&i.ipcMain.emit("window-close-by-id",n.id)}))})):i.ipcMain.emit("window-close-by-id",n.id)})),i.ipcMain.on("mt::response-file-save",Lt),i.ipcMain.on("mt::response-export",(async(e,{type:n,content:r,pathname:o,title:a,pageOptions:s})=>{const l=i.BrowserWindow.fromWebContents(e.sender),c=L[n],d=o?t().dirname(o):T("documents");let u=o?t().basename(o,".md"):a;u||(u="Untitled");const h=t().join(d,`${u}${c}`),{filePath:p,canceled:f}=await i.dialog.showSaveDialog(l,{defaultPath:h,filters:Ft(n)});if(p&&!f)try{if("pdf"===n){const e={printBackground:!0};Object.assign(e,(e=>{if(!e)return{};const{pageSize:t,pageSizeWidth:n,pageSizeHeight:r,isLandscape:i}=e;return"custom"===t&&n&&r?{pageSize:{height:1e3*r,width:1e3*n},landscape:!!i}:{pageSize:t,landscape:!!i}})(s));const t=await l.webContents.printToPDF(e);jt(l),await se(p,t,c,"binary")}else{if(!r)throw new Error("No HTML content found.");await se(p,r,c,"utf8")}l.webContents.send("mt::export-success",{type:n,filePath:p})}catch(e){S().error("Error while exporting:",e);const t=e.message||`Error happened when export ${p}`;l.webContents.send("mt::show-notification",{title:"Export failure",type:"error",message:t})}else"pdf"===n&&jt(l)})),i.ipcMain.on("mt::response-print",(e=>{const t=i.BrowserWindow.fromWebContents(e.sender);t.webContents.print({printBackground:!0},(()=>{jt(t)}))})),i.ipcMain.on("mt::window::drop",(async(e,t)=>{const n=i.BrowserWindow.fromWebContents(e.sender);for(const e of t)if(ie(e))zt(n,e);else if(x.some((t=>e.endsWith(t)))){xt.exists()?Bt(n.id,e):$t(n);break}})),i.ipcMain.on("mt::rename",(async(e,{id:n,pathname:r,newPathname:o})=>{if(r===o)return;const a=i.BrowserWindow.fromWebContents(e.sender),s=()=>{c().rename(r,o,(s=>{s?S().error(`mt::rename: Cannot rename "${r}" to "${o}".\n${s.stack}`):(i.ipcMain.emit("window-change-file-path",a.id,o,r),e.sender.send("mt::set-pathname",{id:n,pathname:o,filename:t().basename(o)}))}))};if(await h(o)){const{response:e}=await i.dialog.showMessageBox(a,{type:"warning",buttons:["Replace","Cancel"],defaultId:1,message:`The file "${t().basename(o)}" already exists. Do you want to replace it?`,cancelId:1,noLink:!0});0===e&&s()}else s()})),i.ipcMain.on("mt::response-file-move-to",(async(e,{id:n,pathname:r})=>{const o=i.BrowserWindow.fromWebContents(e.sender),{filePath:a,canceled:s}=await i.dialog.showSaveDialog(o,{buttonLabel:"Move to",nameFieldLabel:"Filename:",defaultPath:r});a&&!s&&c().rename(r,a,(s=>{s?S().error(`mt::rename: Cannot rename "${r}" to "${a}".\n${s.stack}`):(i.ipcMain.emit("window-change-file-path",o.id,a,r),e.sender.send("mt::set-pathname",{id:n,pathname:a,filename:t().basename(a)}))}))})),i.ipcMain.on("mt::ask-for-open-project-in-sidebar",(async e=>{const t=i.BrowserWindow.fromWebContents(e.sender),{filePaths:n}=await i.dialog.showOpenDialog(t,{properties:["openDirectory","createDirectory"]});if(n&&n[0]){const e=ae(n[0]);i.ipcMain.emit("app-open-directory-by-id",t.id,e,!0)}})),i.ipcMain.on("mt::format-link-click",((e,{data:n,dirname:r})=>{if(!n||!n.href&&!n.text)return;const o=n.href||n.text;if(W.test(o))return void i.shell.openExternal(o);if(/^[a-z0-9]+:\/\//i.test(o))return;const a=n.href;if(!a)return;let s=null;if(t().isAbsolute(a)?s=a:r&&!t().isAbsolute(a)&&(s=t().join(r,a)),s)if(s=t().normalize(s),ie(s)){const t=i.BrowserWindow.fromWebContents(e.sender);zt(t,s)}else i.shell.openPath(s)})),i.ipcMain.on("mt::cmd-open-file",(e=>{const t=i.BrowserWindow.fromWebContents(e.sender);qt(t)})),i.ipcMain.on("mt::cmd-new-editor-window",(()=>{Xt()})),i.ipcMain.on("mt::cmd-open-folder",(e=>{const t=i.BrowserWindow.fromWebContents(e.sender);Vt(t)})),i.ipcMain.on("mt::cmd-close-window",(e=>{i.BrowserWindow.fromWebContents(e.sender).close()})),i.ipcMain.on("mt::cmd-import-file",(e=>{const t=i.BrowserWindow.fromWebContents(e.sender);Ht(t)}));const Wt=(e,t)=>{e&&e.webContents&&e.webContents.send("mt::show-export-dialog",t)},Ht=async e=>{if(!xt.exists())return $t(e);const{filePaths:t}=await i.dialog.showOpenDialog(e,{properties:["openFile"],filters:[{name:"All Files",extensions:x}]});t&&t[0]&&Bt(e.id,t[0])},Gt=e=>{e&&e.webContents.send("mt::show-export-dialog","print")},qt=async e=>{const{filePaths:t}=await i.dialog.showOpenDialog(e,{properties:["openFile","multiSelections"],filters:[{name:"Markdown document",extensions:te}]});Array.isArray(t)&&t.length>0&&i.ipcMain.emit("app-open-files-by-id",e.id,t)},Vt=async e=>{const{filePaths:t}=await i.dialog.showOpenDialog(e,{properties:["openDirectory","createDirectory"]});t&&t[0]&&zt(e,t[0])},zt=(e,t)=>{const n=ae(t);g(n)?i.ipcMain.emit("app-open-file-by-id",e.id,n):f(n)?i.ipcMain.emit("app-open-directory-by-id",e.id,n):console.error(`[ERROR] Cannot open unknown file: "${n}"`)},Kt=e=>{e&&e.webContents&&(e.webContents.send("mt::new-untitled-tab"),(e=>{bt(e,"showTabBar",!0)})(e))},Xt=()=>{i.ipcMain.emit("app-create-editor-window")},Yt=e=>{e&&e.webContents&&e.webContents.send("mt::editor-close-tab")},Jt=e=>{e&&e.close()},Qt=e=>{e&&e.webContents&&e.webContents.send("mt::editor-ask-file-save")},Zt=e=>{e&&e.webContents&&e.webContents.send("mt::editor-ask-file-save-as")},en=e=>{e&&e.webContents&&e.webContents.send("mt::editor-move-file")},tn=e=>{e&&e.webContents&&e.webContents.send("mt::editor-rename-file")};function nn(e,t,n){const{autoSave:r}=t.getAll(),o={label:"&File",submenu:[{label:"New Tab",accelerator:e.getAccelerator("file.new-tab"),click(e,t){Kt(t)}},{label:"New Window",accelerator:e.getAccelerator("file.new-window"),click(e,t){Xt()}},{type:"separator"},{label:"Open File...",accelerator:e.getAccelerator("file.open-file"),click(e,t){qt(t)}},{label:"Open Folder...",accelerator:e.getAccelerator("file.open-folder"),click(e,t){Vt(t)}}]};if(k)o.submenu.push({role:"recentdocuments",submenu:[{role:"clearrecentdocuments"}]});else{const e={label:"Open Recent",submenu:[]};for(const t of n)e.submenu.push({label:t,click(e,t){zt(t,e.label)}});e.submenu.push({type:"separator",visible:n.length>0},{label:"Clear Recently Used",enabled:n.length>0,click(e,t){i.ipcMain.emit("menu-clear-recently-used")}}),o.submenu.push(e)}return o.submenu.push({type:"separator"},{label:"Save",accelerator:e.getAccelerator("file.save"),click(e,t){Qt(t)}},{label:"Save As...",accelerator:e.getAccelerator("file.save-as"),click(e,t){Zt(t)}},{label:"Auto Save",type:"checkbox",checked:r,id:"autoSaveMenuItem",click(e,t){((e,t)=>{const{checked:n}=e;i.ipcMain.emit("set-user-preference",{autoSave:n})})(e)}},{type:"separator"},{label:"Move To...",accelerator:e.getAccelerator("file.move-file"),click(e,t){en(t)}},{label:"Rename...",accelerator:e.getAccelerator("file.rename-file"),click(e,t){tn(t)}},{type:"separator"},{label:"Import...",click(e,t){Ht(t)}},{label:"Export",submenu:[{label:"HTML",click(e,t){Wt(t,"styledHtml")}},{label:"PDF",click(e,t){Wt(t,"pdf")}}]},{label:"Print",accelerator:e.getAccelerator("file.print"),click(e,t){Gt(t)}},{type:"separator",visible:!k},{label:"Preferences...",accelerator:e.getAccelerator("file.preferences"),visible:!k,click(){ut()}},{type:"separator"},{label:"Close Tab",accelerator:e.getAccelerator("file.close-tab"),click(e,t){Yt(t)}},{label:"Close Window",accelerator:e.getAccelerator("file.close-window"),click(e,t){Jt(t)}},{type:"separator",visible:!k},{label:"Quit",accelerator:e.getAccelerator("file.quit"),visible:!k,click:i.app.quit}),o}const rn=e=>{e&&e.webContents&&e.webContents.send("mt::about-dialog")};function on(){const e={label:"&Help",role:"help",submenu:[{label:"Quick Start...",click(){i.shell.openExternal("https://github.com/marktext/marktext/blob/master/docs/README.md")}},{label:"Markdown Reference...",click(){i.shell.openExternal("https://github.com/marktext/marktext/blob/master/docs/MARKDOWN_SYNTAX.md")}},{label:"Changelog...",click(){i.shell.openExternal("https://github.com/marktext/marktext/blob/master/.github/CHANGELOG.md")}},{type:"separator"},{label:"Donate via Open Collective...",click(e,t){i.shell.openExternal("https://opencollective.com/marktext")}},{label:"Feedback via Twitter...",click(e,t){((e,t)=>{e&&e.webContents&&e.webContents.send("mt::tweet","twitter")})(t)}},{label:"Report Issue or Request Feature...",click(){i.shell.openExternal("https://github.com/marktext/marktext/issues")}},{type:"separator"},{label:"Website...",click(){i.shell.openExternal("https://github.com/marktext/marktext")}},{label:"Watch on GitHub...",click(){i.shell.openExternal("https://github.com/marktext/marktext")}},{label:"Follow us on Github...",click(){i.shell.openExternal("https://github.com/Jocs")}},{label:"Follow us on Twitter...",click(){i.shell.openExternal("https://twitter.com/marktextapp")}},{type:"separator"},{label:"Developer Tools",accelerator:"darwin"===process.platform?"Alt+Command+I":"Ctrl+Shift+I",click(e,t){t&&t.webContents.toggleDevTools()}},{label:"License...",click(){i.shell.openExternal("https://github.com/marktext/marktext/blob/master/LICENSE")}}]};return g(t().join(process.resourcesPath,"app-update.yml"))&&(process.env.APPIMAGE||"win32"===process.platform&&g(t().join(process.resourcesPath,"md.ico")))&&e.submenu.push({type:"separator"},{label:"Check for updates...",click(e,t){ht(t)}}),"darwin"!==process.platform&&e.submenu.push({type:"separator"},{label:"About MarkText...",click(e,t){rn(t)}}),e}function an(e){return{label:"MarkText",submenu:[{label:"About MarkText",click(e,t){rn(t)}},{label:"Check for updates...",click(e,t){ht(t)}},{label:"Preferences",accelerator:e.getAccelerator("file.preferences"),click(){ut()}},{type:"separator"},{label:"Services",role:"services",submenu:[]},{type:"separator"},{label:"Hide MarkText",accelerator:e.getAccelerator("mt.hide"),click(){pt()}},{label:"Hide Others",accelerator:e.getAccelerator("mt.hide-others"),click(){ft()}},{label:"Show All",click(){k&&i.Menu.sendActionToFirstResponder("unhideAllApplications:")}},{type:"separator"},{label:"Quit MarkText",accelerator:e.getAccelerator("file.quit"),click:i.app.quit}]}}function sn(e){const t={label:"&View",submenu:[{label:"Command Palette...",accelerator:e.getAccelerator("view.command-palette"),click(e,t){vt(t)}},{type:"separator"},{id:"sourceCodeModeMenuItem",label:"Source Code Mode",accelerator:e.getAccelerator("view.source-code-mode"),type:"checkbox",checked:!1,click(e,t){At(t)}},{id:"typewriterModeMenuItem",label:"Typewriter Mode",accelerator:e.getAccelerator("view.typewriter-mode"),type:"checkbox",checked:!1,click(e,t){Rt(t)}},{id:"focusModeMenuItem",label:"Focus Mode",accelerator:e.getAccelerator("view.focus-mode"),type:"checkbox",checked:!1,click(e,t){Ct(t)}},{type:"separator"},{label:"Show Sidebar",id:"sideBarMenuItem",accelerator:e.getAccelerator("view.toggle-sidebar"),type:"checkbox",checked:!1,click(e,t){Tt(t)}},{label:"Show Tab Bar",id:"tabBarMenuItem",accelerator:e.getAccelerator("view.toggle-tabbar"),type:"checkbox",checked:!1,click(e,t){It(t)}},{label:"Toggle Table of Contents",id:"tocMenuItem",accelerator:e.getAccelerator("view.toggle-toc"),click(e,t){Ot(t)}},{label:"Reload Images",accelerator:e.getAccelerator("view.reload-images"),click(e,t){St(t)}}]};return global.MARKTEXT_DEBUG&&(t.submenu.push({type:"separator"}),t.submenu.push({label:"Show Developer Tools",accelerator:e.getAccelerator("view.toggle-dev-tools"),click(e,t){yt(t)}}),t.submenu.push({label:"Reload window",accelerator:e.getAccelerator("view.dev-reload"),click(e,t){_t(t)}})),t}const ln=e=>{const{webContents:t}=e,n=t.getZoomFactor();t.send("mt::window-zoom",Math.min(2,n+.125))},cn=e=>{const{webContents:t}=e,n=t.getZoomFactor();t.send("mt::window-zoom",Math.max(.5,n-.125))},dn=e=>{e&&(k?i.Menu.sendActionToFirstResponder("performMiniaturize:"):e.minimize())},un=e=>{e&&i.ipcMain.emit("window-toggle-always-on-top",e)},hn=e=>{e&&e.setFullScreen(!e.isFullScreen())};function pn(e){const t={label:"&Window",role:"window",submenu:[{label:"Minimize",accelerator:e.getAccelerator("window.minimize"),click(e,t){dn(t)}},{id:"alwaysOnTopMenuItem",label:"Always on Top",type:"checkbox",accelerator:e.getAccelerator("window.toggle-always-on-top"),click(e,t){un(t)}},{type:"separator"},{label:"Zoom In",accelerator:e.getAccelerator("window.zoom-in"),click(e,t){ln(t)}},{label:"Zoom Out",accelerator:e.getAccelerator("window.zoom-out"),click(e,t){cn(t)}},{type:"separator"},{label:"Show in Full Screen",accelerator:e.getAccelerator("window.toggle-full-screen"),click(e,t){t&&hn(t)}}]};return k&&t.submenu.push({label:"Bring All to Front",click(){i.Menu.sendActionToFirstResponder("arrangeInFront:")}}),t}const fn=["heading1MenuItem","heading2MenuItem","heading3MenuItem","heading4MenuItem","heading5MenuItem","heading6MenuItem","upgradeHeadingMenuItem","degradeHeadingMenuItem","tableMenuItem","hyperlinkMenuItem","imageMenuItem"],mn=Object.freeze({heading1MenuItem:"h1",heading2MenuItem:"h2",heading3MenuItem:"h3",heading4MenuItem:"h4",heading5MenuItem:"h5",heading6MenuItem:"h6",tableMenuItem:"figure",codeFencesMenuItem:"pre",htmlBlockMenuItem:"html",mathBlockMenuItem:"multiplemath",quoteBlockMenuItem:"blockquote",orderListMenuItem:"ol",bulletListMenuItem:"ul",paragraphMenuItem:"p",horizontalLineMenuItem:"hr",frontMatterMenuItem:"frontmatter"}),gn=(e,t)=>{e&&e.webContents&&e.webContents.send("mt::editor-paragraph-action",{type:t})},wn=e=>{gn(e,"ul-bullet")},bn=e=>{gn(e,"pre")},En=e=>{gn(e,"degrade heading")},yn=e=>{gn(e,"front-matter")},_n=e=>{gn(e,"heading 1")},vn=e=>{gn(e,"heading 2")},Cn=e=>{gn(e,"heading 3")},An=e=>{gn(e,"heading 4")},Tn=e=>{gn(e,"heading 5")},In=e=>{gn(e,"heading 6")},On=e=>{gn(e,"hr")},Rn=e=>{gn(e,"html")},Sn=e=>{gn(e,"loose-list-item")},kn=e=>{gn(e,"mathblock")},Dn=e=>{gn(e,"ol-order")},Pn=e=>{gn(e,"paragraph")},Mn=e=>{gn(e,"blockquote")},Nn=e=>{gn(e,"table")},xn=e=>{gn(e,"ul-task")},Fn=e=>{gn(e,"upgrade heading")},Ln=(e,t)=>{e.getMenuItemById("paragraphMenuEntry").submenu.items.forEach((e=>e.enabled=t))},Un=(e,t,n)=>{e.getMenuItemById("paragraphMenuEntry").submenu.items.filter((e=>e.id&&t.includes(e.id))).forEach((e=>e.enabled=n))};function $n(e){return{id:"paragraphMenuEntry",label:"&Paragraph",submenu:[{id:"heading1MenuItem",label:"Heading 1",type:"checkbox",accelerator:e.getAccelerator("paragraph.heading-1"),click(e,t){_n(t)}},{id:"heading2MenuItem",label:"Heading 2",type:"checkbox",accelerator:e.getAccelerator("paragraph.heading-2"),click(e,t){vn(t)}},{id:"heading3MenuItem",label:"Heading 3",type:"checkbox",accelerator:e.getAccelerator("paragraph.heading-3"),click(e,t){Cn(t)}},{id:"heading4MenuItem",label:"Heading 4",type:"checkbox",accelerator:e.getAccelerator("paragraph.heading-4"),click(e,t){An(t)}},{id:"heading5MenuItem",label:"Heading 5",type:"checkbox",accelerator:e.getAccelerator("paragraph.heading-5"),click(e,t){Tn(t)}},{id:"heading6MenuItem",label:"Heading 6",type:"checkbox",accelerator:e.getAccelerator("paragraph.heading-6"),click(e,t){In(t)}},{type:"separator"},{id:"upgradeHeadingMenuItem",label:"Promote Heading",accelerator:e.getAccelerator("paragraph.upgrade-heading"),click(e,t){Fn(t)}},{id:"degradeHeadingMenuItem",label:"Demote Heading",accelerator:e.getAccelerator("paragraph.degrade-heading"),click(e,t){En(t)}},{type:"separator"},{id:"tableMenuItem",label:"Table",type:"checkbox",accelerator:e.getAccelerator("paragraph.table"),click(e,t){Nn(t)}},{id:"codeFencesMenuItem",label:"Code Fences",type:"checkbox",accelerator:e.getAccelerator("paragraph.code-fence"),click(e,t){bn(t)}},{id:"quoteBlockMenuItem",label:"Quote Block",type:"checkbox",accelerator:e.getAccelerator("paragraph.quote-block"),click(e,t){Mn(t)}},{id:"mathBlockMenuItem",label:"Math Block",type:"checkbox",accelerator:e.getAccelerator("paragraph.math-formula"),click(e,t){kn(t)}},{id:"htmlBlockMenuItem",label:"Html Block",type:"checkbox",accelerator:e.getAccelerator("paragraph.html-block"),click(e,t){Rn(t)}},{type:"separator"},{id:"orderListMenuItem",label:"Ordered List",type:"checkbox",accelerator:e.getAccelerator("paragraph.order-list"),click(e,t){Dn(t)}},{id:"bulletListMenuItem",label:"Bullet List",type:"checkbox",accelerator:e.getAccelerator("paragraph.bullet-list"),click(e,t){wn(t)}},{id:"taskListMenuItem",label:"Task List",type:"checkbox",accelerator:e.getAccelerator("paragraph.task-list"),click(e,t){xn(t)}},{type:"separator"},{id:"looseListItemMenuItem",label:"Loose List Item",type:"checkbox",accelerator:e.getAccelerator("paragraph.loose-list-item"),click(e,t){Sn(t)}},{type:"separator"},{id:"paragraphMenuItem",label:"Paragraph",type:"checkbox",accelerator:e.getAccelerator("paragraph.paragraph"),click(e,t){Pn(t)}},{id:"horizontalLineMenuItem",label:"Horizontal Rule",type:"checkbox",accelerator:e.getAccelerator("paragraph.horizontal-line"),click(e,t){On(t)}},{id:"frontMatterMenuItem",label:"Front Matter",type:"checkbox",accelerator:e.getAccelerator("paragraph.front-matter"),click(e,t){yn(t)}}]}}const Bn=Object.freeze({strongMenuItem:"strong",emphasisMenuItem:"em",inlineCodeMenuItem:"inline_code",strikeMenuItem:"del",hyperlinkMenuItem:"link",imageMenuItem:"image",inlineMathMenuItem:"inline_math"}),jn=(e,t)=>{e&&e.webContents&&e.webContents.send("mt::editor-format-action",{type:t})},Wn=e=>{jn(e,"clear")},Hn=e=>{jn(e,"em")},Gn=e=>{jn(e,"mark")},qn=e=>{jn(e,"link")},Vn=e=>{jn(e,"image")},zn=e=>{jn(e,"inline_code")},Kn=e=>{jn(e,"inline_math")},Xn=e=>{jn(e,"del")},Yn=e=>{jn(e,"strong")},Jn=e=>{jn(e,"sub")},Qn=e=>{jn(e,"sup")},Zn=e=>{jn(e,"u")};function er(e){return{id:"formatMenuItem",label:"F&ormat",submenu:[{id:"strongMenuItem",label:"Bold",type:"checkbox",accelerator:e.getAccelerator("format.strong"),click(e,t){Yn(t)}},{id:"emphasisMenuItem",label:"Italic",type:"checkbox",accelerator:e.getAccelerator("format.emphasis"),click(e,t){Hn(t)}},{id:"underlineMenuItem",label:"Underline",type:"checkbox",accelerator:e.getAccelerator("format.underline"),click(e,t){Zn(t)}},{type:"separator"},{id:"superscriptMenuItem",label:"Superscript",type:"checkbox",accelerator:e.getAccelerator("format.superscript"),click(e,t){Qn(t)}},{id:"subscriptMenuItem",label:"Subscript",type:"checkbox",accelerator:e.getAccelerator("format.subscript"),click(e,t){Jn(t)}},{id:"highlightMenuItem",label:"Highlight",type:"checkbox",accelerator:e.getAccelerator("format.highlight"),click(e,t){Gn(t)}},{type:"separator"},{id:"inlineCodeMenuItem",label:"Inline Code",type:"checkbox",accelerator:e.getAccelerator("format.inline-code"),click(e,t){zn(t)}},{id:"inlineMathMenuItem",label:"Inline Math",type:"checkbox",accelerator:e.getAccelerator("format.inline-math"),click(e,t){Kn(t)}},{type:"separator"},{id:"strikeMenuItem",label:"Strikethrough",type:"checkbox",accelerator:e.getAccelerator("format.strike"),click(e,t){Xn(t)}},{id:"hyperlinkMenuItem",label:"Hyperlink",type:"checkbox",accelerator:e.getAccelerator("format.hyperlink"),click(e,t){qn(t)}},{id:"imageMenuItem",label:"Image",type:"checkbox",accelerator:e.getAccelerator("format.image"),click(e,t){Vn(t)}},{type:"separator"},{label:"Clear Formatting",accelerator:e.getAccelerator("format.clear-format"),click(e,t){Wn(t)}}]}}function tr(e){const{theme:t}=e.getAll();return{label:"&Theme",id:"themeMenu",submenu:[{label:"Cadmium Light",type:"radio",id:"light",checked:"light"===t,click(e,t){Re("light")}},{label:"Dark",type:"radio",id:"dark",checked:"dark"===t,click(e,t){Re("dark")}},{label:"Graphite Light",type:"radio",id:"graphite",checked:"graphite"===t,click(e,t){Re("graphite")}},{label:"Material Dark",type:"radio",id:"material-dark",checked:"material-dark"===t,click(e,t){Re("material-dark")}},{label:"One Dark",type:"radio",id:"one-dark",checked:"one-dark"===t,click(e,t){Re("one-dark")}},{label:"Ulysses Light",type:"radio",id:"ulysses",checked:"ulysses"===t,click(e,t){Re("ulysses")}}]}}const nr=i.Menu.buildFromTemplate([{label:"Open...",click(e,t){t?qt(t):Xt()}},{label:"Clear Recent",click(){i.app.clearRecentDocuments()}}]),rr=(e,t)=>{e.webContents.session.setSpellCheckerLanguages([t])},ir={BASE:"base",EDITOR:"editor",SETTINGS:"settings"};class or extends(ye()){constructor(e){super(),this._accessor=e,this.id=null,this.browserWindow=null,this.lifecycle=0,this.type=ir.BASE}bringToFront(){const{browserWindow:e}=this;e.isMinimized()&&e.restore(),e.isVisible()||e.show(),P?e.focus():e.moveTop()}reload(){this.browserWindow.reload()}destroy(){this.lifecycle=3,this.emit("window-closed"),this.removeAllListeners(),this.browserWindow&&(this.browserWindow.destroy(),this.browserWindow=null),this.id=null}_buildUrlWithSettings(e,t,n){const{type:r}=this,{debug:i,paths:o}=t,{codeFontFamily:a,codeFontSize:s,hideScrollbar:l,theme:c,titleBarStyle:d}=n.getAll(),u=`file://${__dirname}/index.html`,h=new URL(u);return h.searchParams.set("udp",o.userDataPath),h.searchParams.set("debug",i?"1":"0"),h.searchParams.set("wid",e),h.searchParams.set("type",r),h.searchParams.set("cff",a),h.searchParams.set("cfs",s),h.searchParams.set("hsb",l?"1":"0"),h.searchParams.set("theme",c),h.searchParams.set("tbs",d),h}_buildUrlString(e,t,n){return this._buildUrlWithSettings(e,t,n).toString()}_getPreferredBackgroundColor(e){switch(e){case"dark":return"#282828";case"material-dark":return"#34393f";case"ulysses":return"#f3f3f3";case"graphite":return"#f7f7f7";case"one-dark":return"#282c34";default:return"#ffffff"}}}const ar=or,sr=require("electron-window-state");var lr=n.n(sr);const cr={label:"Cut",id:"cutMenuItem",role:"cut"},dr={label:"Copy",id:"copyMenuItem",role:"copy"},ur={label:"Copy As Markdown",id:"copyAsMarkdownMenuItem",click(e,t){t.webContents.send("mt::cm-copy-as-markdown")}},hr={label:"Copy As Html",id:"copyAsHtmlMenuItem",click(e,t){t.webContents.send("mt::cm-copy-as-html")}},pr={type:"separator"},fr=[{label:"Insert Paragraph Before",id:"insertParagraphBeforeMenuItem",click(e,t){t.webContents.send("mt::cm-insert-paragraph","before")}},{label:"Insert Paragraph After",id:"insertParagraphAfterMenuItem",click(e,t){t.webContents.send("mt::cm-insert-paragraph","after")}},pr,cr,dr,{label:"Paste",id:"pasteMenuItem",role:"paste"},pr,ur,hr,{label:"Paste as Plain Text",id:"pasteAsPlainTextMenuItem",click(e,t){t.webContents.send("mt::cm-paste-as-plain-text")}}],mr=class extends ar{constructor(e){super(e),this.type=ir.EDITOR,this._directoryToOpen=null,this._filesToOpen=[],this._markdownToOpen=[],this._openedRootDirectory="",this._openedFiles=[]}createWindow(e=null,n=[],r=[],a={}){const{menu:s,env:l,preferences:c}=this._accessor,d=!e&&0===n.length&&0===r.length,u=lr()({defaultWidth:1200,defaultHeight:800}),{x:h,y:p,width:f,height:m}=(e=>{const{bounds:t,workArea:n}=i.screen.getPrimaryDisplay(),r=P?t:n;let{x:o,y:a,width:s,height:l}=e,c=!1;return void 0===o||void 0===a?(c=!0,r.width<s&&(s=r.width),r.height<l&&(l=r.height)):c=!i.screen.getAllDisplays().map((e=>o>=e.bounds.x&&o<=e.bounds.x+e.bounds.width&&a>=e.bounds.y&&a<=e.bounds.y+e.bounds.height)).some((e=>e)),c&&(o=Math.ceil(r.x+(r.width-s)/2),a=Math.ceil(r.y+(r.height-l)/2)),{x:o,y:a,width:s,height:l}})(u),g=Object.assign({x:h,y:p,width:f,height:m},M,a);P&&(g.icon=t().join(__static,"logo-96px.png"));const{titleBarStyle:w,theme:b,sideBarVisibility:E,tabBarVisibility:y,sourceCodeModeEnabled:_,spellcheckerEnabled:v,spellcheckerLanguage:C}=c.getAll();k||(g.titleBarStyle="default","native"===w&&(g.frame=!0)),g.backgroundColor=this._getPreferredBackgroundColor(b),l.disableSpellcheck&&(g.webPreferences.spellcheck=!1);let A=this.browserWindow=new i.BrowserWindow(g);if((0,o.enable)(A.webContents),this.id=A.id,v&&!k)try{rr(A,C)}catch(e){S().error("Unable to set spell checker language on startup:",e)}return s.addEditorMenu(A,{sourceCodeModeEnabled:_}),A.webContents.on("context-menu",((e,t)=>{((e,t,n,r)=>{const{isEditable:o,hasImageContents:a,selectionText:s,editFlags:l,misspelledWord:c,dictionarySuggestions:d}=n;if((e=>{const{isEditable:t,editFlags:n,inputFieldType:r}=e;return t&&"none"===r&&!!n.canEditRichly})(n)&&!a){const n=s.trim().length>0&&l.canCut&&l.canCopy,a=o&&!!s&&!!c,u=new i.Menu;if(r){const e=((e,t,n)=>{const r=[];if(r.push(new i.MenuItem({label:"Change Language...",visible:!k,click(e,t){t.webContents.send("mt::spelling-show-switch-language")}})),e&&t&&n){if(r.push({label:"Add to Dictionary",click(e,n){((e,t)=>e.webContents.session.addWordToSpellCheckerDictionary(t))(n,t)?n.webContents.replaceMisspelling(t):S().error(`Error while adding "${t}" to dictionary.`)}}),n.length>0){r.push(pr);for(const e of n)r.push({label:e,click(n,r){r.webContents.send("mt::spelling-replace-misspelling",{word:t,replacement:e})}})}}else r.push({label:"Edit Dictionary...",click(e,t){i.ipcMain.emit("app-create-settings-window","spelling")}});return r})(a,c,d);u.append(new i.MenuItem({label:"Spelling...",submenu:e})),u.append(new i.MenuItem(pr))}[cr,dr,hr,ur].forEach((e=>{e.enabled=n})),fr.forEach((e=>{u.append(new i.MenuItem(e))})),u.popup([{window:e,x:t.clientX,y:t.clientY}])}})(A,e,t,c.getItem("spellcheckerEnabled"))})),A.webContents.once("did-finish-load",(()=>{this.lifecycle=2,this.emit("window-ready"),this.bringToFront();const e=c.getPreferredEol();s.updateLineEndingMenu(this.id,e),A.webContents.send("mt::bootstrap-editor",{addBlankTab:d,markdownList:this._markdownToOpen,lineEnding:e,sideBarVisibility:E,tabBarVisibility:y,sourceCodeModeEnabled:_}),this._doOpenFilesToOpen(),this._markdownToOpen.length=0,A.webContents.on("zoom-changed",((e,t)=>{"in"===t?ln(A):"out"===t&&cn(A)}))})),A.webContents.once("did-fail-load",((e,t,n)=>{S().error(`The window failed to load or was cancelled: ${t}; ${n}`)})),A.webContents.once("render-process-gone",(async(e,{reason:t})=>{if("clean-exit"===t)return;const n=`The renderer process has crashed unexpected or is killed (${t}).`;if(S().error(n),"abnormal-exit"===t)return;const{response:r}=await i.dialog.showMessageBox(A,{type:"warning",buttons:["Close","Reload","Keep It Open"],message:"MarkText has crashed",detail:n});if(A.id)switch(r){case 0:return this.destroy();case 1:return this.reload()}})),A.on("focus",(()=>{this.emit("window-focus"),A.webContents.send("mt::window-active-status",{status:!0})})),A.on("blur",(()=>{this.emit("window-blur"),A.webContents.send("mt::window-active-status",{status:!1})})),["maximize","unmaximize","enter-full-screen","leave-full-screen"].forEach((e=>{A.on(e,(()=>{A.webContents.send(`mt::window-${e}`)}))})),A.on("close",(e=>{this.emit("window-close"),e.preventDefault(),A.webContents.send("mt::ask-for-close")})),A.on("closed",(()=>{this.lifecycle=3,this.emit("window-closed"),A=null})),this.lifecycle=1,A.loadURL(this._buildUrlString(this.id,l,c)),A.setSheetOffset(U),u.manage(A),A.webContents.setIgnoreMenuShortcuts(!0),setTimeout((()=>{e&&this.openFolder(e),n.length&&this.openTabsFromPaths(n)}),0),A}openTab(e,t={},n=!0){3!==this.lifecycle&&this.openTabs([{filePath:e,options:t,selected:n}])}openTabsFromPaths(e){if(!e||0===e.length)return;const t=e.map((e=>({filePath:e,options:{},selected:!1})));t[0].selected=!0,this.openTabs(t)}openTabs(e){if(3===this.lifecycle)return;const{browserWindow:t}=this,{preferences:n}=this._accessor,r=n.getPreferredEol(),{autoGuessEncoding:i,trimTrailingNewline:o}=n.getAll();for(const{filePath:n,options:a,selected:s}of e)be(n,r,i,o).then((e=>{2===this.lifecycle?this._doOpenTab(e,a,s):this._filesToOpen.push({doc:e,options:a,selected:s})})).catch((e=>{const{message:n,stack:r}=e;S().error(`[ERROR] Cannot open file or directory: ${n}\n\n${r}`),t.webContents.send("mt::show-notification",{title:"Cannot open tab",type:"error",message:e.message})}))}openUntitledTab(e=!0,t=""){if(3!==this.lifecycle)if(2===this.lifecycle){const{browserWindow:n}=this;n.webContents.send("mt::new-untitled-tab",e,t)}else this._markdownToOpen.push(t)}openFolder(e){if(e&&3!==this.lifecycle&&!((e,n,r=!1)=>{if(!e||!n)return!1;const i=r?e:t().normalize(e),o=r?n:t().normalize(n);if(i.length!==o.length)return!1;if(i===o)return!0;if(i.toLowerCase()===o.toLowerCase())try{const e=ee().statSync(i),t=ee().statSync(o);return e.ino===t.ino}catch(e){}return!1})(e,this._openedRootDirectory))if(2===this.lifecycle){const{_accessor:t,browserWindow:n}=this,{menu:r}=t;this._openedRootDirectory&&i.ipcMain.emit("watcher-unwatch-directory",n,this._openedRootDirectory),r.addRecentlyUsedDocument(e),this._openedRootDirectory=e,i.ipcMain.emit("watcher-watch-directory",n,e),n.webContents.send("mt::open-directory",e)}else this._directoryToOpen=e}addToOpenedFiles(e){const{_openedFiles:t,browserWindow:n}=this;t.push(e),i.ipcMain.emit("watcher-watch-file",n,e)}changeOpenedFilePath(e,t){const{_openedFiles:n,browserWindow:r}=this,o=n.findIndex((e=>e===t));-1===o?n.push(e):n[o]=e,i.ipcMain.emit("watcher-unwatch-file",r,t),i.ipcMain.emit("watcher-watch-file",r,e)}removeFromOpenedFiles(e){const{_openedFiles:t,browserWindow:n}=this,r=t.findIndex((t=>t===e));-1!==r&&t.splice(r,1),i.ipcMain.emit("watcher-unwatch-file",n,e)}getCandidateScores(e){const{_openedFiles:n,_openedRootDirectory:r,id:i}=this,o=[];for(const a of e){let e=0;if(n.some((e=>e===a)))e=-1;else{oe(r,a)&&(e+=5);for(const r of n)oe(t().dirname(r),a)&&(e+=1)}o.push({id:i,score:e})}return o}reload(){const{id:e,browserWindow:t}=this;i.ipcMain.emit("watcher-unwatch-all-by-id",e),this._directoryToOpen="",this._filesToOpen=[],this._markdownToOpen=[],this._openedRootDirectory="",this._openedFiles=[],t.webContents.once("did-finish-load",(()=>{this.lifecycle=2;const{preferences:e}=this._accessor,{sideBarVisibility:n,tabBarVisibility:r,sourceCodeModeEnabled:i}=e.getAll(),o=e.getPreferredEol();t.webContents.send("mt::bootstrap-editor",{addBlankTab:!0,markdownList:[],lineEnding:o,sideBarVisibility:n,tabBarVisibility:r,sourceCodeModeEnabled:i})})),this.lifecycle=1,super.reload()}destroy(){super.destroy(),this._directoryToOpen=null,this._filesToOpen=null,this._markdownToOpen=null,this._openedRootDirectory=null,this._openedFiles=null}get openedRootDirectory(){return this._openedRootDirectory}_doOpenTab(e,t,n){const{_accessor:r,_openedFiles:o,browserWindow:a}=this,{menu:s}=r,{pathname:l}=e;i.ipcMain.emit("watcher-watch-file",a,l),s.addRecentlyUsedDocument(l),o.push(l),a.webContents.send("mt::open-new-tab",e,t,n)}_doOpenFilesToOpen(){if(2!==this.lifecycle)throw new Error("Invalid state.");this._directoryToOpen&&this.openFolder(this._directoryToOpen),this._directoryToOpen=null;for(const{doc:e,options:t,selected:n}of this._filesToOpen)this._doOpenTab(e,t,n);this._filesToOpen.length=0}},gr=require("@hfelix/electron-localshortcut"),wr=class extends ar{constructor(e){super(e),this.type=ir.SETTINGS}createWindow(e=null){const{menu:n,env:r,keybindings:a,preferences:s}=this._accessor,l=Object.assign({},N);(e=>{const{bounds:t,workArea:n}=i.screen.getDisplayNearestPoint(i.screen.getCursorScreenPoint()),r=P?t:n,{width:o,height:a}=e;e.x=Math.ceil(r.x+(r.width-o)/2),e.y=Math.ceil(r.y+(r.height-a)/2)})(l),P&&(l.icon=t().join(__static,"logo-96px.png")),l.resizable=!0;const{titleBarStyle:c,theme:d}=s.getAll();k||(l.titleBarStyle="default","native"===c&&(l.frame=!0)),l.backgroundColor=this._getPreferredBackgroundColor(d);let u=this.browserWindow=new i.BrowserWindow(l);(0,o.enable)(u.webContents),this.id=u.id,n.addSettingMenu(u),u.once("ready-to-show",(()=>{this.lifecycle=2,this.emit("window-ready")})),u.on("focus",(()=>{this.emit("window-focus"),u.webContents.send("mt::window-active-status",{status:!0})})),u.on("blur",(()=>{this.emit("window-blur"),u.webContents.send("mt::window-active-status",{status:!1})})),u.on("close",(e=>{this.emit("window-close"),e.preventDefault(),i.ipcMain.emit("window-close-by-id",u.id)})),u.on("closed",(()=>{this.emit("window-closed"),u=null})),this.lifecycle=1,u.loadURL(this._buildUrlString(this.id,r,s,e)),u.setSheetOffset(U);const h=a.getAccelerator("view.toggle-dev-tools");return r.debug&&h&&gr.electronLocalshortcut.register(u,h,(()=>{u.webContents.toggleDevTools()})),u}_buildUrlString(e,t,n,r){const i=this._buildUrlWithSettings(e,t,n);return r&&i.searchParams.set("type",`${ir.SETTINGS}/${r}`),i.toString()}},br=require("chokidar");var Er=n.n(br);const yr={dir:"mt::update-object-tree",file:"mt::update-file"};class _r{constructor(){this._buf=[]}getNewest(){const{_buf:e}=this;return e.length?e[e.length-1]:null}getSecondNewest(){const{_buf:e}=this;return e.length>=2?e[e.length-2]:null}setNewest(e){const{_buf:t}=this,n=t.indexOf(e);if(-1!==n){if(n===t.length-1)return;t.splice(n,1)}t.push(e)}delete(e){const{_buf:t}=this,n=t.indexOf(e);-1!==n&&t.splice(n,1)}}class vr extends(ye()){constructor(e,n){super(),this._appMenu=e,this._activeWindowId=null,this._windows=new Map,this._windowActivity=new _r,this._watcher=new class{constructor(e){this._preferences=e,this._ignoreChangeEvents=[],this.watchers={}}watch(e,n,r="dir"){const i=!!k||this._preferences.getItem("watcherUsePolling"),o=C(),a=Er().watch(n,{ignored:(e,t)=>t?!!/(?:^|[/\\])(?:\..|node_modules|(?:.+\.asar))/.test(e)||!t.isDirectory()&&!re(e):/(?:^|[/\\])(?:\..|node_modules|(?:.+\.asar))/.test(e),ignoreInitial:"file"===r,persistent:!0,ignorePermissionErrors:!0,depth:"file"===r?k?1:0:void 0,awaitWriteFinish:{stabilityThreshold:1e3,pollInterval:150},usePolling:i});let s=!1,l=!1,c=null;a.on("add",(async n=>{if(!await this._shouldIgnoreEvent(e.id,n,r,i)){const{_preferences:i}=this,o=i.getPreferredEol(),{autoGuessEncoding:a,trimTrailingNewline:s}=i.getAll();(async(e,n,r,i,o,a)=>{const s=(await u().stat(n)).birthtime,l=re(n),c={pathname:n,name:t().basename(n),isFile:!0,isDirectory:!1,birthTime:s,isMarkdown:l};if(l){try{const e=await be(n,i,o,a);c.data=e}catch(t){if("file"===r)return void e.webContents.send("mt::show-notification",{title:"Watcher I/O error",type:"error",message:t.message})}e.webContents.send(yr[r],{type:"add",change:c})}})(e,n,r,o,a,s)}})).on("change",(async t=>{if(!await this._shouldIgnoreEvent(e.id,t,r,i)){const{_preferences:n}=this,i=n.getPreferredEol(),{autoGuessEncoding:o,trimTrailingNewline:a}=n.getAll();(async(e,t,n,r,i,o)=>{if("dir"!==n&&re(t))try{const n={pathname:t,data:await be(t,r,i,o)};e.webContents.send("mt::update-file",{type:"change",change:n})}catch(t){"file"===n&&e.webContents.send("mt::show-notification",{title:"Watcher I/O error",type:"error",message:t.message})}})(e,t,r,i,o,a)}})).on("unlink",(t=>((e,t,n)=>{const r={pathname:t};e.webContents.send(yr[n],{type:"unlink",change:r})})(e,t,r))).on("addDir",(n=>((e,n,r)=>{if("file"===r)return;const i={pathname:n,name:t().basename(n),isCollapsed:!0,isDirectory:!0,isFile:!1,isMarkdown:!1,folders:[],files:[]};e.webContents.send("mt::update-object-tree",{type:"addDir",change:i})})(e,n,r))).on("unlinkDir",(t=>((e,t,n)=>{if("file"===n)return;const r={pathname:t};e.webContents.send("mt::update-object-tree",{type:"unlinkDir",change:r})})(e,t,r))).on("raw",((e,t,i)=>{global.MARKTEXT_DEBUG_VERBOSE>=3&&console.log("watcher: ",e,t,i),P&&"file"===r&&"rename"===e&&(c&&clearTimeout(c),c=setTimeout((async()=>{c=null,s||await h(n)&&(a.unwatch(n),a.add(n))}),150))})).on("error",(t=>{"ENOSPC"===t.code?l||(l=!0,S().warn("inotify limit reached: Too many file descriptors are opened."),e.webContents.send("mt::show-notification",{title:"inotify limit reached",type:"warning",message:"Cannot watch all files and file changes because too many file descriptors are opened."})):S().error("Error while watching files:",t)}));const d=()=>{s=!0,this.watchers[o]&&delete this.watchers[o],c&&(clearTimeout(c),c=null),a.close()};return this.watchers[o]={win:e,watcher:a,pathname:n,type:r,close:d},d}unwatch(e,t,n="dir"){for(const r of Object.keys(this.watchers)){const i=this.watchers[r];if(i.win===e&&i.pathname===t&&i.type===n){i.watcher.close(),delete this.watchers[r];break}}}unwatchByWindowId(e){const t=[],n=[];for(const r of Object.keys(this.watchers)){const i=this.watchers[r];i.win.id===e&&(t.push(i.watcher),n.push(r))}t.length&&(n.forEach((e=>delete this.watchers[e])),t.forEach((e=>e.close())))}close(){Object.keys(this.watchers).forEach((e=>this.watchers[e].close())),this.watchers={},this._ignoreChangeEvents=[]}ignoreChangedEvent(e,t,n=1300){this._ignoreChangeEvents.push({windowId:e,pathname:t,duration:n,start:new Date})}async _shouldIgnoreEvent(e,t,n,r){if("file"===n){const{_ignoreChangeEvents:n}=this,i=new Date;for(let o=0;o<n.length;++o){const{windowId:a,pathname:s,start:l,duration:c}=n[o];if(a===e&&s===t){if(n.splice(o,1),--o,i-l<c)return!0;if(!r)try{const e=await u().stat(t);if(e.mtime-l<c)return global.MARKTEXT_DEBUG_VERBOSE>=3&&console.log(`Ignoring file event after "stat": current="${i}", start="${l}", file="${e.mtime}".`),!0}catch(e){console.error('Failed to "stat" file to determine modification time:',e)}}}}return!1}}(n),this._listenForIpcMain()}add(e){const{id:t}=e;this._windows.set(t,e),this._appMenu.has(t)||this._appMenu.addDefaultMenu(t),1===this.windowCount&&this.setActiveWindow(t),e.on("window-focus",(()=>{this.setActiveWindow(t)})),e.on("window-closed",(()=>{this.remove(t),this._watcher.unwatchByWindowId(t)}))}get(e){return this._windows.get(e)}getBrowserWindow(e){const t=this.get(e);if(t)return t.browserWindow}remove(e){const{_windows:t}=this,n=this.get(e);if(n){n.removeAllListeners("window-focus"),this._windowActivity.delete(e);const r=this._windowActivity.getNewest();this.setActiveWindow(r),t.delete(e)}return n}setActiveWindow(e){this._activeWindowId!==e&&(this._activeWindowId=e,this._windowActivity.setNewest(e),null!=e&&this._appMenu.setActiveWindow(e),this.emit("activeWindowChanged",e))}getActiveWindow(){return this._windows.get(this._activeWindowId)}getActiveWindowId(){return this._activeWindowId}getActiveEditor(){let e=this.getActiveWindow();return e&&e.type!==ir.EDITOR?(e=this._windows.get(this._windowActivity.getSecondNewest()),e&&e.type===ir.EDITOR?e:void 0):e}getActiveEditorId(){const e=this.getActiveEditor();return e?e.id:null}getWindowsByType(e){ir[e.toUpperCase()]||console.error(`"${e}" is not a valid window type.`);const{windows:t}=this,n=[];for(const[r,i]of t)i.type===e&&n.push({id:r,win:i});return n}findBestWindowToOpenIn(e){if(!e||!Array.isArray(e)||!e.length)return[];const{windows:t}=this,n=this.getActiveEditorId();if(this.windowCount<=1)return[{windowId:n,fileList:e}];let r=null;for(const n of t.values())if(n.type===ir.EDITOR){const t=n.getCandidateScores(e);if(r){const e=r.length;for(let n=0;n<e;++n)-1!==r[n].score&&r[n].score<t[n].score&&(r[n]=t[n])}else r=t}const i=[],o=r.length;for(let t=0;t<o;++t){let{id:o,score:a}=r[t];if(-1===a)continue;0===a&&(o=n);let s=i.find((e=>e.windowId===o));s||(s={windowId:o,fileList:[]},i.push(s)),s.fileList.push(e[t])}return i}get windows(){return this._windows}get windowCount(){return this._windows.size}closeWatcher(){this._watcher.close()}forceClose(e){if(!e)return!1;const{id:t}=e,{_appMenu:n,_windows:r}=this;this._watcher.unwatchByWindowId(t),n.removeWindowMenu(t);const o=this.remove(t);return o?o.destroy():(S().error("Something went wrong: Cannot find associated application window!"),e.destroy()),0===r.size&&i.app.quit(),!0}forceCloseById(e){const t=this.getBrowserWindow(e);return!!t&&this.forceClose(t)}_listenForIpcMain(){i.ipcMain.on("mt::window-add-file-path",((e,t)=>{const n=i.BrowserWindow.fromWebContents(e.sender),r=this.get(n.id);r?r.addToOpenedFiles(t):S().error(`Cannot find window id "${n.id}" to add opened file.`)})),i.ipcMain.on("mt::close-window",(e=>{const t=i.BrowserWindow.fromWebContents(e.sender);this.forceClose(t)})),i.ipcMain.on("mt::open-file",((e,t,n)=>{const r=i.BrowserWindow.fromWebContents(e.sender),o=this.get(r.id);o?o.openTab(t,n,!0):S().error(`Cannot find window id "${r.id}" to open file.`)})),i.ipcMain.on("mt::window-tab-closed",((e,t)=>{const n=i.BrowserWindow.fromWebContents(e.sender),r=this.get(n.id);r&&r.removeFromOpenedFiles(t)})),i.ipcMain.on("mt::window-toggle-always-on-top",(e=>{const t=i.BrowserWindow.fromWebContents(e.sender),n=!t.isAlwaysOnTop();t.setAlwaysOnTop(n),this._appMenu.updateAlwaysOnTopMenu(t.id,n)})),i.ipcMain.on("watcher-unwatch-all-by-id",(e=>{this._watcher.unwatchByWindowId(e)})),i.ipcMain.on("watcher-watch-file",((e,t)=>{this._watcher.watch(e,t,"file")})),i.ipcMain.on("watcher-watch-directory",((e,t)=>{this._watcher.watch(e,t,"dir")})),i.ipcMain.on("watcher-unwatch-file",((e,t)=>{this._watcher.unwatch(e,t,"file")})),i.ipcMain.on("watcher-unwatch-directory",((e,t)=>{this._watcher.unwatch(e,t,"dir")})),i.ipcMain.on("window-add-file-path",((e,t)=>{const n=this.get(e);n?n.addToOpenedFiles(t):S().error(`Cannot find window id "${e}" to add opened file.`)})),i.ipcMain.on("window-change-file-path",((e,t,n)=>{const r=this.get(e);r?r.changeOpenedFilePath(t,n):S().error(`Cannot find window id "${e}" to change file path.`)})),i.ipcMain.on("window-file-saved",((e,t)=>{this._watcher.ignoreChangedEvent(e,t,1300)})),i.ipcMain.on("window-close-by-id",(e=>{this.forceCloseById(e)})),i.ipcMain.on("window-reload-by-id",(e=>{const t=this.get(e);t&&t.reload()})),i.ipcMain.on("window-toggle-always-on-top",(e=>{const t=!e.isAlwaysOnTop();e.setAlwaysOnTop(t),this._appMenu.updateAlwaysOnTopMenu(e.id,t)})),i.ipcMain.on("broadcast-preferences-changed",(e=>{if(void 0!==e.titleBarStyle&&delete e.titleBarStyle,Object.keys(e).length>0)for(const{browserWindow:t}of this._windows.values())t.webContents.send("mt::user-preference",e)})),i.ipcMain.on("broadcast-user-data-changed",(e=>{for(const{browserWindow:t}of this._windows.values())t.webContents.send("mt::user-preference",e)}))}}const Cr=vr,Ar=require("electron-store");var Tr=n.n(Ar);const Ir=JSON.parse('{"autoSave":{"description":"General--Automatically save the content being edited.","type":"boolean","default":false},"autoSaveDelay":{"description":"General--The time in ms after a change that the file is saved.","type":"number","minimum":1000,"default":5000},"titleBarStyle":{"description":"General--The title bar style (Windows and Linux system only).","enum":["custom","native"],"default":"custom"},"openFilesInNewWindow":{"description":"General--Open files in a new window.","type":"boolean","default":false},"openFolderInNewWindow":{"description":"General--Open folder via menu in a new window.","type":"boolean","default":false},"zoom":{"description":"General--The zoom level. Between 0.5 and 2.0 inclusive.","type":"number","minimum":0.5,"maximum":2,"default":1},"hideScrollbar":{"description":"General--Whether to hide scrollbars.","type":"boolean","default":false},"wordWrapInToc":{"description":"General--Whether to enable word wrap in TOC.","type":"boolean","default":false},"fileSortBy":{"description":"General--Sort files in opened folder by created time, modified time and title.","enum":["modified","created","title"],"default":"modified"},"startUpAction":{"description":"General--The action after MarkText startup, open the last edited content, open the specified folder or blank page","enum":["folder","lastState","blank"],"default":"blank"},"defaultDirectoryToOpen":{"description":"General--The default directory that should be opened on startup when startUp=folder.","type":"string"},"language":{"description":"General--The language MarkText use.","type":"string","default":"en"},"editorFontFamily":{"description":"Editor--editor font family","type":"string","pattern":"^[^\\\\s]+((-|\\\\s)*[^\\\\s])*$","default":"Open Sans"},"fontSize":{"description":"Editor--Font size in pixels","type":"number","maximum":32,"minimum":12,"default":16},"lineHeight":{"description":"Editor--Line Height","type":"number","maximum":2,"minimum":1.2,"default":1.6},"editorLineWidth":{"description":"Editor--Defines the maximum editor area width. An empty string or suffixes of ch (characters), px (pixels) or % (percentage) are allowed.","type":"string","pattern":"^(?:$|[0-9]+(?:ch|px|%)$)","default":""},"codeFontSize":{"description":"Editor--Font size in code Block, the range is 12 ~ 18","type":"number","maximum":28,"minimum":12,"default":14},"codeFontFamily":{"description":"Editor--Font family used in code block","type":"string","pattern":"^[^\\\\s]+((-|\\\\s)*[^\\\\s])*$","default":"DejaVu Sans Mono"},"codeBlockLineNumbers":{"description":"Editor--Whether to show the line numbers","type":"boolean","default":true},"trimUnnecessaryCodeBlockEmptyLines":{"description":"Editor--Trim the beginning and ending empty lines in code block","type":"boolean","default":true},"autoPairBracket":{"description":"Editor--Automatically brackets when editing","type":"boolean","default":true},"autoPairMarkdownSyntax":{"description":"Editor--Autocomplete markdown syntax","type":"boolean","default":true},"autoPairQuote":{"description":"Editor--Automatic completion of quotes","type":"boolean","default":true},"endOfLine":{"description":"Editor--The newline character used at the end of each line. The default value is default, which selects your operating system\'s default newline character.","enum":["default","lf","crlf"],"default":"default"},"defaultEncoding":{"description":"Editor--The default file encoding.","default":"utf8","enum":["ascii","utf8","utf16be","utf16le","utf32be","utf32le","latin3","iso885915","cp1252","arabic","cp1256","latin4","cp1257","iso88592","windows1250","cp866","iso88595","koi8r","koi8u","cp1251","iso885913","greek","cp1253","hebrew","cp1255","latin5","cp1254","gb2312","gb18030","gbk","big5","big5hkscs","shiftjis","eucjp","euckr","latin6"]},"autoGuessEncoding":{"description":"Editor--Try to automatically guess the file encoding when opening files.","type":"boolean","default":true},"trimTrailingNewline":{"description":"Editor--The trim trailing newline option.","default":2,"enum":[0,1,2,3]},"textDirection":{"description":"Editor--The writing text direction","enum":["ltr","rtl"],"default":"ltr"},"hideQuickInsertHint":{"description":"Editor--Hide hint for quickly creating paragraphs","type":"boolean","default":false},"hideLinkPopup":{"description":"Editor--Hide link popup when the cursor is hover on the link","type":"boolean","default":false},"autoCheck":{"description":"Editor--Whether to automatically check related task.","type":"boolean","default":false},"preferLooseListItem":{"description":"Markdown--The preferred list type","type":"boolean","default":true},"bulletListMarker":{"description":"Markdown--The marker used in bullet list","enum":["-","*","+"],"default":"-"},"orderListDelimiter":{"description":"Markdown--The dilimiter used in order list","enum":[".",")"],"default":"."},"preferHeadingStyle":{"description":"Markdown--The preferred heading style in MarkText","enum":["atx","setext"],"default":"atx"},"tabSize":{"description":"Markdown--Replace the tab with x spaces","type":"number","default":4},"listIndentation":{"description":"Markdown--Select the indent of list","enum":["dfm","tab",1,2,3,4],"default":1},"frontmatterType":{"description":"Markdown--The frontmatter type","enum":["-","+",";","{"],"default":"-"},"superSubScript":{"description":"Markdown-Enable pandoc\'s markdown extension superscript and subscript.","type":"boolean","default":false},"footnote":{"description":"Markdown-Enable pandoc\'s markdown extension footnote.","type":"boolean","default":false},"isHtmlEnabled":{"description":"Markdown-Enable HTML rendering","type":"boolean","default":true},"isGitlabCompatibilityEnabled":{"description":"Markdown-Enable GitLab compatibility mode.","type":"boolean","default":false},"sequenceTheme":{"description":"Markdown--Sequence diagram theme","enum":["hand","simple"],"default":"hand"},"theme":{"description":"Theme--Select the theme used in MarkText","type":"string","default":"light"},"autoSwitchTheme":{"description":"Theme--Automatically adjust application theme according system.","default":2,"enum":[0,1,2]},"spellcheckerEnabled":{"description":"Spelling--Whether spell checking is enabled.","type":"boolean","default":false},"spellcheckerNoUnderline":{"description":"Spelling--Don\'t underline spelling mistakes.","type":"boolean","default":false},"spellcheckerLanguage":{"description":"Spelling--The spell checker language","type":"string","pattern":"^[a-z]{2,3}(?:[-](?:[0-9]|[a-zA-Z]){2,}){0,2}$","default":"en-US"},"imageInsertAction":{"description":"Image--The default behavior after insert image from local folder","enum":["upload","folder","path"],"default":"path"},"imagePreferRelativeDirectory":{"description":"Image--Whether to prefer the relative image directory.","type":"boolean","default":false},"imageRelativeDirectoryName":{"description":"Image--The relative image folder name.","type":"string","default":"assets"},"sideBarVisibility":{"description":"View--Whether the side bar is visible.","type":"boolean","default":false},"tabBarVisibility":{"description":"View--Whether the tabs are shown.","type":"boolean","default":false},"sourceCodeModeEnabled":{"description":"View--Whether the source-code mode is enabled by default.","type":"boolean","default":false},"searchExclusions":{"description":"Searcher--List of glob patterns to exclude from search.","type":"array","items":{"type":"string"},"default":[]},"searchMaxFileSize":{"description":"Searcher--The maximal file size (<maxFileSize><suffix>). Suffixes of K, M or G are allowed if not suffix is given the number is treated as bytes.","type":"string","pattern":"^(?:$|[0-9]+(?:K|M|G)?$)","default":""},"searchIncludeHidden":{"description":"Searcher--Whether to search in hidden files and directories.","type":"boolean","default":false},"searchNoIgnore":{"description":"Searcher--Whether to ignore ignore files like .gitignore.","type":"boolean","default":false},"searchFollowSymlinks":{"description":"Searcher--Whether symlinks should be followed.","type":"boolean","default":true},"watcherUsePolling":{"description":"Watcher--Whether to use polling. Polling may leads to high CPU utilization but is necessary to watch files over a network.","type":"boolean","default":false}}'),Or="preferences";class Rr extends(ye()){constructor(e){super(),X()(this,"init",(()=>{let e=null;try{e=JSON.parse(ee().readFileSync(this.staticPath,{encoding:"utf8"})||"{}"),i.nativeTheme.shouldUseDarkColors&&(e.theme="dark")}catch(e){S().error(e)}if(!e)throw new Error("Can not load static preference.json file");if(this.hasPreferencesFile){const t=this.getAll(),n=!((e,t)=>{const n=Object.keys(e).sort(),r=Object.keys(t).sort();return JSON.stringify(n)===JSON.stringify(r)})(e,t),r=Object.keys(t),i=Object.keys(e);if(n){for(const e of r)i.includes(e)||(delete t[e],this.store.delete(e));let n=!1;for(const i in e)r.includes(i)||(n=!0,t[i]=e[i]);n&&this.store.set(t)}}else this.store.set(e);this._listenForIpcMain()}));const{preferencesPath:n}=e;this.preferencesPath=n,this.hasPreferencesFile=ee().existsSync(t().join(this.preferencesPath,"./preferences.json")),this.store=new(Tr())({schema:Ir,name:Or}),this.staticPath=t().join(__static,"preference.json"),this.init()}getAll(){return this.store.store}setItem(e,t){return i.ipcMain.emit("broadcast-preferences-changed",{[e]:t}),this.store.set(e,t)}getItem(e){return this.store.get(e)}setItems(e){e?Object.keys(e).forEach((t=>{this.setItem(t,e[t])})):S().error("Cannot change settings without entires: object is undefined or null.")}getPreferredEol(){const e=this.getItem("endOfLine");return"lf"===e?"lf":"crlf"===e||D?"crlf":"lf"}exportJSON(){}importJSON(){}_listenForIpcMain(){i.ipcMain.on("mt::ask-for-user-preference",(e=>{i.BrowserWindow.fromWebContents(e.sender).webContents.send("mt::user-preference",this.getAll())})),i.ipcMain.on("mt::set-user-preference",((e,t)=>{this.setItems(t)})),i.ipcMain.on("mt::cmd-toggle-autosave",(e=>{this.setItem("autoSave",!!this.getItem("autoSave"))})),i.ipcMain.on("set-user-preference",(e=>{this.setItems(e)}))}watchedFolderChange(e){const n=t().join(`${e}`,"marktext.json");if(ee().existsSync(n)){console.log(`hit folder preference ${n}.`);const t=new(Tr())({schema:Ir,name:"marktext",cwd:e}),r=this.store.store;this.store=t;const i=JSON.parse(ee().readFileSync(n,{encoding:"utf8"})||"{}");for(const e of Object.keys(i))r[e]=i[e];this.setItems(r)}else if(console.log(`${n} non-existent`),this.store.name!==Or){const e=new(Tr())({schema:Ir,name:Or});this.store=e;const t=this.getAll();this.setItems(t)}}isFolderSettings(){return this.store.name!==Or}}const Sr=Rr,kr=require("keytar");var Dr=n.n(kr);const Pr=JSON.parse('{"imageFolderPath":{"description":"The image folder to store local images.","type":"string"},"screenshotFolderPath":{"description":"The place to store screen capture images.","type":"string"},"webImages":{"description":"Images from web which you used in MarkText","type":"array"},"cloudImages":{"description":"Images which you upload to cloud","type":"array"},"currentUploader":{"description":"The current image uploader","type":"string"},"imageBed":{"description":"The image bed configration","type":"object"}}');class Mr extends(ye()){constructor(e){super();const{dataCenterPath:n,userDataPath:r}=e;this.dataCenterPath=n,this.userDataPath=r,this.serviceName="marktext",this.encryptKeys=["githubToken"],this.hasDataCenterFile=ee().existsSync(t().join(this.dataCenterPath,"./dataCenter.json")),this.store=new(Tr())({schema:Pr,name:"dataCenter"}),this.init()}init(){const e={imageFolderPath:t().join(this.userDataPath,"images"),screenshotFolderPath:t().join(this.userDataPath,"screenshot"),webImages:[],cloudImages:[],currentUploader:"none",imageBed:{github:{owner:"",repo:"",branch:""}}};this.hasDataCenterFile||(this.store.set(e),p(this.store.get("screenshotFolderPath"))),this._listenForIpcMain()}async getAll(){const{serviceName:e,encryptKeys:t}=this,n=this.store.store;try{const r=await Promise.all(t.map((t=>Dr().getPassword(e,t)))),i=t.reduce(((e,t,n)=>({...e,[t]:r[n]})),{});return Object.assign(n,i)}catch(e){return S().error("Failed to decrypt secure keys:",e),n}}addImage(e,t){const n=this.store.get(e),r=n.some((e=>e.url===t));let o;return r?(o=n.find((e=>e.url===t)),o.timeStamp=+new Date):(o={url:t,timeStamp:+new Date},n.push(o)),i.ipcMain.emit("broadcast-web-image-added",{type:e,item:o}),this.store.set(e,n)}removeImage(e,t){const n=this.store.get(e),r=n.indexOf(t),o=n[r];if(-1!==r)return n.splice(r,1),i.ipcMain.emit("broadcast-web-image-removed",{type:e,item:o}),this.store.set(e,n)}getItem(e){const{encryptKeys:t,serviceName:n}=this;if(t.includes(e))return Dr().getPassword(n,e);{const t=this.store.get(e);return Promise.resolve(t)}}async setItem(e,t){const{encryptKeys:n,serviceName:r}=this;if("screenshotFolderPath"===e&&p(t),i.ipcMain.emit("broadcast-user-data-changed",{[e]:t}),!n.includes(e))return this.store.set(e,t);try{return await Dr().setPassword(r,e,t)}catch(e){S().error("Keytar error:",e)}}setItems(e){e?Object.keys(e).forEach((t=>{this.setItem(t,e[t])})):S().error("Cannot change settings without entires: object is undefined or null.")}_listenForIpcMain(){i.ipcMain.on("set-image-folder-path",(e=>{this.setItem("imageFolderPath",e)})),i.ipcMain.on("mt::ask-for-user-data",(async e=>{const t=i.BrowserWindow.fromWebContents(e.sender),n=await this.getAll();t.webContents.send("mt::user-preference",n)})),i.ipcMain.on("mt::ask-for-modify-image-folder-path",(async(e,t)=>{if(!t){const n=i.BrowserWindow.fromWebContents(e.sender),{filePaths:r}=await i.dialog.showOpenDialog(n,{properties:["openDirectory","createDirectory"]});r&&r[0]&&(t=r[0])}t&&this.setItem("imageFolderPath",t)})),i.ipcMain.on("mt::set-user-data",((e,t)=>{this.setItems(t)})),i.ipcMain.on("mt::ask-for-image-path",(async e=>{const t=i.BrowserWindow.fromWebContents(e.sender),{filePaths:n}=await i.dialog.showOpenDialog(t,{properties:["openFile"],filters:[{name:"Images",extensions:ne}]});n&&n[0]?e.returnValue=n[0]:e.returnValue=""}))}}const Nr=Mr,xr="darwin"===process.platform,Fr=e=>e.toLowerCase().replace("commandorcontrol",xr?"cmd":"ctrl").replace("cmdorctrl",xr?"cmd":"ctrl").replace("control","ctrl").replace("meta","cmd").replace("command","cmd").replace("option","alt"),Lr=(e,t)=>{e=Fr(e),t=Fr(t);const n=e.indexOf("+"),r=t.indexOf("+");if(-1===n&&-1===r)return e===t;if(-1===n||-1===r)return!1;const i=e.split("+"),o=t.split("+");return i.length===o.length&&new Set([...i,...o]).size===o.length},Ur=new Map([["mt.hide","Command+H"],["mt.hide-others","Command+Option+H"],["file.preferences","Command+,"],["file.new-window","Command+N"],["file.new-tab","Command+T"],["file.open-file","Command+O"],["file.open-folder","Command+Shift+O"],["file.save","Command+S"],["file.save-as","Command+Shift+S"],["file.move-file",""],["file.rename-file",""],["file.print",""],["file.close-tab","Command+W"],["file.close-window","Command+Shift+W"],["file.quit","Command+Q"],["edit.undo","Command+Z"],["edit.redo","Command+Shift+Z"],["edit.cut","Command+X"],["edit.copy","Command+C"],["edit.paste","Command+V"],["edit.copy-as-markdown","Command+Shift+C"],["edit.copy-as-html",""],["edit.paste-as-plaintext","Command+Shift+V"],["edit.select-all","Command+A"],["edit.duplicate","Command+Option+D"],["edit.create-paragraph","Shift+Command+N"],["edit.delete-paragraph","Shift+Command+D"],["edit.find","Command+F"],["edit.find-next","Cmd+G"],["edit.find-previous","Cmd+Shift+G"],["edit.replace","Command+Option+F"],["edit.find-in-folder","Shift+Command+F"],["edit.screenshot","Command+Option+A"],["paragraph.heading-1","Command+1"],["paragraph.heading-2","Command+2"],["paragraph.heading-3","Command+3"],["paragraph.heading-4","Command+4"],["paragraph.heading-5","Command+5"],["paragraph.heading-6","Command+6"],["paragraph.upgrade-heading","Command+Plus"],["paragraph.degrade-heading","Command+-"],["paragraph.table","Command+Shift+T"],["paragraph.code-fence","Command+Option+C"],["paragraph.quote-block","Command+Option+Q"],["paragraph.math-formula","Command+Option+M"],["paragraph.html-block","Command+Option+J"],["paragraph.order-list","Command+Option+O"],["paragraph.bullet-list","Command+Option+U"],["paragraph.task-list","Command+Option+X"],["paragraph.loose-list-item","Command+Option+L"],["paragraph.paragraph","Command+0"],["paragraph.horizontal-line","Command+Option+-"],["paragraph.front-matter","Command+Option+Y"],["format.strong","Command+B"],["format.emphasis","Command+I"],["format.underline","Command+U"],["format.superscript",""],["format.subscript",""],["format.highlight","Shift+Command+H"],["format.inline-code","Command+`"],["format.inline-math","Shift+Command+M"],["format.strike","Command+D"],["format.hyperlink","Command+L"],["format.image","Command+Shift+I"],["format.clear-format","Shift+Command+R"],["window.minimize","Command+M"],["window.toggle-always-on-top",""],["window.zoom-in",""],["window.zoom-out",""],["window.toggle-full-screen","Ctrl+Command+F"],["view.command-palette","Command+Shift+P"],["view.source-code-mode","Command+Option+S"],["view.typewriter-mode","Command+Option+T"],["view.focus-mode","Command+Shift+J"],["view.toggle-sidebar","Command+J"],["view.toggle-toc","Command+K"],["view.toggle-tabbar","Command+Option+B"],["view.toggle-dev-tools","Command+Option+I"],["view.dev-reload","Command+Option+R"],["view.reload-images","Command+R"],["tabs.cycle-forward","Ctrl+Tab"],["tabs.cycle-backward","Ctrl+Shift+Tab"],["tabs.switch-to-left","Command+PageUp"],["tabs.switch-to-right","Command+PageDown"],["tabs.switch-to-first","Ctrl+1"],["tabs.switch-to-second","Ctrl+2"],["tabs.switch-to-third","Ctrl+3"],["tabs.switch-to-fourth","Ctrl+4"],["tabs.switch-to-fifth","Ctrl+5"],["tabs.switch-to-sixth","Ctrl+6"],["tabs.switch-to-seventh","Ctrl+7"],["tabs.switch-to-eighth","Ctrl+8"],["tabs.switch-to-ninth","Ctrl+9"],["tabs.switch-to-tenth","Ctrl+0"],["file.quick-open","Command+P"]]),$r=new Map([["mt.hide",""],["mt.hide-others",""],["file.new-window","Ctrl+N"],["file.new-tab","Ctrl+T"],["file.open-file","Ctrl+O"],["file.open-folder","Ctrl+Shift+O"],["file.save","Ctrl+S"],["file.save-as","Ctrl+Shift+S"],["file.move-file",""],["file.rename-file",""],["file.print",""],["file.preferences","Ctrl+,"],["file.close-tab","Ctrl+W"],["file.close-window","Ctrl+Shift+W"],["file.quit","Ctrl+Q"],["edit.undo","Ctrl+Z"],["edit.redo","Ctrl+Shift+Z"],["edit.cut","Ctrl+X"],["edit.copy","Ctrl+C"],["edit.paste","Ctrl+V"],["edit.copy-as-markdown","Ctrl+Shift+C"],["edit.copy-as-html",""],["edit.paste-as-plaintext","Ctrl+Shift+V"],["edit.select-all","Ctrl+A"],["edit.duplicate","Ctrl+Shift+E"],["edit.create-paragraph","Ctrl+Shift+N"],["edit.delete-paragraph","Ctrl+Shift+D"],["edit.find","Ctrl+F"],["edit.find-next","F3"],["edit.find-previous","Shift+F3"],["edit.replace","Ctrl+R"],["edit.find-in-folder","Ctrl+Shift+F"],["edit.screenshot",""],["paragraph.heading-1","Ctrl+Alt+1"],["paragraph.heading-2","Ctrl+Alt+2"],["paragraph.heading-3","Ctrl+Alt+3"],["paragraph.heading-4","Ctrl+Alt+4"],["paragraph.heading-5","Ctrl+Alt+5"],["paragraph.heading-6","Ctrl+Alt+6"],["paragraph.upgrade-heading","Ctrl+Plus"],["paragraph.degrade-heading","Ctrl+-"],["paragraph.table","Ctrl+Shift+T"],["paragraph.code-fence","Ctrl+Shift+K"],["paragraph.quote-block","Ctrl+Shift+Q"],["paragraph.math-formula","Ctrl+Alt+M"],["paragraph.html-block","Ctrl+Alt+H"],["paragraph.order-list","Ctrl+G"],["paragraph.bullet-list","Ctrl+H"],["paragraph.task-list","Ctrl+Shift+X"],["paragraph.loose-list-item","Ctrl+Shift+L"],["paragraph.paragraph","Ctrl+Shift+0"],["paragraph.horizontal-line","Ctrl+_"],["paragraph.front-matter","Ctrl+Shift+Y"],["format.strong","Ctrl+B"],["format.emphasis","Ctrl+I"],["format.underline","Ctrl+U"],["format.superscript",""],["format.subscript",""],["format.highlight","Ctrl+Shift+H"],["format.inline-code","Ctrl+Y"],["format.inline-math","Ctrl+Shift+M"],["format.strike","Ctrl+D"],["format.hyperlink","Ctrl+L"],["format.image","Ctrl+Shift+I"],["format.clear-format","Ctrl+Shift+R"],["window.minimize","Ctrl+M"],["window.toggle-always-on-top",""],["window.zoom-in",""],["window.zoom-out",""],["window.toggle-full-screen","F11"],["view.command-palette","Ctrl+Shift+P"],["view.source-code-mode","Ctrl+E"],["view.typewriter-mode","Ctrl+Shift+G"],["view.focus-mode","Ctrl+Shift+J"],["view.toggle-sidebar","Ctrl+J"],["view.toggle-toc","Ctrl+K"],["view.toggle-tabbar","Ctrl+Shift+B"],["view.toggle-dev-tools","Ctrl+Alt+I"],["view.dev-reload","Ctrl+F5"],["view.reload-images","F5"],["tabs.cycle-forward","Ctrl+Tab"],["tabs.cycle-backward","Ctrl+Shift+Tab"],["tabs.switch-to-left","Ctrl+PageUp"],["tabs.switch-to-right","Ctrl+PageDown"],["tabs.switch-to-first","Ctrl+1"],["tabs.switch-to-second","Ctrl+2"],["tabs.switch-to-third","Ctrl+3"],["tabs.switch-to-fourth","Ctrl+4"],["tabs.switch-to-fifth","Ctrl+5"],["tabs.switch-to-sixth","Ctrl+6"],["tabs.switch-to-seventh","Ctrl+7"],["tabs.switch-to-eighth","Ctrl+8"],["tabs.switch-to-ninth","Ctrl+9"],["tabs.switch-to-tenth","Ctrl+0"],["file.quick-open","Ctrl+P"]]),Br=new Map([["mt.hide",""],["mt.hide-others",""],["file.new-window","Ctrl+N"],["file.new-tab","Ctrl+T"],["file.open-file","Ctrl+O"],["file.open-folder","Ctrl+Shift+O"],["file.save","Ctrl+S"],["file.save-as","Ctrl+Shift+S"],["file.move-file",""],["file.rename-file",""],["file.print",""],["file.preferences","Ctrl+,"],["file.close-tab","Ctrl+W"],["file.close-window","Ctrl+Shift+W"],["file.quit","Ctrl+Q"],["edit.undo","Ctrl+Z"],["edit.redo","Ctrl+Shift+Z"],["edit.cut","Ctrl+X"],["edit.copy","Ctrl+C"],["edit.paste","Ctrl+V"],["edit.copy-as-markdown","Ctrl+Shift+C"],["edit.copy-as-html",""],["edit.paste-as-plaintext","Ctrl+Shift+V"],["edit.select-all","Ctrl+A"],["edit.duplicate","Ctrl+Alt+D"],["edit.create-paragraph","Ctrl+Shift+N"],["edit.delete-paragraph","Ctrl+Shift+D"],["edit.find","Ctrl+F"],["edit.find-next","F3"],["edit.find-previous","Shift+F3"],["edit.replace","Ctrl+R"],["edit.find-in-folder","Ctrl+Shift+F"],["edit.screenshot",""],["paragraph.heading-1",""],["paragraph.heading-2",""],["paragraph.heading-3",""],["paragraph.heading-4",""],["paragraph.heading-5",""],["paragraph.heading-6",""],["paragraph.upgrade-heading","Ctrl+Plus"],["paragraph.degrade-heading","Ctrl+-"],["paragraph.table","Ctrl+Shift+T"],["paragraph.code-fence","Ctrl+Shift+K"],["paragraph.quote-block","Ctrl+Shift+Q"],["paragraph.math-formula","Ctrl+Alt+N"],["paragraph.html-block","Ctrl+Alt+H"],["paragraph.order-list","Ctrl+G"],["paragraph.bullet-list","Ctrl+H"],["paragraph.task-list","Ctrl+Alt+X"],["paragraph.loose-list-item","Ctrl+Alt+L"],["paragraph.paragraph","Ctrl+Shift+0"],["paragraph.horizontal-line","Ctrl+Shift+U"],["paragraph.front-matter","Ctrl+Alt+Y"],["format.strong","Ctrl+B"],["format.emphasis","Ctrl+I"],["format.underline","Ctrl+U"],["format.superscript",""],["format.subscript",""],["format.highlight","Ctrl+Shift+H"],["format.inline-code","Ctrl+`"],["format.inline-math","Ctrl+Shift+M"],["format.strike","Ctrl+D"],["format.hyperlink","Ctrl+L"],["format.image","Ctrl+Shift+I"],["format.clear-format","Ctrl+Shift+R"],["window.minimize","Ctrl+M"],["window.toggle-always-on-top",""],["window.zoom-in",""],["window.zoom-out",""],["window.toggle-full-screen","F11"],["view.command-palette","Ctrl+Shift+P"],["view.source-code-mode","Ctrl+E"],["view.typewriter-mode","Ctrl+Shift+G"],["view.focus-mode","Ctrl+Shift+J"],["view.toggle-sidebar","Ctrl+J"],["view.toggle-toc","Ctrl+K"],["view.toggle-tabbar","Ctrl+Shift+B"],["view.toggle-dev-tools","Ctrl+Alt+I"],["view.dev-reload","Ctrl+F5"],["view.reload-images","F5"],["tabs.cycle-forward","Ctrl+Tab"],["tabs.cycle-backward","Ctrl+Shift+Tab"],["tabs.switch-to-left","Ctrl+PageUp"],["tabs.switch-to-right","Ctrl+PageDown"],["tabs.switch-to-first","Ctrl+1"],["tabs.switch-to-second","Ctrl+2"],["tabs.switch-to-third","Ctrl+3"],["tabs.switch-to-fourth","Ctrl+4"],["tabs.switch-to-fifth","Ctrl+5"],["tabs.switch-to-sixth","Ctrl+6"],["tabs.switch-to-seventh","Ctrl+7"],["tabs.switch-to-eighth","Ctrl+8"],["tabs.switch-to-ninth","Ctrl+9"],["tabs.switch-to-tenth","Ctrl+0"],["file.quick-open","Ctrl+P"]]),jr=12,Wr=(e,t,n)=>{const r=e.getMenuItemById(n);t.getMenuItemById(n).checked=r.checked};let Hr=0;class Gr{constructor(e){this._id=Hr++,this._appPaths=new class extends class{constructor(e){const n=new Date;if(!e)throw new Error('"userDataPath" is not set.');this._electronUserDataPath=e,this._userDataPath=e,this._logPath=t().join(this._userDataPath,"logs",`${n.getFullYear()}${n.getMonth()+1}`),this._preferencesPath=e,this._dataCenterPath=e,this._preferencesFilePath=t().join(this._preferencesPath,"preference.json")}get electronUserDataPath(){return this._electronUserDataPath}get userDataPath(){return this._userDataPath}get logPath(){return this._logPath}get preferencesPath(){return this._preferencesPath}get dataCenterPath(){return this._dataCenterPath}get preferencesFilePath(){return this._preferencesFilePath}}{constructor(e=""){e||(e=i.app.getPath("userData")),super(e),i.app.setPath("userData",this._electronUserDataPath)}}(e.userDataPath),this._debug=!!e.debug,this._isDevMode=!!e.isDevMode,this._verbose=!!e.verbose,this._safeMode=!!e.safeMode,this._disableSpellcheck=!!e.disableSpellcheck}get id(){return this._id}get paths(){return this._appPaths}get debug(){return this._debug}get isDevMode(){return this._isDevMode}get verbose(){return this._verbose}get safeMode(){return this._safeMode}get disableSpellcheck(){return this._disableSpellcheck}}/^(darwin|win32|linux)$/i.test(process.platform)||(process.stdout.write(`Operating system "${process.platform}" is not supported! Please open an issue at "https://github.com/marktext/marktext".\n`),process.exit(1)),process.on("uncaughtException",(e=>{z("An unexpected error occurred in the main process",e,"main")})),i.ipcMain.on("mt::handle-renderer-error",((e,t)=>{z("An unexpected error occurred in the renderer process",t,"renderer")})),i.crashReporter.start({companyName:"marktext",productName:"marktext",submitURL:"http://0.0.0.0/",uploadToServer:!1,compress:!0});const qr=(()=>{let e=process.argv.slice(1);const n=_(e,!0);if(n["--help"]&&(I("Usage: marktext [commands] [path ...]\n\n  Available commands:\n\n        --debug                   Enable debug mode\n        --safe                    Disable plugins and other user configuration\n    -n, --new-window              Open a new window on second-instance\n        --user-data-dir           Change the user data directory\n        --disable-gpu             Disable GPU hardware acceleration\n        --disable-spellcheck      Disable built-in spellchecker\n    -v, --verbose                 Be verbose\n        --version                 Print version information\n    -h, --help                    Print this help message\n"),process.exit(0)),n["--version"]&&(O("MarkText: v0.17.1 (17a839d)"),O(`Node.js: ${process.versions.node}`),O(`Electron: ${process.versions.electron}`),O(`Chromium: ${process.versions.chrome}`),O(`OS: ${s().type()} ${s().arch()} ${s().release()}`),process.exit(0)),n["--user-data-dir"])n["--user-data-dir"]=t().resolve(n["--user-data-dir"]);else{const e=t().join(i.app.getAppPath(),"..","..","marktext-user-data");f(e)&&(n["--user-data-dir"]=e)}return n})(),Vr=(e=>{"darwin"===process.platform&&(process.env.PATH+=(process.env.PATH.endsWith(t().delimiter)?"":t().delimiter)+"/Library/TeX/texbin");const n=e["--debug"]||!!process.env.MARKTEXT_DEBUG||!1,r=e["--verbose"]||0,i=e["--safe"],o=e["--user-data-dir"],a=e["--disable-spellcheck"],s=new Gr({debug:n,isDevMode:!1,verbose:r,safeMode:i,userDataPath:o,disableSpellcheck:a});return(e=>{p(e.userDataPath),p(e.logPath)})(s.paths),global.MARKTEXT_DEBUG=n,global.MARKTEXT_DEBUG_VERBOSE=r,global.MARKTEXT_SAFE_MODE=i,s})(qr);(e=>{S().transports.console.level="error",S().transports.rendererConsole=null,S().transports.file.resolvePath=()=>t().join(e.paths.logPath,"main.log"),S().transports.file.level=!global.MARKTEXT_DEBUG_VERBOSE||"number"!=typeof global.MARKTEXT_DEBUG_VERBOSE||global.MARKTEXT_DEBUG_VERBOSE<=0?"info":1===global.MARKTEXT_DEBUG_VERBOSE?"verbose":2===global.MARKTEXT_DEBUG_VERBOSE?"debug":"silly",S().transports.file.sync=!0,q=S().error})(Vr),qr["--disable-gpu"]&&i.app.disableHardwareAcceleration(),process.mas||i.app.requestSingleInstanceLock()||(process.stdout.write("Other MarkText instance detected: exiting...\n"),i.app.exit());let zr=null;try{zr=new class{constructor(e){const n=e.paths.userDataPath;this.env=e,this.paths=e.paths,this.preferences=new Sr(this.paths),this.dataCenter=new Nr(this.paths),this.commandManager=xe,this._loadCommands(),this.keybindings=new class{constructor(e,n){const{userDataPath:r}=n.paths;if(this.configPath=t().join(r,"keybindings.json"),this.commandManager=e,this.userKeybindings=new Map,this.keys=this.getDefaultKeybindings(),this._prepareKeyMapper(),n.isDevMode)for(const[t,n]of this.keys)e.has(t)||console.error(`[DEBUG] Command with id="${t}" isn't available for accelerator="${n}".`);this._loadLocalKeybindings()}getAccelerator(e){return this.keys.get(e)||null}registerAccelerator(e,t,n){if(!e||!t||!n)throw new Error(`addKeyHandler: invalid arguments (accelerator="${t}").`);gr.electronLocalshortcut.register(e,t,(()=>(n(e),!0)))}unregisterAccelerator(e,t){gr.electronLocalshortcut.unregister(e,t)}registerEditorKeyHandlers(e){for(const[t,n]of this.keys)n&&n.length>1&&this.registerAccelerator(e,n,(()=>{this.commandManager.execute(t,e)}))}openConfigInFileManager(){const{configPath:e}=this;w(e)||ee().writeFileSync(e,"{\n\n\n}\n","utf-8"),i.shell.openPath(e).catch((e=>console.error(e)))}getDefaultKeybindings(){return k?Ur:P?$r:Br}getUserKeybindings(){return this.userKeybindings}async setUserKeybindings(e){return this.userKeybindings=new Map(e),this._saveUserKeybindings()}_prepareKeyMapper(){const{layout:e,keymap:t}=Ae();gr.electronLocalshortcut.setKeyboardLayout(e,t),Oe.addListener((({layout:e,keymap:t})=>{global.MARKTEXT_DEBUG&&process.env.MARKTEXT_DEBUG_KEYBOARD&&console.log("[DEBUG] Keyboard layout changed:\n",e),gr.electronLocalshortcut.setKeyboardLayout(e,t)}))}async _saveUserKeybindings(){const{configPath:e,userKeybindings:t}=this;try{const n=JSON.stringify(Object.fromEntries(t),null,2);return await u().writeFile(e,n,"utf8"),!0}catch(e){return!1}}_loadLocalKeybindings(){if(global.MARKTEXT_SAFE_MODE||!w(this.configPath))return;const e=this._loadUserKeybindingsFromDisk();if(!e)return void S().warn("Invalid keybinding configuration: failed to load or parse file.");const t=new Map;for(const n in e)if(this.keys.has(n)){const r=e[n];"string"==typeof r&&(0===r.length?t.set(n,""):(0,gr.isValidElectronAccelerator)(r)?t.set(n,r):console.error(`[WARNING] "${r}" is not a valid accelerator.`))}for(const[e,n]of t)for(const[r,i]of t)if(""!==n&&e!==r&&Lr(n,i)){const t=`Invalid keybindings.json configuration: Duplicate value for "${e}" and "${r}"!`;return console.log(t),void S().error(t)}if(0===t.size)return;const n=new Map(this.keys);for(const[e,r]of t){for(const[e,i]of n)if(Lr(i,r)){n.set(e,""),null==t.get(e)&&t.set(e,"");break}n.set(e,r)}this.keys=n,this.userKeybindings=t}_loadUserKeybindingsFromDisk(){try{const e=JSON.parse(ee().readFileSync(this.configPath,"utf8"));return"object"!=typeof e?null:e}catch(e){return null}}}(this.commandManager,e),this.menu=new class{constructor(e,n,r){X()(this,"updateThemeMenu",(e=>{this.windowMenus.forEach((t=>{const{menu:n,type:r}=t;if(1!==r)return;const i=n.getMenuItemById("themeMenu");i&&(i.submenu.items.forEach((e=>e.checked=!1)),i.submenu.items.forEach((t=>{t.id&&t.id===e&&(t.checked=!0)})))}))})),X()(this,"updateAutoSaveMenu",(e=>{this.windowMenus.forEach((t=>{const{menu:n,type:r}=t;if(1!==r)return;const i=n.getMenuItemById("autoSaveMenuItem");i&&(i.checked=e)}))})),this._preferences=e,this._keybindings=n,this._userDataPath=r,this.RECENTS_PATH=t().join(r,"recently-used-documents.json"),this.isOsxOrWindows=k||D,this.activeWindowId=-1,this.windowMenus=new Map,this._listenForIpcMain()}addRecentlyUsedDocument(e){const{isOsxOrWindows:t,RECENTS_PATH:n}=this;if(t&&i.app.addRecentDocument(e),k)return;const r=this.getRecentlyUsedDocuments(),o=r.indexOf(e);let a=0!==o;if(o>0&&r.splice(o,1),0!==o&&r.unshift(e),r.length>jr&&(a=!0,r.splice(jr,r.length-jr)),this.updateAppMenu(r),a){p(this._userDataPath);const e=JSON.stringify(r,null,2);ee().writeFileSync(n,e,"utf-8")}}getRecentlyUsedDocuments(){const{RECENTS_PATH:e}=this;if(!w(e))return[];try{const t=JSON.parse(ee().readFileSync(e,"utf-8")).filter((e=>e&&(w(e)||m(e))));return t.length>jr&&t.splice(jr,t.length-jr),t}catch(e){return S().error("Error while read recently used documents:",e),[]}}clearRecentlyUsedDocuments(){const{isOsxOrWindows:e,RECENTS_PATH:t}=this;if(e&&i.app.clearRecentDocuments(),k)return;const n=[];this.updateAppMenu(n);const r=JSON.stringify(n,null,2);p(this._userDataPath),ee().writeFileSync(t,r,"utf-8")}addDefaultMenu(e){const{windowMenus:t}=this,n=this._buildSettingMenu();t.set(e,n)}addSettingMenu(e){const{windowMenus:t}=this,n=this._buildSettingMenu();t.set(e.id,n)}addEditorMenu(e,t={}){const n=!!t.sourceCodeModeEnabled,{windowMenus:r}=this;r.set(e.id,this._buildEditorMenu());const{menu:i}=r.get(e.id);if(i.getMenuItemById("sourceCodeModeMenuItem").checked=n,n){const e=i.getMenuItemById("typewriterModeMenuItem"),t=i.getMenuItemById("focusModeMenuItem");e.enabled=!1,t.enabled=!1}const{_keybindings:o}=this;o.registerEditorKeyHandlers(e),D&&o.registerAccelerator(e,"Alt+F4",(e=>{e&&!e.isDestroyed()&&e.close()}))}removeWindowMenu(e){const{activeWindowId:t}=this;this.windowMenus.delete(e),t===e&&(this.activeWindowId=-1)}getWindowMenuById(e){const t=this.windowMenus.get(e);if(!t)throw S().error(`getWindowMenuById: Cannot find window menu for window id ${e}.`),new Error(`Cannot find window menu for id ${e}.`);return t.menu}has(e){return this.windowMenus.has(e)}setActiveWindow(e){this.activeWindowId!==e&&(this._setApplicationMenu(this.getWindowMenuById(e)),this.activeWindowId=e)}updateAppMenu(e){e||(e=this.getRecentlyUsedDocuments()),this.windowMenus.forEach(((t,n)=>{const{menu:r,type:i}=t;if(1!==i)return;const{menu:o}=this._buildEditorMenu(e);Wr(r,o,"sourceCodeModeMenuItem"),Wr(r,o,"typewriterModeMenuItem"),Wr(r,o,"focusModeMenuItem"),Wr(r,o,"sideBarMenuItem"),Wr(r,o,"tabBarMenuItem"),t.menu=o;const{activeWindowId:a}=this;a===n&&this._setApplicationMenu(o)}))}updateLineEndingMenu(e,t){const n=this.getWindowMenuById(e),r=n.getMenuItemById("crlfLineEndingMenuEntry"),i=n.getMenuItemById("lfLineEndingMenuEntry");"crlf"===t?r.checked=!0:i.checked=!0}updateAlwaysOnTopMenu(e,t){this.getWindowMenuById(e).getMenuItemById("alwaysOnTopMenuItem").checked=t}_buildEditorMenu(e=null){e||(e=this.getRecentlyUsedDocuments());const t=function(e,t,n){return[..."darwin"===process.platform?[an(e)]:[],nn(e,t,n),at(e),$n(e),er(e),pn(e),tr(t),sn(e),on()]}(this._keybindings,this._preferences,e);return{menu:i.Menu.buildFromTemplate(t),type:1}}_buildSettingMenu(){if(k){const t=(e=this._keybindings,[..."darwin"===process.platform?[an(e)]:[],st(e),on()]);return{menu:i.Menu.buildFromTemplate(t),type:2}}var e;return{menu:null,type:2}}_setApplicationMenu(e){if(P&&!e){const e=i.Menu.buildFromTemplate([]);i.Menu.setApplicationMenu(e)}else i.Menu.setApplicationMenu(e)}_listenForIpcMain(){i.ipcMain.on("mt::add-recently-used-document",((e,t)=>{this.addRecentlyUsedDocument(t)})),i.ipcMain.on("mt::update-line-ending-menu",((e,t,n)=>{this.updateLineEndingMenu(t,n)})),i.ipcMain.on("mt::update-format-menu",((e,t,n)=>{this.has(t)?((e,t)=>{const n=e.getMenuItemById("formatMenuItem");n.submenu.items.forEach((e=>e.checked=!1)),n.submenu.items.forEach((e=>{e.id&&t[Bn[e.id]]&&(e.checked=!0)}))})(this.getWindowMenuById(t),n):S().error(`UpdateApplicationMenu: Cannot find window menu for window id ${t}.`)})),i.ipcMain.on("mt::update-sidebar-menu",((e,t,n)=>{this.has(t)?((e,t)=>{e.getMenuItemById("sideBarMenuItem").checked=!!t})(this.getWindowMenuById(t),n):S().error(`UpdateApplicationMenu: Cannot find window menu for window id ${t}.`)})),i.ipcMain.on("mt::view-layout-changed",((e,t,n)=>{this.has(t)?((e,t)=>{const n=(t,n)=>{e.getMenuItemById(t).enabled=n},r=(t,n)=>{e.getMenuItemById(t).checked=n};for(const e in t){const i=t[e];switch(e){case"showSideBar":r("sideBarMenuItem",i);break;case"showTabBar":r("tabBarMenuItem",i);break;case"sourceCode":r("sourceCodeModeMenuItem",i),n(gt,!i),n(mt,!i);break;case"typewriter":r(mt,i);break;case"focus":r(gt,i)}}})(this.getWindowMenuById(t),n):S().error(`UpdateApplicationMenu: Cannot find window menu for window id ${t}.`)})),i.ipcMain.on("mt::editor-selection-changed",((e,t,n)=>{this.has(t)?((e,t)=>{const{affiliation:n,isDisabled:r,isMultiline:i,isCodeFences:o,isCodeContent:a}=t,s=e.getMenuItemById("formatMenuItem");s.submenu.items.forEach((e=>e.enabled=!0)),((e,{affiliation:t,isTable:n,isLooseListItem:r,isTaskList:i})=>{const o=e.getMenuItemById("paragraphMenuEntry");o.submenu.items.forEach((e=>e.checked=!1)),o.submenu.items.forEach((e=>{if(!e.id)return!1;"looseListItemMenuItem"===e.id?e.checked=!!r:Object.keys(t).some((t=>"ul"===t&&i?"taskListMenuItem"===e.id:!(!n||"tableMenuItem"!==e.id)||!("codeFencesMenuItem"!==e.id||!/code$/.test(t))||t===mn[e.id]))&&(e.checked=!0)}))})(e,t),Ln(e,!r),r||(o?(Ln(e,!1),a&&(s.submenu.items.forEach((e=>e.enabled=!1)),Object.keys(n).some((e=>/code$/.test(e)))&&Un(e,["codeFencesMenuItem"],!0))):i&&(s.submenu.items.filter((e=>e.id&&fn.includes(e.id))).forEach((e=>e.enabled=!1)),Un(e,fn,!1)),n.ul||n.ol||Un(e,["looseListItemMenuItem"],!1))})(this.getWindowMenuById(t),n):S().error(`UpdateApplicationMenu: Cannot find window menu for window id ${t}.`)})),i.ipcMain.on("menu-add-recently-used",(e=>{this.addRecentlyUsedDocument(e)})),i.ipcMain.on("menu-clear-recently-used",(()=>{this.clearRecentlyUsedDocuments()})),i.ipcMain.on("broadcast-preferences-changed",(e=>{void 0!==e.theme&&this.updateThemeMenu(e.theme),void 0!==e.autoSave&&this.updateAutoSaveMenu(e.autoSave)}))}}(this.preferences,this.keybindings,n),this.windowManager=new Cr(this.menu,this.preferences)}_loadCommands(){const{commandManager:e}=this;(e=>{(e=>{e.add(Ne.FILE_QUICK_OPEN,ke)})(e),(e=>{e.add(Ne.TABS_CYCLE_BACKWARD,De),e.add(Ne.TABS_CYCLE_FORWARD,Pe),e.add(Ne.TABS_SWITCH_TO_LEFT,De),e.add(Ne.TABS_SWITCH_TO_RIGHT,Pe),e.add(Ne.TABS_SWITCH_TO_FIRST,(e=>Me(e,0))),e.add(Ne.TABS_SWITCH_TO_SECOND,(e=>Me(e,1))),e.add(Ne.TABS_SWITCH_TO_THIRD,(e=>Me(e,2))),e.add(Ne.TABS_SWITCH_TO_FOURTH,(e=>Me(e,3))),e.add(Ne.TABS_SWITCH_TO_FIFTH,(e=>Me(e,4))),e.add(Ne.TABS_SWITCH_TO_SIXTH,(e=>Me(e,5))),e.add(Ne.TABS_SWITCH_TO_SEVENTH,(e=>Me(e,6))),e.add(Ne.TABS_SWITCH_TO_EIGHTH,(e=>Me(e,7))),e.add(Ne.TABS_SWITCH_TO_NINTH,(e=>Me(e,8))),e.add(Ne.TABS_SWITCH_TO_TENTH,(e=>Me(e,9)))})(e)})(e),(e=>{(e=>{e.add(Ne.EDIT_COPY,nt),e.add(Ne.EDIT_COPY_AS_HTML,He),e.add(Ne.EDIT_COPY_AS_MARKDOWN,We),e.add(Ne.EDIT_CREATE_PARAGRAPH,ze),e.add(Ne.EDIT_CUT,tt),e.add(Ne.EDIT_DELETE_PARAGRAPH,Ke),e.add(Ne.EDIT_DUPLICATE,Ve),e.add(Ne.EDIT_FIND,Xe),e.add(Ne.EDIT_FIND_IN_FOLDER,Ze),e.add(Ne.EDIT_FIND_NEXT,Ye),e.add(Ne.EDIT_FIND_PREVIOUS,Je),e.add(Ne.EDIT_PASTE,rt),e.add(Ne.EDIT_PASTE_AS_PLAINTEXT,Ge),e.add(Ne.EDIT_REDO,je),e.add(Ne.EDIT_REPLACE,Qe),e.add(Ne.EDIT_SCREENSHOT,it),e.add(Ne.EDIT_SELECT_ALL,qe),e.add(Ne.EDIT_UNDO,Be)})(e),(e=>{e.add(Ne.FILE_CHECK_UPDATE,ht),e.add(Ne.FILE_CLOSE_TAB,Yt),e.add(Ne.FILE_CLOSE_WINDOW,Jt),e.add(Ne.FILE_EXPORT_FILE,Wt),e.add(Ne.FILE_IMPORT_FILE,Ht),e.add(Ne.FILE_MOVE_FILE,en),e.add(Ne.FILE_NEW_FILE,Xt),e.add(Ne.FILE_NEW_TAB,Kt),e.add(Ne.FILE_OPEN_FILE,qt),e.add(Ne.FILE_OPEN_FOLDER,Vt),e.add(Ne.FILE_PREFERENCES,ut),e.add(Ne.FILE_PRINT,Gt),e.add(Ne.FILE_QUIT,i.app.quit),e.add(Ne.FILE_RENAME_FILE,tn),e.add(Ne.FILE_SAVE,Qt),e.add(Ne.FILE_SAVE_AS,Zt)})(e),(e=>{e.add(Ne.FORMAT_CLEAR_FORMAT,Wn),e.add(Ne.FORMAT_EMPHASIS,Hn),e.add(Ne.FORMAT_HIGHLIGHT,Gn),e.add(Ne.FORMAT_HYPERLINK,qn),e.add(Ne.FORMAT_IMAGE,Vn),e.add(Ne.FORMAT_INLINE_CODE,zn),e.add(Ne.FORMAT_INLINE_MATH,Kn),e.add(Ne.FORMAT_STRIKE,Xn),e.add(Ne.FORMAT_STRONG,Yn),e.add(Ne.FORMAT_SUBSCRIPT,Jn),e.add(Ne.FORMAT_SUPERSCRIPT,Qn),e.add(Ne.FORMAT_UNDERLINE,Zn)})(e),(e=>{e.add(Ne.MT_HIDE,pt),e.add(Ne.MT_HIDE_OTHERS,ft)})(e),(e=>{e.add(Ne.PARAGRAPH_BULLET_LIST,wn),e.add(Ne.PARAGRAPH_CODE_FENCE,bn),e.add(Ne.PARAGRAPH_DEGRADE_HEADING,En),e.add(Ne.PARAGRAPH_FRONT_MATTER,yn),e.add(Ne.PARAGRAPH_HEADING_1,_n),e.add(Ne.PARAGRAPH_HEADING_2,vn),e.add(Ne.PARAGRAPH_HEADING_3,Cn),e.add(Ne.PARAGRAPH_HEADING_4,An),e.add(Ne.PARAGRAPH_HEADING_5,Tn),e.add(Ne.PARAGRAPH_HEADING_6,In),e.add(Ne.PARAGRAPH_HORIZONTAL_LINE,On),e.add(Ne.PARAGRAPH_HTML_BLOCK,Rn),e.add(Ne.PARAGRAPH_LOOSE_LIST_ITEM,Sn),e.add(Ne.PARAGRAPH_MATH_FORMULA,kn),e.add(Ne.PARAGRAPH_ORDERED_LIST,Dn),e.add(Ne.PARAGRAPH_PARAGRAPH,Pn),e.add(Ne.PARAGRAPH_QUOTE_BLOCK,Mn),e.add(Ne.PARAGRAPH_TABLE,Nn),e.add(Ne.PARAGRAPH_TASK_LIST,xn),e.add(Ne.PARAGRAPH_INCREASE_HEADING,Fn)})(e),(e=>{e.add(Ne.VIEW_COMMAND_PALETTE,vt),e.add(Ne.VIEW_FOCUS_MODE,Ct),e.add(Ne.VIEW_FORCE_RELOAD_IMAGES,St),e.add(Ne.VIEW_SOURCE_CODE_MODE,At),e.add(Ne.VIEW_TOGGLE_SIDEBAR,Tt),e.add(Ne.VIEW_TOGGLE_TABBAR,It),e.add(Ne.VIEW_TOGGLE_TOC,Ot),e.add(Ne.VIEW_TYPEWRITER_MODE,Rt),e.add(Ne.VIEW_DEV_RELOAD,_t),e.add(Ne.VIEW_TOGGLE_DEV_TOOLS,yt)})(e),(e=>{e.add(Ne.WINDOW_MINIMIZE,dn),e.add(Ne.WINDOW_TOGGLE_ALWAYS_ON_TOP,un),e.add(Ne.WINDOW_TOGGLE_FULL_SCREEN,hn),e.add(Ne.WINDOW_ZOOM_IN,ln),e.add(Ne.WINDOW_ZOOM_OUT,cn)})(e)})(e),this.env.isDevMode&&e.__verifyDefaultCommands()}}(Vr)}catch(e){const t=e.message.includes("Config schema violation")?"This seems to be an issue with your configuration file(s). ":"";S().error(`Loading MarkText failed during initialization! ${t}`,e);const n=!!process.env.MARKTEXT_EXIT_ON_ERROR,r=!process.env.MARKTEXT_ERROR_INTERACTION;!n&&r&&i.dialog.showErrorBox("There was an error during loading",`${t}${e.message}\n\n${e.stack}`),process.exit(1)}S().transports.file.sync=!1,(0,o.initialize)(),new class{constructor(e,t){X()(this,"ready",(()=>{const{_args:e,_openFilesCache:t}=this,{preferences:n}=this._accessor;if(e._.length)for(const n of e._){if(n.startsWith("--"))continue;const e=ge(n);e&&t.push(e)}const{startUpAction:r,defaultDirectoryToOpen:o,autoSwitchTheme:a,theme:s}=n.getAll();if("folder"===r&&o){const e=ge(o);e&&t.unshift(e)}const l=/dark/i.test(s);0===a&&l!==i.nativeTheme.shouldUseDarkColors?(Re(i.nativeTheme.shouldUseDarkColors?"dark":"light"),i.nativeTheme.themeSource=i.nativeTheme.shouldUseDarkColors?"dark":"light"):i.nativeTheme.themeSource=l?"dark":"light";let c=i.nativeTheme.shouldUseDarkColors;i.ipcMain.on("broadcast-preferences-changed",(e=>{if(e.theme){const t=/dark/i.test(e.theme);c!==t?(c=t,i.nativeTheme.themeSource=t?"dark":"light"):"system"===i.nativeTheme.themeSource&&(i.nativeTheme.themeSource=c?"dark":"light")}})),k?i.app.dock.setMenu(nr):D&&i.app.setJumpList([{type:"recent"},{type:"tasks",items:[{type:"task",title:"New Window",description:"Opens a new window",program:process.execPath,args:"--new-window",iconPath:process.execPath,iconIndex:0}]}]),t.length?this._openFilesToOpen():this._createEditorWindow()})),X()(this,"openFile",((e,t)=>{e.preventDefault();const n=ge(t);n&&(this._openFilesCache.push(n),i.app.isReady()&&(this._openFilesTimer&&clearTimeout(this._openFilesTimer),this._openFilesTimer=setTimeout((()=>{this._openFilesTimer=null,this._openFilesToOpen()}),100)))})),this._accessor=e,this._args=t||{_:[]},this._openFilesCache=[],this._openFilesTimer=null,this._windowManager=this._accessor.windowManager,this._listenForIpcMain()}init(){k&&i.app.commandLine.appendSwitch("enable-experimental-web-platform-features","true"),i.app.on("second-instance",((e,n,r)=>{const{_openFilesCache:i,_windowManager:o}=this,a=_(n.slice(1)),s=[];for(const e of a._){if(e.startsWith("--"))continue;const n=ge(t().resolve(r,e));n&&s.push(n)}if(a["--new-window"])this._openPathList(s,!0);else if(i.push(...s),i.length)this._openFilesToOpen();else{const e=o.getActiveWindow();e&&e.bringToFront()}})),i.app.on("open-file",this.openFile),i.app.on("ready",this.ready),i.app.on("window-all-closed",(()=>{for(const e of Ue.values())e.close();this._windowManager.closeWatcher(),k||i.app.quit()})),i.app.on("activate",(()=>{0===this._windowManager.windowCount&&this.ready()})),i.app.on("web-contents-created",((e,t)=>{t.on("will-attach-webview",(e=>{e.preventDefault()})),t.on("will-navigate",(e=>{e.preventDefault()})),t.setWindowOpenHandler((e=>({action:"deny"})))}))}async getScreenshotFileName(){const e=await this._accessor.dataCenter.getItem("screenshotFolderPath"),n=`${Q()().format("YYYY-MM-DD-HH-mm-ss")}-screenshot.png`;return t().join(e,n)}_createEditorWindow(e=null,t=[],n=[],r={}){const i=new mr(this._accessor);return i.createWindow(e,t,n,r),this._windowManager.add(i),1===this._windowManager.windowCount&&this._accessor.menu.setActiveWindow(i.id),i}_createSettingWindow(e){const t=new wr(this._accessor);t.createWindow(e),this._windowManager.add(t),1===this._windowManager.windowCount&&this._accessor.menu.setActiveWindow(t.id)}_openFilesToOpen(){this._openPathList(this._openFilesCache,!1)}_openPathList(e,t=!1){const{_windowManager:n}=this,r=this._accessor.preferences.getItem("openFilesInNewWindow"),i=new Set,o=new Set;for(const{isDir:t,path:n}of e)t?o.add(n):i.add(n);for(const e of n.windows.values())if(e.type===ir.EDITOR){const{openedRootDirectory:t}=e;o.has(t)&&(e.bringToFront(),o.delete(t))}const a=Array.from(o).map((e=>({rootDirectory:e,fileList:[]}))),s=Array.from(i);if(t&&(a.length?(a[0].fileList.push(...s),a.length=1):a.push({rootDirectory:null,fileList:[...s]}),s.length=0),t||r){for(const e of s)this._createEditorWindow(null,[e]);for(const e of a){const{rootDirectory:t,fileList:n}=e;this._createEditorWindow(t,n)}}else{const e=null===n.getActiveEditorId();for(let t=0;t<a.length;++t){const{fileList:n,rootDirectory:r}=a[t];let i=!1;for(let t=0;t<s.length;++t){const o=s[t];if(oe(r,o)){if(e){n.push(...s),s.length=0,i=!0;break}n.push(o),s.splice(t,1),--t}}if(i)break}if(e&&a.length&&s.length){const{fileList:e}=a[0];e.push(...s),s.length=0}else{const e=n.findBestWindowToOpenIn(s);for(const t of e){const{windowId:e,fileList:r}=t;if(0!==r.length){if(null!==e){const t=n.get(e);if(t){t.openTabsFromPaths(r),t.bringToFront();continue}}this._createEditorWindow(null,r)}}}for(const e of a){const{rootDirectory:t,fileList:n}=e;this._createEditorWindow(t,n)}}e.length=0}_openSettingsWindow(e){const t=this._windowManager.getWindowsByType(ir.SETTINGS);if(t.length>=1){const n=t[0].win.browserWindow;return n.webContents.send("settings::change-tab",e),void(P?n.focus():n.moveTop())}this._createSettingWindow(e)}_listenForIpcMain(){i.ipcMain.handle("mt::keybinding-get-keyboard-info",(async()=>Ae())),i.ipcMain.on("mt::keybinding-debug-dump-keyboard-info",(async()=>{const e=t().join(s().tmpdir(),"marktext_keyboard_info.json"),n=JSON.stringify(Ae(),null,2);u().writeFile(e,n,"utf8").then((()=>{console.log(`Keyboard information written to "${e}".`),i.shell.openPath(e)})).catch((e=>{S().error("Error dumping keyboard information:",e)}))})),i.ipcMain.handle("mt::spellchecker-remove-word",(async(e,t)=>((e,t)=>e.webContents.session.removeWordFromSpellCheckerDictionary(t))(i.BrowserWindow.fromWebContents(e.sender),t))),i.ipcMain.handle("mt::spellchecker-switch-language",(async(e,t)=>{const n=i.BrowserWindow.fromWebContents(e.sender);return rr(n,t),null})),i.ipcMain.handle("mt::spellchecker-get-available-dictionaries",(async e=>(e=>e.webContents.session.isSpellCheckerEnabled?k?[]:e.webContents.session.availableSpellCheckerLanguages:(console.warn("Spell Checker not available but dictionaries requested."),[]))(i.BrowserWindow.fromWebContents(e.sender)))),i.ipcMain.handle("mt::spellchecker-set-enabled",(async(e,t)=>{const n=i.BrowserWindow.fromWebContents(e.sender);return!!((e,t)=>(e.webContents.session.setSpellCheckerEnabled(t),e.webContents.session.isSpellCheckerEnabled()===t))(n,t)||(S().warn(`Failed to (de-)activate spell checking on editor (id=${n.id}).`),!1)})),i.ipcMain.handle("mt::spellchecker-get-custom-dictionary-words",(async e=>(async e=>e.webContents.session.listWordsInSpellCheckerDictionary())(i.BrowserWindow.fromWebContents(e.sender)))),i.ipcMain.on("app-create-editor-window",(()=>{this._createEditorWindow()})),i.ipcMain.on("screen-capture",(async e=>{if(k){const t=await this.getScreenshotFileName();(0,Y.exec)("screencapture -i -c",(async n=>{if(n)S().error(n);else{try{const e=i.clipboard.readImage().toPNG();await u().writeFile(t,e)}catch(n){S().error(n)}e.webContents.send("mt::screenshot-captured")}}))}})),i.ipcMain.on("app-create-settings-window",(e=>{this._openSettingsWindow(e)})),i.ipcMain.on("app-open-file-by-id",((e,t)=>{if(this._accessor.preferences.getItem("openFilesInNewWindow"))this._createEditorWindow(null,[t]);else{const n=this._windowManager.get(e);n&&n.openTab(t,{},!0)}})),i.ipcMain.on("app-open-files-by-id",((e,t)=>{if(this._accessor.preferences.getItem("openFilesInNewWindow"))this._createEditorWindow(null,t);else{const n=this._windowManager.get(e);n&&n.openTabsFromPaths(t.map((e=>ge(e))).filter((e=>e&&!e.isDir)).map((e=>e.path)))}})),i.ipcMain.on("app-open-markdown-by-id",((e,t)=>{if(this._accessor.preferences.getItem("openFilesInNewWindow"))this._createEditorWindow(null,[],[t]);else{const n=this._windowManager.get(e);n&&n.openUntitledTab(!0,t)}})),i.ipcMain.on("app-open-directory-by-id",((e,t,n)=>{this._accessor.preferences.watchedFolderChange(t);const{openFolderInNewWindow:r}=this._accessor.preferences.getAll();if(n||!r){const n=this._windowManager.get(e);if(n)return void n.openFolder(t)}this._createEditorWindow(t)})),i.ipcMain.on("mt::app-try-quit",(()=>{i.app.quit()})),i.ipcMain.on("mt::open-file-by-window-id",((e,t,n)=>{const r=ae(n);if(this._accessor.preferences.getItem("openFilesInNewWindow"))this._createEditorWindow(null,[r]);else{const e=this._windowManager.get(t);e&&e.openTab(r,{},!0)}})),i.ipcMain.on("mt::select-default-directory-to-open",(async e=>{const{preferences:t}=this._accessor,{defaultDirectoryToOpen:n}=t.getAll(),r=i.BrowserWindow.fromWebContents(e.sender),{filePaths:o}=await i.dialog.showOpenDialog(r,{defaultPath:n,properties:["openDirectory","createDirectory"]});o&&o[0]&&t.setItems({defaultDirectoryToOpen:o[0]})})),i.ipcMain.on("mt::open-setting-window",(()=>{this._openSettingsWindow()})),i.ipcMain.on("mt::make-screenshot",(e=>{const t=i.BrowserWindow.fromWebContents(e.sender);i.ipcMain.emit("screen-capture",t)})),i.ipcMain.on("mt::request-keybindings",(e=>{const t=i.BrowserWindow.fromWebContents(e.sender),{keybindings:n}=this._accessor;t.webContents.send("mt::keybindings-response",Object.fromEntries(n.keys))})),i.ipcMain.on("mt::open-keybindings-config",(()=>{const{keybindings:e}=this._accessor;e.openConfigInFileManager()})),i.ipcMain.handle("mt::keybinding-get-pref-keybindings",(()=>{const{keybindings:e}=this._accessor;return{defaultKeybindings:e.getDefaultKeybindings(),userKeybindings:e.getUserKeybindings()}})),i.ipcMain.handle("mt::keybinding-save-user-keybindings",(async(e,t)=>{const{keybindings:n}=this._accessor;return n.setUserKeybindings(t)}))}}(zr,qr).init()})(),module.exports=r})();
//# sourceMappingURL=main.js.map